---
layout: post
title: "SEO搜索引擎优化"
date: 2017-10-30
tags:
    Rails
    教材
---

# SEO搜索引擎优化

| 运作原理 预计学习时间: 1小时以内                       |                                          |
| ---------------------------------------- | ---------------------------------------- |
| [**  搜索引擎运作原理](https://fullstack.xinshengdaxue.com/posts/481) | 共1个作业 \|[** 未完成](https://fullstack.xinshengdaxue.com/posts/481#task) |

| 实做方法 预计学习时间: 2小时以内                       |                                          |
| ---------------------------------------- | ---------------------------------------- |
| [**  如何为 Rails 网站做 SEO - Part 1（seo_helper）](https://fullstack.xinshengdaxue.com/posts/1084) | 共1个作业 \|[** 未完成](https://fullstack.xinshengdaxue.com/posts/1084#task) |
| [**  如何为 Rails 网站做 SEO - Part 2 ( sitema...](https://fullstack.xinshengdaxue.com/posts/1085) | 共1个作业 \|[** 未完成](https://fullstack.xinshengdaxue.com/posts/1085#task) |
| [**  自我检核表](https://fullstack.xinshengdaxue.com/posts/1086) |                                          |

# 1.搜索引擎运作原理

许多网站上线后，为了提高自己在搜索引擎上的能见度，都讲究所谓的 SEO。Search Enginer Optimization 是个marketing 导向的技术。很多程序员接触前觉得很难。

今天这门课，就是要一破 SEO 的神秘面纱。听完原理，各位就会觉得以前的生命被蹉跎了，其实根本 so easy。

### SEO 的基本原理

在谈这个主题之前，我们要解释一下，所谓的搜寻引擎是怎么运作的：

1. 搜索引擎派出 bot （机器人）到处去爬（下载）网页
2. 搜索引擎透过内部的演算法，将这些网页中的文字，做有效的关键字索引

一般来说，人类看到的网页是这样的（已透过浏览器翻译）：

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/TsS8otqiSrGx3X5Cd0nv_%E8%9E%A2%E5%B9%95%E5%BF%AB%E7%85%A7%202017-02-19%20%E4%B8%8B%E5%8D%886.38.59.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/TsS8otqiSrGx3X5Cd0nv_%E8%9E%A2%E5%B9%95%E5%BF%AB%E7%85%A7%202017-02-19%20%E4%B8%8B%E5%8D%886.38.59.png)

那么在搜寻引擎的 bot 眼中，网页是长什么样子呢？

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/CueeeF1JQqq5KunYuYfA_%E8%9E%A2%E5%B9%95%E5%BF%AB%E7%85%A7%202017-02-19%20%E4%B8%8B%E5%8D%886.39.22.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/CueeeF1JQqq5KunYuYfA_%E8%9E%A2%E5%B9%95%E5%BF%AB%E7%85%A7%202017-02-19%20%E4%B8%8B%E5%8D%886.39.22.png)

对！就是一堆代码而已。

所以搜索引擎需要透过方式，知道这个网页上的「重点」究竟是什么。

### HTML （具有语义的语言）

很多人初学 HTML ，往往以为这只是构建网页的标记语言而已。

事实上，HTML 当初被设计的时候，是带有「语义」的。

你可以这样理解：

- H1 是大标（ Heading）
- H2 , H3 是中标（ Heading）
- H4, H5, H6 是小标
- `<P>` 是指 paragraph (段落)
- `<strong>` 是重要粗体
- `<img>` 中的 alt 是指替代文字，title 是标题

所以，如果开发者希望产品中的关键字被搜寻引擎检索到，就应该尽量使用「正确的 HTML 标签」包覆。比如说商品页面就该这样：

`<h1> 美国原装进口人体工学舒适 Aeron </h1>`

`<p> <h2>工作椅的全新演绎</h2> 独特的外观、先进的<strong>人体工学</strong>理念、94%的材料可降解回收，Aeron座椅彻底改变了人们关于办公椅的思维定式。 针对人们每天的各种坐姿随时进行调节，能够使人们获得健康的舒适感和平衡的身体支撑。创新的悬浮式设计及便捷的调节控制，无需费力，Aeron座椅即可随着全身的活动进行调整。</p>`

`<img src="aeron.jpg" title="Aeron 人体工学座椅">`

SEO 技术，说穿了就是在「帮网页画重点」，最大化的让搜寻引擎了解你的网站内容。

#### HTML 使用注意事项

- `div` 与 `span` 无意义，只是容器
- 不要滥用 H1, H2, H3 的数量
  - H1 一页只能有一个
  - H2 一页只能有 2-3 个。如果有10个，搜索引擎会认为你在作弊
  - H3 一页可以有 6-10 个。

### Meta 资讯

HTML 里的 Meta 资讯，也有助于搜索引擎了解网站里面的内容。

- title  “建立独特、准确的网页标题”
- meta description “叙述本页内容”

### 权重

下面这一张图，是关键字的位置在网页当中的权重优先顺序。

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/ttsC6vJRfeVz6hNHwsMa_Rocketbook-2017-02-20-120127-066.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/ttsC6vJRfeVz6hNHwsMa_Rocketbook-2017-02-20-120127-066.png)

所以呢？我发现有的网站是这样干的。。。

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/hrmdhTaXRAW7m6dbrQq0_qidian.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/hrmdhTaXRAW7m6dbrQq0_qidian.png)

#### 秘诀

- 多把关键字放在标题与叙述上
- 网站上，每一章网页的标题与叙述都要「不同」。（否则反而会被搜索引擎认为作弊）

### 本节作业

##### [SEO](https://fullstack.xinshengdaxue.com/assignments/49)：[提取练习-概览](https://fullstack.xinshengdaxue.com/tasks/308)

已有 17 个第一期同学提交了这个作业 [**看看同学怎么做](https://fullstack.xinshengdaxue.com/tasks/308/other_answers?order=recent)

[**提交作业](https://fullstack.xinshengdaxue.com/tasks/308)

写一篇对于 SEO 心得总结本章的重点，并且说明为何要做 SEO ，有何好处？并把你的logdown地址贴上来。

# 2.如何为 Rails 网站做 SEO - Part 1（seo_helper）

## 使用 SEO Helper

`seo_helper` 是我在[多年前开发的一个 gem](https://github.com/techbang/seo_helper)。它可以做成我们在上文做的 SEO 效果：

- 变换每篇文章的「标题」
- 变换每篇文章的「叙述」

### 步骤

#### Step 1: 修改 Gemfile

```
gem "seo_helper"
```

#### Step 2: 新增 seo_helper 设定档

`touch config/initializers/seo_helper.rb`

内容如下：

```
SeoHelper.configure do |config|
  config.site_name = "My Awesome Web Application"
end
```

`site_name` 就是你想要出现的站名，如果是 `小小食杂铺` 就是 `config.site_name = "小小食杂铺"`

做完记得 `重开 rails s`

#### Step 3: 将 render_page_title_tag 放在 application.html.erb 的 head 中

将 `<%= render_page_title_tag %>` 放在 `<head>`与 `</head>` 中。

#### Step 4: 修改 controller 中的 action

##### 让每一页的 title 就会变得不一样

`def show  # ...  set_page_title @product.titleend`

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/wY02DlURjm1OX8cj2zSH_production-title.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/wY02DlURjm1OX8cj2zSH_production-title.png)

##### 让每一页的叙述就会变得不一样

```
def show
  set_page_description “#{@product.description}”

end
```

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/zJuPJu9fSUCrMSGSL8Md_product-title-2.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/zJuPJu9fSUCrMSGSL8Md_product-title-2.png)

如果叙述过长，可以这样做

```
def show
  page_description = view_context.truncate(@product.description, :length => 100)
end
```

### 本节作业

##### [SEO](https://fullstack.xinshengdaxue.com/assignments/49)：[替自己的商店网站做 SEO 吧！Part 1](https://fullstack.xinshengdaxue.com/tasks/309)

已有 10 个第一期同学提交了这个作业 [**看看同学怎么做](https://fullstack.xinshengdaxue.com/tasks/309/other_answers?order=recent)

[**提交作业](https://fullstack.xinshengdaxue.com/tasks/309)

使用本章的技巧，替自己的商店网站加入 SEO ，并将这其中的差异写一篇logdown记录下来。

# 3.如何为 Rails 网站做 SEO - Part 2 ( sitemap_generator )

Google 的算法是基于 PageRank，运作原理是派「爬虫」来抓取网页上的连结。也就是网站上「相通」的连结，基本上都有办法抓完。

但是还是会冒出一个问题。

- 有些连结是孤岛，这一辈子从来不可能被「被动收录」进去。
- 有些网站才刚建立，要等 Google 逛到它，然后被收录进去。
- 有些大网站，连结太多了。如果 Google 每一个网页都「重新收录」，光爬虫流量，就会打垮这个网站。

这些问题要怎么解决呢？

### Sitemap

Sitemap 指的不是一般人理解的「网站地图」。它是一种通用格式(使用xml作为资讯架构），用来产生网站的「连结结构」。一般网站，可以透过提交自己的 sitemap 给搜索引擎。让搜索引擎知道

- 网站内有哪些连结
- 哪些连结是「相对重要的」
- 哪些连结是需要每天更新「快照」，哪些连结则一个月更新一次就好了。

#### sitemap_generator

Rails 里面有一个 gem `sitemap_generator` 就是在做这些事的。这里提供 Logdown 这个网站的 sitemap 设定档，大家应该就很清楚这当中的作用了。

```
# -*- encoding : utf-8 -*-

# Set the host name for URL creation

SitemapGenerator::Sitemap.default_host = "http://logdown.com"
SitemapGenerator::Sitemap.create_index = true

# Generate Sitemaps on read only filesystems like Heroku

# Reference:

# https://github.com/kjvarga/sitemap_generator/wiki/Generate-Sitemaps-on-read-only-filesystems-like-Heroku#using-carrierwave

# pick a place safe to write the files

SitemapGenerator::Sitemap.public_path = 'tmp/'
# store on S3 using CarrierWave

SitemapGenerator::Sitemap.adapter = SitemapGenerator::WaveAdapter.new
# inform the map cross-linking where to find the other maps

SitemapGenerator::Sitemap.sitemaps_host = "http://#{Setting.aws.bucket}.s3.amazonaws.com/"
# pick a namespace within your bucket to organize your maps

SitemapGenerator::Sitemap.sitemaps_path = 'sitemap/'

SitemapGenerator::Sitemap.create do

  add "/pages/about"
  add "/pages/pricing"
  add "/pages/privacy"
  add "/tours"

  # Put links creation logic here.

  #

  # The root path '/' and sitemap index file are added automatically for you.

  # Links are added to the Sitemap in the order they are specified.

  #

  # Usage: add(path, options={})

  #        (default options are used if you don't specify)

  #

  # Defaults: :priority => 0.5, :changefreq => 'weekly',

  #           :lastmod => Time.now, :host => default_host

  #

  # Examples:

  #

  # Add '/articles'

  #

  #   add articles_path, :priority => 0.7, :changefreq => 'daily'

  #

  # Add all articles:

  #

  #   Article.find_each do |article|

  #     add article_path(article), :lastmod => article.updated_at

  #   end

  Blog.where("fqdn is NULL").find_in_batches do |blogs|
    blogs.each do |blog|
      add "/", :host => "#{blog.domain}", :priority => 0.7, :changefreq => "daily", :lastmod => blog.updated_at

      blog.posts.published.find_in_batches do |posts|
        posts.each do |post|
          add post.relative_url, :host => "#{blog.domain}", :lastmod => blog.updated_at
        end
      end

    end
  end
end


Blog.find_in_batches do |blogs|
  blogs.each do |blog|
    SitemapGenerator::Sitemap.default_host = "#{blog.domain}"
    SitemapGenerator::Sitemap.filename = "#{blog.subdomain}"
    SitemapGenerator::Sitemap.public_path = 'tmp/'
    SitemapGenerator::Sitemap.adapter = SitemapGenerator::WaveAdapter.new
    SitemapGenerator::Sitemap.sitemaps_host = "http://#{Setting.aws.bucket}.s3.amazonaws.com/"
    SitemapGenerator::Sitemap.sitemaps_path = 'sitemap/'
    SitemapGenerator::Sitemap.create do
      blog.posts.published.find_in_batches do |posts|
        posts.each do |post|
          add post.relative_url, :host => "#{blog.domain}", :lastmod => blog.updated_at
        end
      end
    end
  end
end
```

### 提交到哪里？

Google 提供了一套 SEO 工具，可以更强化你的 SEO 效果，并且提供网站健康检查报告。叫做 webmaster （不管你的网站是在国内或者是国外，我都建议使用）

<https://www.google.com/webmasters/>

你可以在这个网站上登记你的网站，并且使用这个网站健检，并且提交 sitemap。

### 本节作业

##### [SEO](https://fullstack.xinshengdaxue.com/assignments/49)：[替自己的商店网站做 SEO 吧！Part 2](https://fullstack.xinshengdaxue.com/tasks/310)

已有 1 个第一期同学提交了这个作业 [**看看同学怎么做](https://fullstack.xinshengdaxue.com/tasks/310/other_answers?order=recent)

[**提交作业](https://fullstack.xinshengdaxue.com/tasks/310)

使用本章的技巧，替自己的商店网站加入 SEO ，并将这其中的差异写一篇logdown记录下来。

# 4.自我检核表

在上一章，我们谈过 Google Webmaster 是一套很强的 SEO 检测工具，正式公开上线前，我强烈建议各位都用这套工具跑分扫过自己的网站上面有什么缺点。

### 常见的缺点

#### 一模一样的叙述

我最常见到很多人做网站最大的缺点，是

- titile 都一样
- description 都一样

当然，如果你不懂 SEO 技术的话。觉得这是一个不怎么重要的小点，反正上线有空再改。但事实上，许多人的网站不被收录，其实正是因为这个小细节，正是网站最大的问题。

如果你整个网站的内容都是一样的 title 与 description。搜索引擎「分不出来谁是谁」，自然「全部都不收」，这一点不得不说非常重要。

#### 滥用 H1, H2

另外一个容易被滥用的部分，就是 H1, H2, H3, H4 家族。

有些人认为既然 H 容易被收录，那么我们就加多一点 h1, h2 吧。殊不知 h1, h2 是有「限额」的。如果一个网页里面的 h1,h2 出现太多。搜索引擎就会认为站长试图作弊，直接不收录这个网站。

一般我的 h1,h2, h3 原则是这样的：

- h1 一页只能有一个
- h2 一页只能有 2-3 个
- h3 一页只能有 4-7 个

### 检核表

这里提供网站上线前，我通常会做的 SOP 检核表

- 检查网页「语意结构」是否不合理。比如说 h 家族要正确，图片要加叙述。
- 每一页的标题与叙述要「不一样」
- 产生 sitemap
- robots.txt 里面要开放检索
- 使用 Google webmaster 彻底扫描一下，自己网站上的连结是否有不利因素
