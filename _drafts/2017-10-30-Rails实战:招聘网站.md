---
layout: post
title: "Rails实战:招聘网站"
date: 2017-10-30
tags:
    Rails
    教材
---

# Rails 实战:招聘网站

| 开学第一课 预计学习时间: 1小时以内                      |      |
| ---------------------------------------- | ---- |
| [**  [直播回放\]1月3日 开学第一课](https://fullstack.xinshengdaxue.com/posts/355) |      |

| 1-Computational Thinking 预计学习时间: 半小时以内   |                                          |
| ---------------------------------------- | ---------------------------------------- |
| [**  1-1 Computational Thinking - Part 1](https://fullstack.xinshengdaxue.com/posts/313) | 共1个作业 \|[** 已完成](https://fullstack.xinshengdaxue.com/posts/313#task) |
| [**   1-2 Computational Thinking - Part 2](https://fullstack.xinshengdaxue.com/posts/315) |                                          |
| [**  1-3 Computational Thinking - Part 3](https://fullstack.xinshengdaxue.com/posts/316) |                                          |

| 2-自救教学 预计学习时间: 1小时半以内                    |      |
| ---------------------------------------- | ---- |
| [**  2-1 如何自救？](https://fullstack.xinshengdaxue.com/posts/318) |      |
| [**  [直播回放\]1月23日 编程英语](https://fullstack.xinshengdaxue.com/posts/393) |      |

| 3-拆解任务 预计学习时间: 1小时半以内                    |                                          |
| ---------------------------------------- | ---------------------------------------- |
| [**  3-1 拆解任务 - Part 1](https://fullstack.xinshengdaxue.com/posts/319) |                                          |
| [**  3-2 拆解任务 - Part 2](https://fullstack.xinshengdaxue.com/posts/320) |                                          |
| [**  3-3 拆解任务 - Part 3](https://fullstack.xinshengdaxue.com/posts/321) |                                          |
| [**  3-4 拆解任务 - Part 4](https://fullstack.xinshengdaxue.com/posts/322) | 共1个作业 \|[** 已完成](https://fullstack.xinshengdaxue.com/posts/322#task) |
| [**  3-5 拆解任务 - Part 5](https://fullstack.xinshengdaxue.com/posts/323) |                                          |
| [**  3-6 拆解任务 - Part 6](https://fullstack.xinshengdaxue.com/posts/324) |                                          |
| [**  3-7 拆解任务 - Part 7](https://fullstack.xinshengdaxue.com/posts/326) | 共1个作业 \|[** 已完成](https://fullstack.xinshengdaxue.com/posts/326#task) |

| 4-用户故事 预计学习时间: 1小时半以内                    |                                          |
| ---------------------------------------- | ---------------------------------------- |
| [**  4-1 用户故事 - Part 1](https://fullstack.xinshengdaxue.com/posts/327) |                                          |
| [**  4-2 用户故事 - Part 2](https://fullstack.xinshengdaxue.com/posts/328) |                                          |
| [**  4-3 用户故事 - Part 3](https://fullstack.xinshengdaxue.com/posts/329) |                                          |
| [**  4-4 用户故事 - Part 4](https://fullstack.xinshengdaxue.com/posts/330) |                                          |
| [**  4-5 用户故事 - Part 5](https://fullstack.xinshengdaxue.com/posts/331) |                                          |
| [**  4-6 用户故事 - Part 6](https://fullstack.xinshengdaxue.com/posts/332) |                                          |
| [**  4-7 用户故事 - Part 7](https://fullstack.xinshengdaxue.com/posts/333) | 共1个作业 \|[** 已完成](https://fullstack.xinshengdaxue.com/posts/333#task) |

| 5-招聘网站 - 实作 预计学习时间: 2小时以内                |                                          |
| ---------------------------------------- | ---------------------------------------- |
| [**  5-1 Fork 教学](https://fullstack.xinshengdaxue.com/posts/97) | 共1个作业 \|[** 已完成](https://fullstack.xinshengdaxue.com/posts/97#task) |
| [**  5-2 Pull Request 教学](https://fullstack.xinshengdaxue.com/posts/352) |                                          |
| [**  操作示范视频 - Fork & Pull Request](https://fullstack.xinshengdaxue.com/posts/406) |                                          |
| [**  5-3 招聘网站 - 实作提示](https://fullstack.xinshengdaxue.com/posts/335) |                                          |
| [**  5-4 招聘网站 - 代码提示](https://fullstack.xinshengdaxue.com/posts/343) |                                          |
| [**  5-5 招聘网站 - 学习方法](https://fullstack.xinshengdaxue.com/posts/336) | 共5个作业 \|[** 未完成](https://fullstack.xinshengdaxue.com/posts/336#task) |
| [**  5-6 使用 LICEcap Demo 演示网页（录制成gif动画）](https://fullstack.xinshengdaxue.com/posts/101) | 共1个作业 \|[** 未完成](https://fullstack.xinshengdaxue.com/posts/101#task) |

| 6-招聘网站 - （管理员）解答 预计学习时间: 2小时以内           |      |
| ---------------------------------------- | ---- |
| [**  6-0（解答）穿衣服](https://fullstack.xinshengdaxue.com/posts/338) |      |
| [**  操作示范视频 - 穿衣服](https://fullstack.xinshengdaxue.com/posts/401) |      |
| [**  6-1（解答）招聘网站第一部分](https://fullstack.xinshengdaxue.com/posts/339) |      |
| [**  操作示范视频 - 招聘网站第一部分](https://fullstack.xinshengdaxue.com/posts/402) |      |
| [**  6-2（解答）招聘网站第二部分](https://fullstack.xinshengdaxue.com/posts/340) |      |
| [**  操作示范视频 - 招聘网站第二部分](https://fullstack.xinshengdaxue.com/posts/403) |      |
| [**  6-3（解答）招聘网站第三部分](https://fullstack.xinshengdaxue.com/posts/341) |      |
| [**  操作示范视频 - 招聘网站第三部分](https://fullstack.xinshengdaxue.com/posts/404) |      |
| [**  6-4（解答）招聘网站第四部分](https://fullstack.xinshengdaxue.com/posts/342) |      |
| [**  操作示范视频 - 招聘网站第四部分](https://fullstack.xinshengdaxue.com/posts/405) |      |

| 7-基础知识补充 预计学习时间: 2小时以内                   |                                          |
| ---------------------------------------- | ---------------------------------------- |
| [**  7-1 本课程目标](https://fullstack.xinshengdaxue.com/posts/109) |                                          |
| [**  7-2 Terminal](https://fullstack.xinshengdaxue.com/posts/346) |                                          |
| [**  7-3 rails console / IRB](https://fullstack.xinshengdaxue.com/posts/347) | 共1个作业 \|[** 未完成](https://fullstack.xinshengdaxue.com/posts/347#task) |
| [**  7-4 Git](https://fullstack.xinshengdaxue.com/posts/348) | 共1个作业 \|[** 未完成](https://fullstack.xinshengdaxue.com/posts/348#task) |
| [**  7-5 Github / Heroku](https://fullstack.xinshengdaxue.com/posts/349) |                                          |
| [**  7-6 Rails 项目架构扫盲](https://fullstack.xinshengdaxue.com/posts/350) |                                          |
| [**  7-7 哪里有好用的 Gems](https://fullstack.xinshengdaxue.com/posts/351) |                                          |
| [**  7-8 HTML/ERB](https://fullstack.xinshengdaxue.com/posts/353) | 共2个作业 \|[** 未完成](https://fullstack.xinshengdaxue.com/posts/353#task) |
| [**  [直播回放\]1月5日 基础知识补充](https://fullstack.xinshengdaxue.com/posts/370) |                                          |

| 8 - 应聘者 - 加分习题 预计学习时间: 1小时以内             |      |
| ---------------------------------------- | ---- |
| [**  8-1 加分习题](https://fullstack.xinshengdaxue.com/posts/364) |      |
| [**  8-2 （解答）招聘网站第五部分](https://fullstack.xinshengdaxue.com/posts/368) |      |
| [**  操作示范视频 - 招聘网站第五部分](https://fullstack.xinshengdaxue.com/posts/407) |      |

| 9 - 用戶故事 - 应聘者 预计学习时间: 1小时半以内            |                                          |
| ---------------------------------------- | ---------------------------------------- |
| [**  [直播回放\]1月9日 Xdite老师的编程进阶之路](https://fullstack.xinshengdaxue.com/posts/376) |                                          |
| [**  9-1 应聘者用户故事 Part 1](https://fullstack.xinshengdaxue.com/posts/359) | 共1个作业 \|[** 未完成](https://fullstack.xinshengdaxue.com/posts/359#task) |
| [**  9-2 应聘者用户故事 Part 2](https://fullstack.xinshengdaxue.com/posts/361) |                                          |
| [**  9-3 应聘者用户故事Part 3](https://fullstack.xinshengdaxue.com/posts/362) | 共1个作业 \|[** 未完成](https://fullstack.xinshengdaxue.com/posts/362#task) |

| 10 - 招聘网站 - （应聘者）提示 预计学习时间: 1小时以内        |                                          |
| ---------------------------------------- | ---------------------------------------- |
| [**  10-1 实作章节 - 应聘者 - 学习方法](https://fullstack.xinshengdaxue.com/posts/363) |                                          |
| [**  10-2 实作章节 - 应聘者 - 提示 Part 1](https://fullstack.xinshengdaxue.com/posts/365) |                                          |
| [**  10-3 实作章节 - 应聘者 - 提示 Part 2](https://fullstack.xinshengdaxue.com/posts/366) | 共1个作业 \|[** 未完成](https://fullstack.xinshengdaxue.com/posts/366#task) |
| [**  10-4 实作章节 - 应聘者 - 提示 Part 3](https://fullstack.xinshengdaxue.com/posts/367) | 共1个作业 \|[** 未完成](https://fullstack.xinshengdaxue.com/posts/367#task) |

| 11 - 招聘网站 - （应聘者）解答 预计学习时间: 2小时以内        |      |
| ---------------------------------------- | ---- |
| [**  11-1（解答）招聘网站第六部分](https://fullstack.xinshengdaxue.com/posts/123) |      |
| [**  操作示范视频 - 招聘网站第六部分](https://fullstack.xinshengdaxue.com/posts/408) |      |
| [**  11-2（解答）招聘网站第七部分](https://fullstack.xinshengdaxue.com/posts/125) |      |
| [**  操作示范视频 - 招聘网站第七部分](https://fullstack.xinshengdaxue.com/posts/409) |      |

| 12 - Admin履历后台 - 加分习题 预计学习时间: 1小时以内      |      |
| ---------------------------------------- | ---- |
| [**  12-1 加分习题](https://fullstack.xinshengdaxue.com/posts/375) |      |
| [**  12-2（解答）招聘网站第八部分](https://fullstack.xinshengdaxue.com/posts/127) |      |
| [**  操作示范视频 - 招聘网站第八部分](https://fullstack.xinshengdaxue.com/posts/411) |      |

| 13 - 基础知识补充 预计学习时间: 1小时半以内               |      |
| ---------------------------------------- | ---- |
| [**  基础知识补充 DB Migration](https://fullstack.xinshengdaxue.com/posts/122) |      |
| [**  [直播回放\]1月12日 基础知识补充(DB)](https://fullstack.xinshengdaxue.com/posts/386) |      |

| 14 - 招聘网站 PK 魔改大赛 预计学习时间: 2小时以内          |                                          |
| ---------------------------------------- | ---------------------------------------- |
| [**  魔改大赛](https://fullstack.xinshengdaxue.com/posts/389) | 共2个作业 \|[** 未完成](https://fullstack.xinshengdaxue.com/posts/389#task) |
| [**  [直播回放\]1月19日 魔改大赛实操](https://fullstack.xinshengdaxue.com/posts/390) |                                          |
| [**  弹窗教程](https://fullstack.xinshengdaxue.com/posts/392) |                                          |

# [直播回放]1月3日 开学第一课

主讲人：
Xdite老师

时间：
2017年1月3日 20:00

时长：
主讲时长40分钟
答疑环节时长15分钟

概要：
1.课程运作模式
2.学习方法
3.互动答疑Q&A

# 1-1 Computational Thinking - Part 1

在第一堂课，我们想要介绍一个重要的观念。这个概念叫 Computational Thinking。

在过去，我发现许多人对于「入门编程」这件事，存在的最大误解就是：

> 编程 = 学习逻辑、程式语法

所以，上编程课重要的是学语法。

这卻是一个相当大的误会。

而且有着这样误解的人，后来即便学会了程式语言的语法，也要花上极大的时间，才学得会独立开发写程序。

这也就是为什么程序员的养成过程需要这么久时间的原因。

### Computational Thinking

其实，编程不是这样的。

如果你要入门写代码，最重要的其实是养成一种独特的思维：Computational Thinking。

所谓的 Computational Thinking 是什么呢？

- 用计算机解决问题的思维
- 把大问题拆解成可以实作的小问题步骤
- 在实作过程中找到资源

这才是一个程序员应当具备最重要的能力。

下一段，我们将会播放一段由 Extra Credits 与 Stackoverflow 制作的「程序员入门介绍影片」，来介绍这个程序员最重要的基本能力。

### 本节作业

##### [第一周作业](https://fullstack.xinshengdaxue.com/assignments/6)：[本周日记&周记](https://fullstack.xinshengdaxue.com/tasks/76)

已有 213 个第一期同学提交了这个作业 [**看看同学怎么做](https://fullstack.xinshengdaxue.com/tasks/76/other_answers?order=recent)

[**修改作业](https://fullstack.xinshengdaxue.com/tasks/76)

1.请使用[ORID格式](https://fullstack.xinshengdaxue.com/tasks/7)记录每天的学习日记
2.请根据你本周的学习情况写一篇总结周记，内容提到以下两点：1.“本周学到的最棒概念/工具” 2.“本周遇到最大的坑”
然后把日记和周记的博客连接贴在这里，格式如下：
（注意：你的logdown连结应该会是这样 <http://yy4ever.logdown.com/posts/1143304> 而不会有edit的链接）

1/3 日记：（你的博客链接）
1/4 日记：（你的博客链接）
1/5 日记：（你的博客链接）
1/6 周记：（你的博客链接）

1/18日记:http://zhulianjie-blog.logdown.com/posts/1329607-january-18-17-records

# 1-2 Computational Thinking - Part 2

# 1-3 Computational Thinking - Part 3

学编程并不会很困难。困难的是，很多人在当中容易被情绪「淹没」导致「放弃」。

因为，编程是一门在日常生活当中，难有正确对应反应的状况。

### 红画面报错 ≠ 人生失败

这样说吧，当各位在入门编程时，最常遇到的一个状况：

老是遇到红画面报错。几次下来，就会开始质疑自己是不是猪脑袋，怎么会这么容易出错，是不是人生失败组。

这是因为过去在人生中，其实是「少有人当面指出你的错误」，所以一旦自己收到很多「反馈」，就会立即反射到自己「容易犯错」，容易陷入深深的挫败。

但编程的「错误讯息」其实是「不带情绪」的「真实反馈」，如果定神一看，会发现也只是一般的英文而已。可能提示你少打几个字，或拼错字而已。改掉就没事了。

### 学习 ≠ 登山

另外一个挫折点，就是把学习当成是「登山」。一旦短时间看不到成果，就被巨大的压力压垮了。

在这里，我要给各位安利一个新概念：

> 学习是拼图，而不是登山。

学习编程，并不需要从计算机的基础理论知识开始学起，也并不需要把某个编程语言的语法规则全部掌握了，才开始去编程实战。

我们的传统教育，让我们误以为所有的学习必须是，必须把基础打牢固了才可以进行下一步学习。

但其实这是错误的认知。你有看过

- 孩童先学「力学原理」，再学走路吗？
- 厨师先学「热力学」，再学烹饪吗？

当然不是。

所有的人都是从镜像模仿开始，掌握基本的高频小套路，熟练之后，才复盘补充、学习基础理论，最后牢固的。

### 学习实质上是拼图

学习不是登山而是拼图。既然是拼图，就是说你可以这里拼一块，那里拼一块，假以时日，你是可以把整个图给拼起来的。

当然，拼图最有效办法应该是先把整个图的边框给拼起来。这样，你就知道图的边界在那里了，然后，再往中间填东西。

这门课就是以这样的原理 -- 「最外层的边框」 高频小套路 -- 构成的。

### Computational Thinking => Programming

在这里给各位总结一下，编程是什么？编程是：

- 观察输入是什么，输出是什么
- 把大问题拆解成可以实作的小问题
- 在实作过程中找到资源
- 用电脑自动化解决问题

如此单纯而已。

# 2-1 如何自救？

### 如何排除被困难淹没的感觉

（写下来这五个答案）

- 我遇到了什么问题
- 我想要怎么解决
- 我希望别人怎么帮助我
- 如果别人现在无法帮助我的话，我的解决方案
- 这个问题卡住的话，会让我接下来无法继续下去吗？

#### 如何正确的在Slack与交流论坛上发问

#### 第一步：

##### Slack：请用"问题求助"开头；请粘贴出现问题章节的网页链接；请写出哪个步骤在按照教材的要求操作后，出现了什么样的问题。**提问要具体**。

示例：

```
> 问题求助 https://fullstack.xinshengdaxue.com/posts/47  步骤3遇到了问题，按照教材的要求，输入了rails c，却无法得到符合教材步骤3里的结果。我输入的命令无法执行下去。
```

(记得最前面的右尖括号和一个空白"> "不可省略，可以提示助教有人发问)

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/QlPysO2mSzilD8nTsylo_posts245%E5%8F%91%E9%97%AE%E8%A7%84%E5%88%99%E7%AC%AC%E4%B8%80%E6%AD%A5%E9%85%8D%E5%9B%BE.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/QlPysO2mSzilD8nTsylo_posts245%E5%8F%91%E9%97%AE%E8%A7%84%E5%88%99%E7%AC%AC%E4%B8%80%E6%AD%A5%E9%85%8D%E5%9B%BE.png)

##### 交流论坛：请用“（求助）”作为标题开通，写出在哪个步骤遇到了什么问题。

示例：

```
（求助） 6-0 part3 step6遇到了问题，没有绿色提示出现
```

#### 第二步：

请把包含问题（异常结果）的画面截图贴出来，图片要够大，有足够的信息，可以参考[Slack发问截图指南](http://docs.qzy.camp/docs/slack-screen-shot/)。

推荐使用[Snip截图软件](http://snip.qq.com/)。

#### 第三步：

我的专案Github网址是： [https://github.com/github用户名/job-listing](https://github.com/github%E7%94%A8%E6%88%B7%E5%90%8D/job-listing)我的（**不要再贴Atom代码截图了，这才是程序员之间高效交流代码的方式**。做完三遍rails101，上传Github总会了吧）

#### 第四步：

请贴出目前最新的log:（至少贴100行，且贴在text snippet，点击slack输入框左边的＋符号，选择Code or text snippet，复制贴上终端机上的文字）。

[![img](http://ohemzrezo.bkt.clouddn.com/2016-12-10-064306.jpg)](http://ohemzrezo.bkt.clouddn.com/2016-12-10-064306.jpg)

#### 为什么要这样做

当你说你“做了什么”，得到“不如预期的结果”。旁人不知道“你做了什么”，得到“什么结果”。

- 所以你必须提供“输入”（输入就是你写的`代码`，但是要足够完整。贴出一张张`代码截图`的方式其实很低效，所以需要你提供 `github 上传最新结果`）。
- 接着你必须提供“输出”（输出就是你的`浏览器截图`，以及你的 `rails s` log 资料）
- log 有时候很长，推荐为了怕 log 洗到大家的版，请先把 log 贴到 Gist

### 发问之前你可以先这么做

- 深呼吸，有 bug 是正常，不要慌张。
- 只字不差地阅读教材，仔细对照自己输入的代码和命令。
- 读错误讯息，错误讯息“只是英文”，不是“外星文”。你要说服你自己看得懂的。
- 错误讯息怎么阅读：
  - Warning：只是提醒，不太会是关键问题
  - Error：错误讯息（真正关键的地方）
- 把 Error 的第一行第二行贴到 Google，看看有没人已经在

  Stackoverflow


  问过

- 通常答案就在上面

#### 为什么你该这样做

- 虽然旁边的人都很好协助，但也不是无限有耐心，他们更愿意能**高效地帮助人**。
- 有可能你的错误永远都只是在“错误讯息”中，而你从来都不曾先看过，那么你的信用就会开始下降。
- 还没“只字不差地阅读教材”，就直接去问那些教材里已经写清楚的事情，将被视为**伸手党**。直接要来答案看似很爽，却丧失了大好的“提取练习”机会。

# [直播回放]1月23日 编程英语

主讲人：
王秒老师

时间：
1月23日 20:00

时长：
主讲时长约35分钟

概要：
王秒老师带你破解编程中英语这只拦路虎

# 3-1 拆解任务 - Part 1

虽说编程是：

- 观察输入是什么，输出是什么
- 把大问题拆解成可以实作的小问题
- 在实作过程中找到资源
- 用电脑自动化解决问题

但是，许多新手（甚至是入门一年左右的程序员），却不是这样学编程的。

### 错误学习法 Step 1 — 先学编程语法

他们是这样开始的。

- 我想要学 Rails。
- 听说学 Rails 前，要先学 Ruby。
- 为了怕基础不扎实。先去学「基础 Ruby」，买了许多本 Ruby 初级书。
- 虽然说学了很多语法，但感觉学了一大技巧还是不知道要做什么。
- 最后算了，干脆再回去学 Rails。

### 错误学习法 Step 2 — 误入歧途

- 在网路上找到了一门入门书。觉得自己会做讨论版了好开心。
- 但是，发现还是不知道如何「独立」做一个网站」。
- 所以，跑到了程序员聚集的「论坛 上面」问....
- 请问：「怎么做一个购物网站」？
- 然后帖子冒出了一堆「........」（无言嘘声）、「!@#@%^&##$%&*」（热情的外星文）

### 错误学习法 Step 3 — 只好自学

- 因为在网上实在搜不到有效的正确解答，只好开始自学之路。
- 开始学习从「论坛」照自己的想法，进行第一次迁移改成「商店」。
  - 首先，先把购物网站规格列出来。
  - 应该是再做 products 的 CRUD。   * 所以... `rails g controller products`
  - 然后，.........
  - ….. 不行了，我不知道怎么做了....

### 错误学习法 Step 4 — 掉入坑里，情绪崩溃

- 好吧，只好先做自己会做的部分。
- 看起来「会员登入」是很简单的功能，而且用 devise 一下子就做出来了。
- 瞬间感受到自信心爆棚。
- 那继续来挑战 wechat 登入吧？
- ………花了五个小时弄不出来………
- 崩溃！ ！ ！

很多人都笑称以前的学习方法是「从入门到放弃」。

其实，要更精确的形容，是「从入门到崩溃」。

热情勃勃的入门，结果逐渐发现：

- 自己缺乏大多数基础知识
- 不知道怎么问出一个「具体的问题」
- 到处掉坑里，老手也不知道怎样救你

其实这真不是你的错。

因为编程是一门很奇特的学问，如果你按照上学时，学一般纸面知识的方式，来学编程，谁都会 99% 都会掉坑的。

这也是我们第一堂课，要帮助大家解决的问题。

### 正确学编程，正确做项目

我们的第一课，就是要教各位，如何正确的做项目，如何正确的学编程。你将会在这一课，学到：

- 如何把点子变成简单的软体企划
- 怎么把软体企划一步一步执行出来，而不迷路
- 不被自己的情绪绊倒

# 3-2 拆解任务 - Part 2

在继续进行下去之前，我需要各位去文具店买一包便利贴。

- 请务必买到便利贴后，再继续进行下去
- 请不要以其他的形式替代，否则又会掉坑里
- 请只字不差的照做

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/cSj9AWNiRc6KxNLQ9knQ_post-it.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/cSj9AWNiRc6KxNLQ9knQ_post-it.png)

# 3-3 拆解任务 - Part 3

接下来，我们需要各位做一件事。请各位写下：从起床到公司，写下 10-15 件你会做的事。

一张便条纸，写一件事。

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/4brWvlGQT1q7PoDJLaNd_WechatIMG1%20(1).jpeg)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/4brWvlGQT1q7PoDJLaNd_WechatIMG1%20(1).jpeg)

# 3-4 拆解任务 - Part 4

接着，请把你认为是目标类似的便利贴放在一组

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/HPIbqnuATW6ILyzJ4Sg4_%E8%9E%A2%E5%B9%95%E5%BF%AB%E7%85%A7%202016-12-30%20%E4%B8%8B%E5%8D%885.26.56.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/HPIbqnuATW6ILyzJ4Sg4_%E8%9E%A2%E5%B9%95%E5%BF%AB%E7%85%A7%202016-12-30%20%E4%B8%8B%E5%8D%885.26.56.png)

叠在一起，如下图所示。

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/GwRyUQJDRNuBYXpsE2Bw_WechatIMG2%20(1).jpeg)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/GwRyUQJDRNuBYXpsE2Bw_WechatIMG2%20(1).jpeg)

### 本节作业

##### [第一周作业](https://fullstack.xinshengdaxue.com/assignments/6)：[上传你的任务清单](https://fullstack.xinshengdaxue.com/tasks/31)

已有 271 个第一期同学提交了这个作业 [**看看同学怎么做](https://fullstack.xinshengdaxue.com/tasks/31/other_answers?order=recent)

[**修改作业](https://fullstack.xinshengdaxue.com/tasks/31)

请按照课程示范图片把你的任务清单归类之后拍照上传。

[![img]()pasted-file-1.png 322.14 KB](https://www.filepicker.io/api/file/lVuS3vu3QKuVTHahXG5y)

# 3-5 拆解任务 - Part 5

接着找出群组的「类似特征」。接着你开始就会发现，其实这一连串的动作都是有特殊目的的。

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/n0Jt4S2bQ4asSmMWU2SH_%E8%9E%A2%E5%B9%95%E5%BF%AB%E7%85%A7%202016-12-30%20%E4%B8%8B%E5%8D%885.30.29.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/n0Jt4S2bQ4asSmMWU2SH_%E8%9E%A2%E5%B9%95%E5%BF%AB%E7%85%A7%202016-12-30%20%E4%B8%8B%E5%8D%885.30.29.png)

接着，我们希望各位找到一张大桌面，或者大白纸。切成这四区。

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/oM2ZxEZNSDqXiHrO9soe_%E8%9E%A2%E5%B9%95%E5%BF%AB%E7%85%A7%202016-12-30%20%E4%B8%8B%E5%8D%885.35.53.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/oM2ZxEZNSDqXiHrO9soe_%E8%9E%A2%E5%B9%95%E5%BF%AB%E7%85%A7%202016-12-30%20%E4%B8%8B%E5%8D%885.35.53.png)

然后把便利贴拆开按照你认为的权重，贴进去。

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/uklTnDQTQky23JnMYSmW_WechatIMG3.jpeg)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/uklTnDQTQky23JnMYSmW_WechatIMG3.jpeg)

# 3-6 拆解任务 - Part 6

接着你会发现，许多人的权重是完全不一样的。

#### A : 公事为重

比如 A 这位朋友，可能就是个公事为重的人，早餐对他来说可能是 Nice to Have

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/VHC55nb6Sb2Slg2yGJTS_%E8%9E%A2%E5%B9%95%E5%BF%AB%E7%85%A7%202016-12-30%20%E4%B8%8B%E5%8D%885.41.49.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/VHC55nb6Sb2Slg2yGJTS_%E8%9E%A2%E5%B9%95%E5%BF%AB%E7%85%A7%202016-12-30%20%E4%B8%8B%E5%8D%885.41.49.png)

#### B : 保持步调

B 这位朋友，他认为保持步调，先吃早餐，再去上班才是王道。

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/Tq8hdncHSPiJwUnsKsjs_%E8%9E%A2%E5%B9%95%E5%BF%AB%E7%85%A7%202016-12-30%20%E4%B8%8B%E5%8D%885.41.55.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/Tq8hdncHSPiJwUnsKsjs_%E8%9E%A2%E5%B9%95%E5%BF%AB%E7%85%A7%202016-12-30%20%E4%B8%8B%E5%8D%885.41.55.png)

#### C : 放一边

C 这位朋友，显然是个时尚一族。认为花时间打扮，先去跟女友约会，公事其实可以放一边。

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/630mgqE1TZaoujyaBCZg_%E8%9E%A2%E5%B9%95%E5%BF%AB%E7%85%A7%202016-12-30%20%E4%B8%8B%E5%8D%885.42.01.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/630mgqE1TZaoujyaBCZg_%E8%9E%A2%E5%B9%95%E5%BF%AB%E7%85%A7%202016-12-30%20%E4%B8%8B%E5%8D%885.42.01.png)

### 拆解任务的目的

这个小作业，其实是让各位能够体验到，其实自己在日常生活中，无形之中，也是懂做项目管理的。甚至是内建在自己的大脑之中。这个小作业，只是慢动作回放这个过程而已。

接下来的编程项目，也是可以用这个方式做慢动作回放的。

# 3-7 拆解任务 - Part 7

这一课，我们要做的是搭建一个简单的招聘网站，请按照一样的方式。

- 写下 7-10 件你觉得需要做的功能
- 整理出目的群组
- 按照 Must Have / Should Have / Could Have / Nice to Have 整理出一张图

#### 本节作业

##### [第一周作业](https://fullstack.xinshengdaxue.com/assignments/6)：[拆解招聘网站任务](https://fullstack.xinshengdaxue.com/tasks/72)

已有 264 个第一期同学提交了这个作业 [**看看同学怎么做](https://fullstack.xinshengdaxue.com/tasks/72/other_answers?order=recent)

[**修改作业](https://fullstack.xinshengdaxue.com/tasks/72)

在便利贴上写下你认为招聘网站需要的功能，按照Must Have / Should Have / Could Have / Nice to Have 归类之后拍照上传。

[![img]()pasted-file-1.png 597.74 KB](https://www.filepicker.io/api/file/lCA9aEYSo6HCAczj32HO)

# 4-1 用户故事 - Part 1

### Must Have / Should Have

当你书写过一轮功能之后，会发现最后留下的 Must Have / Should Have，应该会剩下这四大部分。

- 张贴系统 - 公司，撰写工作需求
- 观看机制 - 应征者，过滤理想工作
- 应征系统 - 应征者， 可以上传简历
- 管理系统 - 管理员可以删除隐藏工作

接着我们可以最慢的镜头，再拆解一次，发现整个系统里面有三个角色：

- 张贴系统 - `公司`，撰写工作需求
- 观看机制 - `应征者`，过滤理想工作
- 应征系统 - `应征者`, 可以上传简历
- 管理系统 - `管理员`可以删除隐藏工作

#### 找出角色

- 公司
- 应征者
- 管理员

然而，一个系统里面若有三个角色，其实太复杂了一些。

我们可以将现在要做的这个招聘系统，定调为公司内部自己要用的招聘系统。那么角色就会变成剩下两个而已：

- 公司 = 管理员
- 应征者

#### 只有两个角色的系统

让我们再重新整理一遍，需求最后会变成：

- 张贴系统 - 管理员，撰写需求
- 管理系统 - 管理员可以删除隐藏工作
- 观看机制 - 应征者，过滤理想工作
- 应征系统 - 应征者, 可以上传简历

# 4-2 用户故事 - Part 2

接下来，我们要来介绍一个新工具：User Story 用户故事。

### User Story 用户故事

用户故事是进行软件开发时，常用的一个基本工具。

当我们在进行一个实体项目时，常常被许多需求压到喘不过气。有时候做太多、有时候做太少，有时候做歪。用户故事就是用来解决这件事情的。

用户故事的主张就是我们应该

- 以「角色」的观点
- 理清会发生的「故事」
- 以解决或达到某种「效果」

### 用户故事的格式

所以用户故事是这样的：

> 身为「某角色」，会做「某事」，以完成「某商业价值」

如果以「招聘系统」为例的话，用户故事大概就会是这样：

- 身为管理员，可以张贴职缺，以达到招募人才的需求
- 身为应征者，可以筛选职缺，以达到「筛选到自己心仪薪资水准的工作」
- ……
- ……

一般来说，以小型专案来说，初始项目约落在 20-30条，中型项目约100条。

### 为什么要使用 User Story 整理系统需求

这是因为如果使用User Stroy，从用户的角度去出发思考，以角色为中心去叙述未来会发生什么事情。那么整个项目的视野，瞬间就会变得非常聚焦，所有功能都是「各角色所需要的关键功能」。

也不会花了一堆时间，按照「规格」完善了自己认为的关键功能，却少了全局观。

#### 常见项目失败例子

比如说像我们以前在开发项目时，最常出现的状况是：客户在规格上说要项目要有订单系统，而开发组老老实实做了给「一般用户用」的订单系统。

但在结案最后一刻，客户却说了：「你们怎么那么不专业呢？后台订单系统你们都没做，至少还需要出货功能、对账功能，还有物流系统啊！这不是你们都得想到吗？」

整个系统复杂度瞬间暴增 10 倍。

但是如果你若不完成，客户就扬言不给尾款，甚至告你……

#### 失败的原因——「角色」

这是因为多数的开发者，常只顾着开发「规格上的东西」。

而忽略了「系统是要给人用的」，没有问清楚这个系统里面有多少「角色」。

> 「角色」正是系统的复杂度关键。

通常来说，每多一个「角色」，系统复杂度就会多上一个「次方」。不得不谨慎。

这也是为什么我们要在这一课当中，削减「角色」数量。

# 4-3 用户故事 - Part 3

在这一课，我们要请各位拿出

- 一本全白的笔记本
- 一支蓝笔
- 一支绿笔

跟着我这样做。

（ 请千万不要跳过这个步骤。我们需要各位真的也照着写下来，才会记住这个方法）

把第一版用户故事写下来。

（请跟着照抄，如图所示）

![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/M74Ov1oQVaAUdw8DBsS5_%E7%9B%B8%E7%89%87%202016-12-30%2020%2038%2046.jpg)

# 4-4 用户故事 - Part 4

接着把「角色」圈起来

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/UPzmpd7S1msul96EILVp_%E7%9B%B8%E7%89%87%202016-12-30%2020%2041%2017.jpg)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/UPzmpd7S1msul96EILVp_%E7%9B%B8%E7%89%87%202016-12-30%2020%2041%2017.jpg)

然后，我们发现了这个系统内有两个角色：

- 管理者
- 应征者

在第一周，我们会优先实作「管理者」这个角色。

# 4-5 用户故事 - Part 5

接着我们写下「管理员」所需要做的事

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/6iP5KiFBRai5eioNZuzg_%E7%9B%B8%E7%89%87%202016-12-30%2020%2042%2053.jpg)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/6iP5KiFBRai5eioNZuzg_%E7%9B%B8%E7%89%87%202016-12-30%2020%2042%2053.jpg)

在哪里做这些事呢？在`后台`

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/2GVRrbvFSoeNWEQWOSGD_%E7%9B%B8%E7%89%87%202016-12-30%2020%2043%2016.jpg)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/2GVRrbvFSoeNWEQWOSGD_%E7%9B%B8%E7%89%87%202016-12-30%2020%2043%2016.jpg)

职缺需求有哪些栏位呢？

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/gDSoiHwR3qS266PwKwgA_%E7%9B%B8%E7%89%87%202016-12-30%2020%2045%2003.jpg)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/gDSoiHwR3qS266PwKwgA_%E7%9B%B8%E7%89%87%202016-12-30%2020%2045%2003.jpg)

# 4-6 用户故事 - Part 6

(请务必手写练习)

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/Q5nBFZnlRefDq4fzPvG9_%E7%9B%B8%E7%89%87%202016-12-30%2020%2054%2004.jpg)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/Q5nBFZnlRefDq4fzPvG9_%E7%9B%B8%E7%89%87%202016-12-30%2020%2054%2004.jpg)

### 職缺

然后我们就会发现，我们需要一个 Job 的 model。里面要包含

- 标题
- 内容
- 薪资上限
- 薪资下限
- 联系方式

### 后台

而后台的设计，需要一个 User 的 model。而 user model 需要

- admin 身份登记
- 能够有 登入 / 登出设计

# 4-7 用户故事 - Part 7

然后我们就得出了最后一个可以实作的版本

- 身为管理者，我可以新增职缺需求
  - 包括「标题」「内容」「薪资上限」「薪资下限」「联系方式」
- 身为管理者，我可以编辑 / 删除职缺需求 （在后台）
- 身为管理者，我可以隐藏职缺需求 （在后台）
- 身为使用者，我必须「登入」才能申请职缺
- 身为使用者，我必须要有「admin 身份标识」才能进入后台

### 本节作业

##### [第一周作业](https://fullstack.xinshengdaxue.com/assignments/6)：[上传你的用户故事](https://fullstack.xinshengdaxue.com/tasks/73)

已有 266 个第一期同学提交了这个作业 [**看看同学怎么做](https://fullstack.xinshengdaxue.com/tasks/73/other_answers?order=recent)

[**修改作业](https://fullstack.xinshengdaxue.com/tasks/73)

将你的招聘网站用户故事手写在笔记本上，并拍照上传。

[![img](https://www.filepicker.io/api/file/v3NfyygJRQiu0ecMYwHS)pasted-file-1.png 421.08 KB](https://www.filepicker.io/api/file/v3NfyygJRQiu0ecMYwHS)
[![img]()pasted-file-2.png 345.19 KB](https://www.filepicker.io/api/file/aW6m2mz0Tuek0IgKViVc)

# 5-1 Fork 教学

### Step 1: Fork 专案

到 <https://github.com/quanzhanying/job-listing> 去 Fork 专案，点击Fork图标：

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/Vh5VAdoFTkW9nfT0iSnZ_Snip20170103_11.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/Vh5VAdoFTkW9nfT0iSnZ_Snip20170103_11.png)

### Step 2:

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/vxc5QDhiThy8lphu0kbA_step-2-fork-result.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/vxc5QDhiThy8lphu0kbA_step-2-fork-result.png)

### Step 3:

点选 Clone or Download 取得自己的 clone url，并复制到剪贴簿

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/aTiQc6aTMKu1Xi6HYJwo_step-3-copy-to-pb.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/aTiQc6aTMKu1Xi6HYJwo_step-3-copy-to-pb.png)

### Step 4 :

- clone 你 frok 的 job-listing 专案到本地
- 复制 database.yml.example
- git checkout version-1

跑起来。具体指令如下：

`git clone git@github.com:XXXXX/job-listing.git`
（XXXXX 是你的 github 用户名）
`cd job-listing`
`git checkout -b version-1`
`cp config/database.yml.example config/database.yml`
`bundle check`
`bundle install`
`rails s`

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/JubtC5fT2mTKVi1it4A8_step-4-clone-to-local.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/JubtC5fT2mTKVi1it4A8_step-4-clone-to-local.png)

如果你在执行`bundle check`遇到了如下画面，出现红字提醒说有gems missing，不用紧张，这只是check了以后发现还有一些gem没有安装，继续执行`bundle install`就能把他们补全。

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/CH0oDSCMQM6sSVYs7ToK_missing.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/CH0oDSCMQM6sSVYs7ToK_missing.png)

### 本节作业

##### [第一周作业](https://fullstack.xinshengdaxue.com/assignments/6)：[Fork 第一个专案](https://fullstack.xinshengdaxue.com/tasks/32)

已有 290 个第一期同学提交了这个作业 [**看看同学怎么做](https://fullstack.xinshengdaxue.com/tasks/32/other_answers?order=recent)

[**修改作业](https://fullstack.xinshengdaxue.com/tasks/32)

贴上你 fork 专案之后的个人 github 项目网址（ you-account-name 是你的 github 账号）
格式类似这样<https://github.com/you-account-name/job-listing>

https://github.com/mind1949/job-listing

# 5-2 Pull Request 教学

### Step 1: 对 README.md 做一些修改

在终端机输入
`atom README.md`

打开如下

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/RmEzq63DRSuibBtQQHQ3_README1.md.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/RmEzq63DRSuibBtQQHQ3_README1.md.png)

替换成这样(或任何其他的内容)

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/E8PhH4leRIqNa77qsi5q_README2.md.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/E8PhH4leRIqNa77qsi5q_README2.md.png)

#### 存档并push上Github

`git add .`
`git commit -m "first week"`
`git push origin version-1`

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/3I7TpVUqRqGHpDF53dnv_git_push.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/3I7TpVUqRqGHpDF53dnv_git_push.png)

### STEP 2: 开启你的 github 页面

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/v9DBK7hWSK6I07PqEUsB_Snip20170103_14.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/v9DBK7hWSK6I07PqEUsB_Snip20170103_14.png)

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/tvtDoO40RP2RDrzhdvjx_pull%20request.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/tvtDoO40RP2RDrzhdvjx_pull%20request.png)

### STEP 3: 复制网址交作业

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/DuCf3nZ9S2S1NDgFcCvZ_Snip20170103_15.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/DuCf3nZ9S2S1NDgFcCvZ_Snip20170103_15.png)

# 操作示范视频 - Fork & Pull Request

# 5-3 招聘网站 - 实作提示

其实到这里。我们就把步骤拆的已经与「中级练习」非常的相似，也非常的简单。

- 身为管理者，我可以在新增职缺需求   - 包括「标题」「内容」「薪资上限」「薪资下限」「联系方式」
- 身为管理者，我可以编辑 / 删除职缺需求 （在后台）
- 身为管理者，我可以隐藏职缺需求 （在后台）
- 身为使用者，我必须「登入」才能发表职缺
- 身为使用者，我必须要有「admin 身份注记」才能进入后台

若同学们，对中级练习非常熟悉的话，步骤其实是这样的：

### Step 1

- 套上 Bootstrap 页面
- 安装 simple_form
- 安装 devise （须做到可以登入 / 登出）

### Step 2

- 实作 Job 的 CRUD （ JobsController )
- 先只开 Job 的 title, description
- （最小可行性界面）

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/Ru18jJRaQ1CykjwsUTPk_p1.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/Ru18jJRaQ1CykjwsUTPk_p1.png)

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/Ufpd0SokRA260RbP2l7O_p2.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/Ufpd0SokRA260RbP2l7O_p2.png)

### Step 3 - 1

- 要新增 / 修改 / 删除 Job 必须得登入

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/S9RjJ9DuTr2MqeYhWTJz_p3.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/S9RjJ9DuTr2MqeYhWTJz_p3.png)

### Step 3 - 2

- 实作 Job 的 Admin 的 CRUD，在 admin/jobs
- 下拉选单要有一个链接可以到 admin_jobs_path

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/0A3w4oU8QE2OaMM79Jpl_p4.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/0A3w4oU8QE2OaMM79Jpl_p4.png)

### Step 3 - 3

- 在 admin / jobs 皆需要先过 require_is_admin 才能进入，否则回去首页
- 定义一个条件 admin? 判断是否是 admin

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/o2ekvRyRAGWKs6YrlCPR_p5.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/o2ekvRyRAGWKs6YrlCPR_p5.png)

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/H21VBjyxQhOFhDmYmaxc_Screenshot%20at%20Feb%2010%2017-25-54.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/H21VBjyxQhOFhDmYmaxc_Screenshot%20at%20Feb%2010%2017-25-54.png)

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/Mb1WLgUpTYSbPlREGY5k_p7.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/Mb1WLgUpTYSbPlREGY5k_p7.png)

### Step 3 - 4

- 新增「薪资上限」与「薪资下限」、「联络方式」
  - wage_upper_bound
  - wage_lower_bound
  - contact_email
- 「薪资上限」、「薪资下限」不得为空
- 「薪资」必须是数字

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/Pe9CdPDlQRWfg63tyrUC_p8.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/Pe9CdPDlQRWfg63tyrUC_p8.png)

### Step 3 - 5

- 管理者可以设定职缺是否在前台隐藏

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/1bXq77YSkeGSzGMMH4nL_p9.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/1bXq77YSkeGSzGMMH4nL_p9.png)

### Step 3 - 6

- 被设为隐藏的职缺，是不可以在前台看到的。

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/2fM4PmLpTEy3axCXw7AG_p10.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/2fM4PmLpTEy3axCXw7AG_p10.png)

### Step 4

- 首页职缺应该按照发表时间顺序

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/iPNrO2QJRZe3woCqz61V_p11.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/iPNrO2QJRZe3woCqz61V_p11.png)

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/FK2fwoJySGmlQfjcPvb8_p12.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/FK2fwoJySGmlQfjcPvb8_p12.png)

# 5-4 招聘网站 - 代码提示

### 示范程式码网址：

- <https://github.com/xdite/job-listing>

### 方向一：如何做出 `require_is_admin?`

#### 用 `before_action` 做出 限制 （先使用 email ）

<https://github.com/xdite/job-listing/commit/804ea8d1fcf30b11f9d072b097ff2ee93bb92017>

#### 然后把条件搬到 user model

<https://github.com/xdite/job-listing/commit/bba8c16b48718f86b613229f6824ebbb49612cb2>

#### 再把 条件改为吃 is_admin 栏位

<https://github.com/xdite/job-listing/commit/5f7302da10088a8fe60ba4cc3aac8447122e47f4>
<https://github.com/xdite/job-listing/commit/cb0ef1b5994f38da0fb585e2eff4adf49cb967f4>

这时候可以去 rails console 里面把当初的 user 改为 admin

```
u = User.first
u.is_admin = true
u.save!
```

#### 再把 require_is_admin 搬到 application_controller

<https://github.com/xdite/job-listing/commit/7ae248298d898be9ee13c1361abde942a1118b5a>

### 方向二：薪资必须要是数字

#### 在 model 里面限制

<https://github.com/xdite/job-listing/commit/99bdfd5dfbc89cf1e1cc6aa8a3b297522cc7687e>

### 方向三：前台只能看到公开的职缺

- <https://github.com/xdite/job-listing/commit/c7b86bd3199740dcaa9c9251cec745e38a5e4966>

### 方向四：前台必须按照更新时间倒序排列

- <https://github.com/xdite/job-listing/commit/fb97a5d66cf434e0ff06234abd8ffa6cb204413a>

# 5-5 招聘网站 - 学习方法

在这里我们分成两套学习方法，提供同学使用：

### 还未牛逼的同学

还是觉得一头懵的同学，请你直接看解答。

- 第一遍用贴的
- 第二遍用打的
- 第三遍自己写出来

如果你准备做第二遍，请参考这篇帮助文档[利用Github 做第二遍作业](http://docs.qzy.camp/docs/github-job-listing-2)

### 牛逼的同学

课前已经觉得中级练习很简单的牛逼同学，请你直接按照提示，看着中级练习实作出来。

#### 10.12系统的同学请注意

请在git clone完成以后进入专案，把Gemfile里的两个spring gem注销掉。
具体可以参考[macOS 10.12 排 Bug 指南](http://docs.qzy.camp/docs/sierra)

#### 动图制作

下面作业会需要提交动图。制作方法，请查阅下一页[5-6 使用 LICEcap Demo 演示网页（录制成gif动画）](https://fullstack.xinshengdaxue.com/posts/101)

### 本节作业

##### [第一周作业](https://fullstack.xinshengdaxue.com/assignments/6)：[完成网站框架雏形](https://fullstack.xinshengdaxue.com/tasks/33)

已有 238 个第一期同学提交了这个作业 [**看看同学怎么做](https://fullstack.xinshengdaxue.com/tasks/33/other_answers?order=recent)

[**提交作业](https://fullstack.xinshengdaxue.com/tasks/33)

- 套上 Bootstrap
- 安装 devise
- 安装 SimpleForm
  请将浏览器里实现以上功能的画面截图，然后上传你的截图
  提示：请回去翻教程
- <https://fullstack.xinshengdaxue.com/posts/55> 帮 Rails 专案穿上衣服“Bootstrap”
- <https://fullstack.xinshengdaxue.com/posts/56> 套用 Bootstrap 的 html 样式
- <https://fullstack.xinshengdaxue.com/posts/57> 制作漂亮的“提示讯息”
- <https://fullstack.xinshengdaxue.com/posts/71> 安装 devise gem
- <https://fullstack.xinshengdaxue.com/posts/68> 将表单换为 Bootstrap 提供的版型

或者查看解答 <https://fullstack.xinshengdaxue.com/posts/338>

##### [第一周作业](https://fullstack.xinshengdaxue.com/assignments/6)：[实作招聘网站第一部分](https://fullstack.xinshengdaxue.com/tasks/37)

已有 227 个第一期同学提交了这个作业 [**看看同学怎么做](https://fullstack.xinshengdaxue.com/tasks/37/other_answers?order=recent)

[**提交作业](https://fullstack.xinshengdaxue.com/tasks/37)

- 实作 Jobs 的 CRUD
- Job 至少必须要有 title 与 description 栏位
- Job 的 title 不可为空
- new/create/update/edit/destroy 动作必须要进行登入
  请贴浏览器里实现以上功能的相关图片和动图

##### [第一周作业](https://fullstack.xinshengdaxue.com/assignments/6)：[实作招聘网站第二部分](https://fullstack.xinshengdaxue.com/tasks/36)

已有 221 个第一期同学提交了这个作业 [**看看同学怎么做](https://fullstack.xinshengdaxue.com/tasks/36/other_answers?order=recent)

[**提交作业](https://fullstack.xinshengdaxue.com/tasks/36)

- 实作 Admin 的 CRUD
- 身为管理者才可以存取 <http://localhost:3000/admin/jobs> 下的职缺操作
- 身为管理者才可以看到 Admin 管理选单的连结
- admin 的判定应该使用资料库的判断 is_admin
  请贴浏览器里实现以上功能的相关图片和动图

##### [第一周作业](https://fullstack.xinshengdaxue.com/assignments/6)：[实作招聘网站第三部分](https://fullstack.xinshengdaxue.com/tasks/38)

已有 220 个第一期同学提交了这个作业 [**看看同学怎么做](https://fullstack.xinshengdaxue.com/tasks/38/other_answers?order=recent)

[**提交作业](https://fullstack.xinshengdaxue.com/tasks/38)

- 新增“薪资上限”“薪资下限”“联络 Email”
- 薪资不能为空，最低薪资至少要大于 0
  请贴浏览器里实现以上功能的相关图片和动图

##### [第一周作业](https://fullstack.xinshengdaxue.com/assignments/6)：[实作招聘网站第四部分](https://fullstack.xinshengdaxue.com/tasks/39)

已有 220 个第一期同学提交了这个作业 [**看看同学怎么做](https://fullstack.xinshengdaxue.com/tasks/39/other_answers?order=recent)

[**提交作业](https://fullstack.xinshengdaxue.com/tasks/39)

- 首页应该看不到隐藏的工作
- 首页的工作应该按照建立时间倒叙排列
- 后台的 Job List 列表，应该显示哪一些工作是“隐藏”还是“公开”
  请贴浏览器里实现以上功能的相关图片和动图

# 5-6 使用 LICEcap Demo 演示网页（录制成gif动画）

LICEcap 是一个动画录制软件，可以将屏幕区域录制成 gif 动画文件便于发布。

之后我们需要使用 LICEcap 录制 gif 动画来缴交作业。

前往 <http://www.cockos.com/licecap/>

下载LICEcap并安装：

<http://www.cockos.com/licecap/licecap125.dmg> (目前最新版)

(官方动画教程: <http://www.cockos.com/licecap/how_to_licecap.gif> )

### 本节作业

##### [第一周作业](https://fullstack.xinshengdaxue.com/assignments/6)：[提交第一周作业](https://fullstack.xinshengdaxue.com/tasks/40)

已有 227 个第一期同学提交了这个作业 [**看看同学怎么做](https://fullstack.xinshengdaxue.com/tasks/40/other_answers?order=recent)

[**提交作业](https://fullstack.xinshengdaxue.com/tasks/40)

请按照教材要求完成作业，然后提交你的 pull request
1.把 pull request 的网址贴在这里
2.把你的成果录制成 gif ，然后将 gif 图片上传到这里

# 6-0（解答）穿衣服

## Part 1 安装 Bootstrap

### Step 1. 帮专案穿上衣服 Bootstrap，挂上 bootstrap-sass 这个 gem

Bootstrap 是 Web 设计圈有名的 CSS 框架，提供了开发专案快速便利的元件素材，如按钮、下拉选单、表格等等样式。

在 Rails 上要帮专案穿上 Bootstrap，用的是 `bootstrap-sass` 这个套件。

修改 Gemfile，在 `group :development, :test do` 前一行加入 `gem 'bootstrap-sass'`

Gemfile

```
+  gem 'bootstrap-sass'

   group :development, :test do
```

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/h5XvJCjtRYqcauTwQyds_bootstrap.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/h5XvJCjtRYqcauTwQyds_bootstrap.png)

### Step 2. bundle install

执行 `bundle install`

(注意：修改完 Gemfile 都要执行 bundle install）

### Step 3. 将 Bootstrap 的 CSS 套件装进专案里面

输入

```
mv app/assets/stylesheets/application.css app/assets/stylesheets/application.scss
```

将 `application.css` 更名为 `application.scss`

然后修改内容加入这两行

app/assets/stylesheets/application.scss

```
/*
 * ...(一堆注解)
 *= require_tree .
 *= require_self
 */

@import "bootstrap-sprockets";
@import "bootstrap";
```

### Step 4. 将变更 commit 进去 git 里面。

```
git add .
git commit -m "add bootstrap to project"
```

## Part 2 增加样式

### Step 1. 新增 app/views/common 资料夹

`mkdir app/views/common`

### Step 2. 新增 navbar

`touch app/views/common/_navbar.html.erb`

填入

app/views/common/_navbar.html.erb

```
<nav class="navbar navbar-default" role="navigation">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header">
            <a class="navbar-brand" href="/">Job Listing </a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <%= link_to("登入", '#') %>
                </li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container-fluid -->
</nav>
```

### Step 3. 新增 footer

`touch app/views/common/_footer.html.erb`

填入

app/views/common/_footer.html.erb

```
<footer class="container" style="margin-top: 100px;">
    <p class="text-center">Copyright ©2016 Rails101
        <br>Design by yourname

    </p>
</footer>
```

### Step 4. 修改全域 HTML 样式 application.html.erb

app/views/layouts/application.html.erb

```
<!DOCTYPE html>
<html>
    <head>
        <title>Job Listing </title>
        <%= csrf_meta_tags %>

        <%= stylesheet_link_tag    'application', media: 'all', 'data-turbolinks-track': 'reload' %>
        <%= javascript_include_tag 'application', 'data-turbolinks-track': 'reload' %>
    </head>

    <body>

        <div class="container-fluid">
            <%= render "common/navbar" %>
            <%= yield %>
        </div>

        <%= render "common/footer" %>

    </body>
</html>
```

### Step 5. 产生一个新的空 Hello World 页面 （放在 welcome#index)**

- 新增一个 welcome controller

`rails g controller welcome`

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/kYNRc151TyCxTdv1FCpS_%E8%9E%A2%E5%B9%95%E5%BF%AB%E7%85%A7%202016-07-11%20%E4%B8%8A%E5%8D%882.04.25.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/kYNRc151TyCxTdv1FCpS_%E8%9E%A2%E5%B9%95%E5%BF%AB%E7%85%A7%202016-07-11%20%E4%B8%8A%E5%8D%882.04.25.png)

- 新增一个空的 HelloWorld 页面

`touch app/views/welcome/index.html.erb`

填入

app/views/welcome/index.html.erb

```
<h1> Hello World! </h1>
```

### Step 6. 将首页指到 welcome 下的 index.html.erb 页面

修改 `config/routes.rb`，改成以下内容

config/routes.rb

```
Rails.application.routes.draw do
  root 'welcome#index'
end
```

### Step 7. git 进度存档

`git add .`
`git commit -m "add bootstrap html"`

### Step 8. 重开 Rails Server

`rails s`

## Part 3 增加 flash 功能

### Step 1. 将 Boostrap 的 js 提示套件 bootstrap/alert “挂”进专案里面

在 `requre_tree` 上加入 `//= require bootstrap/alert`

app/assets/javascripts/application.js

```
... (一堆注解)
//= require jquery
//= require jquery_ujs
//= require turbolinks
+//= require bootstrap/alert
//= require_tree .
```

### Step 2. 新增 app/views/common/_flashes.html.erb

`touch app/views/common/_flashes.html.erb`

填入

app/views/common/_flashes.html.erb

```
<% if flash.any? %>
  <% user_facing_flashes.each do |key, value| %>
    <div class="alert alert-dismissable alert-<%= flash_class(key) %>">
      <button class="close" data-dismiss="alert">×</button>
      <%= value %>
    </div>
  <% end %>
<% end %>
```

### Step 3. 加入 app/helpers/flashes_helper.rb

`touch app/helpers/flashes_helper.rb`

加入以下内容：

app/helpers/flashes_helper.rb

```
module FlashesHelper
  FLASH_CLASSES = { alert: "danger", notice: "success", warning: "warning"}.freeze

  def flash_class(key)
    FLASH_CLASSES.fetch key.to_sym, key
  end

  def user_facing_flashes
    flash.to_hash.slice "alert", "notice","warning"
  end
end
```

### Step 4. 在 application.html.erb 内加入 flash 这个 partial

在 `<%= yield %>` 前加入 `<%= render "common/flashes" %>`

app/views/layout/application.html.erb

```
 <%= render "common/flashes" %>
  <%= yield %>
```

### Step 5. git 存档

```
git add .
git commit -m "add bootstrap flash function"
```

### Step 6: 测试 flash helper 的功能

修改 `app/controllers/welcome_controller.rb`。加入 `flash[:notice] = "早安！你好！"`。你应该可以看到系统跳出“绿色”提示窗。

app/controllers/welcome_controller.rb

```
class WelcomeController < ApplicationController
  def index
    flash[:notice] = "早安！你好！"
  end
end
```

## Part 4 : 安装 Devise

### Step 1: 安装登入系统

Devise 是一个 Rails 内热门的 gem，专门用来快速实作“登入系统”。在这一章我们会用 devise 实作登入功能。

Gemfile 新增一行

 `gem 'devise'`

Gemfile

`gem 'devise'`

然后执行

`bundle install`

### Step 2 : 产生会员系统的必要档案

执行

```
rails g devise:install
rails g devise user
rake db:migrate
```

### Step 3: 修改 app/views/common/_navbar.html.erb

app/views/common/_navbar.html.erb

```
-                <li> <%= link_to("登入", '#') %>   </li>
+                <% if !current_user %>
+                  <li><%= link_to("注册", new_user_registration_path) %> </li>
+                  <li><%= link_to("登入", new_user_session_path) %></li>
+                <% else %>
+                  <li class="dropdown">
+                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">
+                        Hi!, <%= current_user.email %>
+                        <b class="caret"></b>
+                    </a>
+                    <ul class="dropdown-menu">
+                        <li> <%= link_to("登出", destroy_user_session_path, method: :delete) %> </li>
+                    </ul>
+                  </li>
+                <% end %>
```

### Step 4: 修改 app/assets/javascripts/application.js

加入 `//= require bootstrap/dropdown`

app/assets/javascripts/application.js

```
//= require bootstrap/alert
+ //= require bootstrap/dropdown
```

成果应该会是这样的效果。

### Step 5: git 储存

```
git add .
git commit -m "user can login/logout/signup"
```

## Part 5 : 安装 simple_form

### Step 1: 使用 SimpleForm 简化

首先我们要来安装 simple_form

打开 Gemfile，然后新增一行 `gem 'simple_form'`

Gemfile

```
gem 'bootstrap-sass'
+ gem 'simple_form'
```

然后执行

`bundle install`

安装 gem。

### Step 2: 安装 simple_form for bootstrap 的设定

执行：

`rails generate simple_form:install --bootstrap`

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/qhG8fT0yICTvwdE71igI_%E8%9E%A2%E5%B9%95%E5%BF%AB%E7%85%A7%202016-07-11%20%E4%B8%8B%E5%8D%885.45.42.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/qhG8fT0yICTvwdE71igI_%E8%9E%A2%E5%B9%95%E5%BF%AB%E7%85%A7%202016-07-11%20%E4%B8%8B%E5%8D%885.45.42.png)

然后重开 rails server（ `ctrl-c` 然后 `rails s`）

### Step 3 : git 存档

```
git add .
git commit -m "install simpleform with bootstrap"
```

# 操作示范视频 - 穿衣服

# 6-1（解答）招聘网站第一部分

## 目标：

- 实作 Jobs 的 CRUD
- Job 至少必须要有 title 与 description 栏位
- Job 的 title 不可为空
- new/create/update/edit/destroy 动作必须要进行登入

P.S. 如果你想要详细记录每步做了什么，建议每一步都 git commit 。

## 步骤

### Step 0:

`git checkout -b step1`

### Step 1: 产生 job model

```
rails g model job title:string description:text
rake db:migrate
```

### Step 2: 产生 jobs_controller

`rails g controller jobs`

### Step 3：加上 jobs routing

修改 `config/routes.rb`

config/routes.rb

```
Rails.application.routes.draw do
  devise_for :users

   resources :jobs
   root 'welcome#index'
end
```

### Step 4 : 实作 jobs#show action

新增 `show` 的 action

app/controllers/jobs_controller.rb

```
class JobsController < ApplicationController
  def show
    @job = Job.find(params[:id])
  end
end
```

新增 `show` 的 view

app/views/jobs/show.html.erb

```
<h1> <%= @job.title %> </h1>

<p>
  <%= simple_format(@job.description) %>

</p>
```

### Step 5 : 实作 jobs#index action

新增 `index` action

app/controllers/jobs_controller.rb

```
class JobsController < ApplicationController
+  def index
+    @jobs = Job.all
+  end
end
```

新增 `index` 的 view

app/views/jobs/index.html.erb

```
<table class="table table-boldered">
  <% @jobs.each do |job| %>
  <tr>
    <td>
      <%= link_to(job.title, job_path(job)) %>
    </td>
    <td>
      <%= job.created_at %>
    </td>
  </tr>
  <% end %>
</table>
```

### Step 6. 打开 rails console 新增两笔资料

```
rails c

Job.create!(:title => "Foo", :description => "Bar")
Job.create!(:title => "Bar", :description => "Foo")

exit
```

这时候你再打开 <http://localhost:3000/jobs>

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/MqHrPq6ASTiYHK2d2kRb_%E8%9E%A2%E5%B9%95%E5%BF%AB%E7%85%A7%202016-07-25%20%E4%B8%8B%E5%8D%885.57.01.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/MqHrPq6ASTiYHK2d2kRb_%E8%9E%A2%E5%B9%95%E5%BF%AB%E7%85%A7%202016-07-25%20%E4%B8%8B%E5%8D%885.57.01.png)

应该会看到这个画面

### Step 7. 将 root 改到 jobs#index

config/routes.rb

```
Rails.application.routes.draw do
  devise_for :users

   resources :jobs
   root 'jobs#index'
end
```

这样当你打开 [http://localhost:3000](http://localhost:3000/) 应该会直接看到职缺一览表

### Step 8 : 完成 jobs#new 与 jobs#create 的功能

app/controllers/jobs_controller.rb

```
 def new
    @job = Job.new
  end

  def create
    @job = Job.new(job_params)

    if @job.save
      redirect_to jobs_path
    else
      render :new
    end
  end

  private

  def job_params
    params.require(:job).permit(:title, :description)
  end
```

表单

app/views/jobs/new.html.erb

```
<h1> Add a job </h1>

<%= simple_form_for @job do |f| %>

<%= f.input :title %>
<%= f.input :description %>

  <%= f.submit "Submit" %>
<% end %>
```

然后修改 `app/views/jobs/index.html.erb` 在最上面，加入一段

app/views/jobs/index.html.erb

```
<div class="pull-right">
  <%= link_to("Add a job", new_job_path, :class => "btn btn-default" ) %>
</div>
```

这样上面就会显示一颗按钮

### Step 9: 完成 jobs#edit 与 jobs#update 的功能

app/controllers/jobs_controller.rb

```
 def edit
    @job = Job.find(params[:id])
  end

  def update
    @job = Job.find(params[:id])
    if @job.update(job_params)
      redirect_to jobs_path
    else
      render :edit
    end
  end

```

app/views/jobs/edit.html.erb

```
<h1> Edit a job </h1>

<%= simple_form_for @job do |f| %>

<%= f.input :title %>
<%= f.input :description %>

  <%= f.submit "Submit" %>
<% end %>
```

然后修改 `app/views/jobs/index.html.erb` 加入修改与删除的连接

app/views/jobs/index.html.erb

```
<table class="table table-boldered">
  <% @jobs.each do |job| %>
  <tr>

    <td>
      <%= link_to(job.title, job_path(job)) %>
    </td>
    <td>
      <%= link_to("Edit", edit_job_path(job)) %> |
      <%= link_to("Destroy", job_path(job), :method => :delete, :data => { :confirm => "Are you sure?" }) %>
    </td>
    <td>
      <%= job.created_at %>
    </td>
  </tr>
  <% end %>
</table>
```

成果就会长这样

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/7IRbzY4ZQH6HbIbZSKBk_%E8%9E%A2%E5%B9%95%E5%BF%AB%E7%85%A7%202016-07-25%20%E4%B8%8B%E5%8D%886.08.41.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/7IRbzY4ZQH6HbIbZSKBk_%E8%9E%A2%E5%B9%95%E5%BF%AB%E7%85%A7%202016-07-25%20%E4%B8%8B%E5%8D%886.08.41.png)

### Step 10: Jobs 必须要有标题

然后呢，我们为了要达到标题不得为空的效果，如这样：

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/b9yXCOEORoyTGIOrV70A_%E8%9E%A2%E5%B9%95%E5%BF%AB%E7%85%A7%202016-07-25%20%E4%B8%8B%E5%8D%886.11.02.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/b9yXCOEORoyTGIOrV70A_%E8%9E%A2%E5%B9%95%E5%BF%AB%E7%85%A7%202016-07-25%20%E4%B8%8B%E5%8D%886.11.02.png)

就必须得在 model 里面加上这样的限制：

app/models/job.rb

```
class Job < ApplicationRecord
  validates :title, presence: true
end
```

更多不同用法，可以看这份文件，做更多的变化限制：

<http://guides.rubyonrails.org/active_record_validations.html>

### Step 11: jobs#destroy

app/controllers/jobs_controller.rb

```
  def destroy
    @job = Job.find(params[:id])

    @job.destroy

    redirect_to jobs_path
  end
```

#### Step 12: 限制 new/create/update/edit/destroy 动作必须要进行登入

加入这行

app/controllers/jobs_controller.rb

```
 before_action :authenticate_user!, only: [:new, :create, :update, :edit, :destroy]
```

这样若存取 <http://localhost:3000/jobs/new> 就会被导到登入页。

#### Step 13: git 存档

```
git add .
git commit -m "implement job CRUD"
```

操作示范视频 - 招聘网站第一部分

# 6-2（解答）招聘网站第二部分

## 目标

- 实作 Admin 的 CRUD
- 身为管理者才可以存取 <http://localhost:3000/admin/jobs> 下的职缺操作
- 身为管理者才可以看到 Admin 管理选单的连结
- admin 的判定应该使用资料库的判断 `is_admin`

## 步骤

### Step 0:

`git checkout -b step2`

### Step 1: 产生 <http://localhost:3000/admin/jobs> 的网址

`rails g controller admin::jobs`

然后修改 routing

加入

config/routes.rb

```
  namespace :admin do
    resources :jobs
  end
```

### Step 2 : 实作 admin::jobs 的 CRUD

app/controllers/admin/jobs_controller.rb

```
class Admin::JobsController < ApplicationController
  before_action :authenticate_user!, only: [:new, :create, :update, :edit, :destroy]

  def show
    @job = Job.find(params[:id])
  end

  def index
    @jobs = Job.all
  end

  def new
    @job = Job.new
  end

  def create
    @job = Job.new(job_params)

    if @job.save
      redirect_to admin_jobs_path
    else
      render :new
    end
  end

  def edit
    @job = Job.find(params[:id])
  end

  def update
    @job = Job.find(params[:id])
    if @job.update(job_params)
      redirect_to admin_jobs_path
    else
      render :edit
    end
  end

  def destroy
    @job = Job.find(params[:id])

    @job.destroy

    redirect_to admin_jobs_path
  end

  private

  def job_params
    params.require(:job).permit(:title, :description)
  end
end
```

新增 `app/views/admin/jobs/index.html.erb`

app/views/admin/jobs/index.html.erb

```
<div class="pull-right">
  <%= link_to("Add a job", new_admin_job_path, :class => "btn btn-default" ) %>
</div>

<br><br>

<table class="table table-boldered">
  <% @jobs.each do |job| %>
  <tr>
    <td>
      <%= link_to(job.title, admin_job_path(job)) %>
    </td>
    <td>
      <%= link_to("Edit", edit_admin_job_path(job)) %>
      <%= link_to("Destroy", admin_job_path(job), :method => :delete, :data => { :confirm => "Are you sure?" }) %>
    </td>
    <td>
      <%= job.created_at %>
    </td>
  </tr>
  <% end %>
</table>
```

新增 `app/views/admin/jobs/new.html.erb`

app/views/admin/jobs/new.html.erb

```
<h1> Add a job </h1>

<%= simple_form_for [:admin,@job] do |f| %>

<%= f.input :title %>
<%= f.input :description %>

  <%= f.submit "Submit" %>
<% end %>
```

新增 `app/views/admin/jobs/show.html.erb`

app/views/admin/jobs/show.html.erb

```
<h1> <%= @job.title %> </h1>

<p>
  <%= simple_format(@job.description) %>

</p>
```

新增 `app/views/admin/jobs/edit.html.erb`

app/views/admin/jobs/edit.html.erb

```
<h1> Edit a job </h1>

<%= simple_form_for [:admin, @job ] do |f| %>

<%= f.input :title %>
<%= f.input :description %>

  <%= f.submit "Submit" %>
<% end %>
```

### Step 3: 把通往后台的选单加到下拉选单里：

这里我们想要试图把 admin 的下拉选单做出来

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/ZgGVbZSASeyDrZQrtOeY_%E8%9E%A2%E5%B9%95%E5%BF%AB%E7%85%A7%202016-07-25%20%E4%B8%8B%E5%8D%886.33.40.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/ZgGVbZSASeyDrZQrtOeY_%E8%9E%A2%E5%B9%95%E5%BF%AB%E7%85%A7%202016-07-25%20%E4%B8%8B%E5%8D%886.33.40.png)

可以这么做

app/views/common/_navbar.html.erb

```
<li> <%= link_to("Admin Panel", admin_jobs_path) %> </li>
<li> <%= link_to("登出", destroy_user_session_path, method: :delete) %> </li>
```

### Step 4: 限定只有 admin 才可以进后台

这时候我们要设计一个新的 method 叫 `require_is_admin`

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/7q8zpvPoTXaG7H0iPUWZ_%E8%9E%A2%E5%B9%95%E5%BF%AB%E7%85%A7%202016-07-25%20%E4%B8%8B%E5%8D%886.35.31.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/7q8zpvPoTXaG7H0iPUWZ_%E8%9E%A2%E5%B9%95%E5%BF%AB%E7%85%A7%202016-07-25%20%E4%B8%8B%E5%8D%886.35.31.png)

app/controllers/admin/jobs_controller.rb

```
class Admin::JobsController < ApplicationController
    before_action :authenticate_user!, only: [:new, :create, :update, :edit, :destroy]
    before_action :require_is_admin
```

然后呢，再加入一个 `require_is_admin` 的条件

这里我们姑且把条件叫做 email 是“管理员的 email”（你可以改成你自己的）

app/controllers/admin/jobs_controller.rb

```
 def require_is_admin
    if current_user.email != 'xdite@growth.school'
      flash[:alert] = 'You are not admin'
      redirect_to root_path
    end
  end
```

这样其他使用者，就不能进去 admin panel 了。

### Step 5: 重构 admin 条件，放到 model 里面

接着呢， `current_user.email != 'xdite@growth.school'` 这样不是很好看，我们应该要把条件改成 `if !current_user.admin?`

这样比较美观。

所以呢，你可以把刚刚的那一段改成：

app/controllers/admin/jobs_controller.rb

```
  def require_is_admin
    if !current_user.admin?
      flash[:alert] = 'You are not admin'
      redirect_to root_path
    end
  end
```

然后在 `app/models/user.rb` 加入一段 `admin?` 的自定义

app/models/user.rb

```
class User < ApplicationRecord
  # ....

  def admin?
    email == 'xdite@growth.school'
  end
```

这样就做了一次“整理的动作”。这样以后你就可以自己重新定义里面的条件。

### Step 6: 把 admin? 的条件改为由资料库判断

其实呢，admin 的这个条件，最好不要写死在代码中，比较好的方式，是记在数据库中。所以我们可以这样做：

`rails g migration add_is_admin_to_user`

然后修改 migration 档，变成

db/migrate/xxxxx.rb

```
class AddIsAdminToUser < ActiveRecord::Migration[5.0]
  def change
    add_column :users, :is_admin, :boolean, default: false
  end
end
```

再

`rake db:migrate`

接着我们再更改 `app/models/user.rb` 的 `admin?` 的定义，唯有 user 的 `is_admin` 这个栏位是 `true`时，这个人才会被判定为 `admin`

app/models/user.rb

```
 def admin?
    is_admin
  end
```

### Step 7: 把你的帐户提升为 admin

不过我们系统现在都是一般 user 阿，所以我们要把系统刚刚建的 user 提升为 admin。
打开

`rails console`

输入：

```
u = User.first
u.is_admin = true
u.save
exit
```

这样你的 user 就会变成 admin 了

### Step 8 限制只有 admin 才可以看到选单：

刚刚我们有做一个下拉选单嘛，应该要限制是 admin 才能看到下拉选单，那你现在就可以这样改了：

app/views/common/_navbar.html.erb

```
<% if current_user.admin? %>
<li> <%= link_to("Admin Panel", admin_jobs_path) %> </li>
<% end %>
<li> <%= link_to("登出", destroy_user_session_path, method: :delete) %> </li>
```

### Step 9: 把 require_is_admin 移到 application_controller

因为 `require_is_admin` 将来很多地方会用到，其实你是可以这样做的，把原本在 `admin/jobs_controller.rb`

app/controllers/admin/jobs_controller.rb

```
class Admin::JobsController < ApplicationController
  def require_is_admin
    if !current_user.admin?
      flash[:alert] = 'You are not admin'
      redirect_to root_path
    end
  end
end  
```

这段，搬到 `application_controller.rb`

app/controllers/application_controller.rb

```
class ApplicationController < ActionController::Base


  def require_is_admin
    if !current_user.admin?
      flash[:alert] = 'You are not admin'
      redirect_to root_path
    end
  end
end
```

这样之后就更多人可以调用这个 method

### Step 999: git 存档

```
git add .
git commit -m "implement part 2"
```

# 操作示范视频 - 招聘网站第二部分

# 6-3（解答）招聘网站第三部分

## 目标：

- 新增“薪资上限”“薪资下限”“联络 Email”
- 薪资不能为空，最低薪资至少要大于 0

## 步骤

### Step 0

`git checkout -b step3`

### Step 1 新增“薪资上限”“薪资下限”“联络 Email”

接下来我们要新增三个栏位：

- wage_upper_bound （数字）
- wage_lower_bound （数字）
- contact_email （字串）

`rails g migration add_more_detail_to_job`

修改 `db/migrate/XXX_add_more_detail_to_job.rb`

db/migrate/XXX_add_more_detail_to_job.rb

```
class AddMoreDetailToJob < ActiveRecord::Migration[5.0]
  def change
    add_column :jobs, :wage_upper_bound, :integer
    add_column :jobs, :wage_lower_bound, :integer
    add_column :jobs, :contact_email, :string
  end
end
```

然后

`rake db:migrate`

### Step 2: 然后我们要修改所有 new/edit 的表单加上这个栏位。要修改的地方有四块

- `app/views/admin/jobs/edit.html.erb`
- `app/views/admin/jobs/new.html.erb`
- `app/views/jobs/edit.html.erb`
- `app/views/jobs/new.html.erb`

新增以下栏位

```
<%= f.input :wage_lower_bound, :label => "薪资下限" %>
<%= f.input :wage_upper_bound, :label => "薪资上限" %>
<%= f.input :contact_email %>
```

成果应该会变成是这样

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/ktZOJlMsSfCp2mwmXnNG_%E8%9E%A2%E5%B9%95%E5%BF%AB%E7%85%A7%202016-07-25%20%E4%B8%8B%E5%8D%887.21.23.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/ktZOJlMsSfCp2mwmXnNG_%E8%9E%A2%E5%B9%95%E5%BF%AB%E7%85%A7%202016-07-25%20%E4%B8%8B%E5%8D%887.21.23.png)

### Step 3: 加上栏位白名单

既然新增了栏位，我们也要去改

- `app/controllers/admin/jobs_controller.rb`
- `app/controllers/jobs_controller.rb`

修改下面这一段，加入 `:wage_upper_bound, :wage_lower_bound, :contact_email`

```
def job_params
    params.require(:job).permit(:title, :description, :wage_upper_bound, :wage_lower_bound, :contact_email)
  end

```

### Step 4 : 薪资不能为空，最低薪资至少要大于 0

修改 app/models/job.rb

app/models/job.rb

```
 validates :wage_upper_bound, presence: true
  validates :wage_lower_bound, presence: true
  validates :wage_lower_bound, numericality: { greater_than: 0}
```

### Step 5: git 存档

```
git add .
git commit -m "implement wage part"
```

# 操作示范视频 - 招聘网站第三部分

# 6-4（解答）招聘网站第四部分

## 目标

- 首页应该看不到隐藏的工作
- 首页的工作应该按照建立时间倒叙排列
- 后台的 Job List 列表，应该显示哪一些工作是“隐藏”还是“公开”

## 步骤

### Step 0 :

`git checkout -b step4`

### Step 1: 新增 is_hidden 栏位到 job

`rails g migration add_is_hidden_to_job`

“预设为隐藏”

db/migrate/(一串数字)_add_is_hidden_to_job.rb

```
class AddIsHiddenToJob < ActiveRecord::Migration[5.0]
  def change
    add_column :jobs, :is_hidden, :boolean, default: true
  end
end
```

`rake db:migrate`

### Step 2: 然后我们要修改所有 new/edit 的表单加上这个栏位。要修改的地方有四块

- `app/views/admin/jobs/edit.html.erb`
- `app/views/admin/jobs/new.html.erb`
- `app/views/jobs/edit.html.erb`
- `app/views/jobs/new.html.erb`

新增以下栏位

`<%= f.input :is_hidden %>`

效果如以下：

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/FjkigSoMQqiPsjhe7XHW_%E8%9E%A2%E5%B9%95%E5%BF%AB%E7%85%A7%202016-07-25%20%E4%B8%8B%E5%8D%888.03.59.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/FjkigSoMQqiPsjhe7XHW_%E8%9E%A2%E5%B9%95%E5%BF%AB%E7%85%A7%202016-07-25%20%E4%B8%8B%E5%8D%888.03.59.png)

这样就能控制一则文章，是否隐藏。

### Step 3: 将 is_hidden 加入 job_params

修改

- `app/controllers/admin/jobs_controller.rb`
- `app/controllers/jobs_controller.rb`

修改下面这一段，加入 `:is_hidden`

```
 def job_params
    params.require(:job).permit(:title, :description, :wage_upper_bound, :wage_lower_bound, :contact_email,:is_hidden)
  end
```

### Step 4: 被隐藏的工作应该在首页看不到

修改 `app/controllers/jobs_controller.rb`

```
 def index
    @jobs = Job.all
  end
```

改成

```
 def index
    @jobs = Job.where(:is_hidden => false)
  end
```

这样就可以在首页“隐藏”已设为隐藏的工作

### Step 5 : 首页工作应该按照发表时间顺序

修改 `app/controllers/jobs_controller.rb`

```
 def index
    @jobs = Job.where(:is_hidden => false)
  end
```

变成

```
 def index
    @jobs = Job.where(:is_hidden => false).order("created_at DESC")
  end
```

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/JoBgJJ8TNuwN8udhS2Uw_%E8%9E%A2%E5%B9%95%E5%BF%AB%E7%85%A7%202016-07-25%20%E4%B8%8B%E5%8D%888.16.28.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/JoBgJJ8TNuwN8udhS2Uw_%E8%9E%A2%E5%B9%95%E5%BF%AB%E7%85%A7%202016-07-25%20%E4%B8%8B%E5%8D%888.16.28.png)

### Step 6: 让前后台的 Job List 长得不一样

修改

app/views/admin/jobs/index.html.erb

```
   <td>

  <% if job.is_hidden %>
         (Hidden)
      <% else %>
         (Public)
      <% end %>

      <%= link_to(job.title, admin_job_path(job)) %>
    </td>
```

成果会长这样：

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/6Cg17bzaRMG1viLfxPIK_%E8%9E%A2%E5%B9%95%E5%BF%AB%E7%85%A7%202016-07-25%20%E4%B8%8B%E5%8D%888.22.30.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/6Cg17bzaRMG1viLfxPIK_%E8%9E%A2%E5%B9%95%E5%BF%AB%E7%85%A7%202016-07-25%20%E4%B8%8B%E5%8D%888.22.30.png)

### Step 7: 翻修到 Helper

在 View 里面写一堆 Ruby Code 实在太丑了，因此我们应该要把这段程式码重构成 Helper 。

所以我们应该把刚刚那一段判断式砍掉，换成这样

app/views/admin/jobs/index.html.erb

```
<td>
  <%= render_job_status(job) %>

  <%= link_to(job.title, admin_job_path(job)) %>
</td>
```

然后加入这一段：

app/helpers/admin/jobs_helper.rb

```
module Admin::JobsHelper

  def render_job_status(job)
    if job.is_hidden
      "(Hidden)"
    else
      "(Public)"
    end
  end
end
```

### Step 8:

```
git add .
git commit -m "implement part4"
```

# 操作示范视频 - 招聘网站第四部分

# 7-1 本课程目标

本课程的目的，是透过一个小网站的开发，让大家知道程序员是怎么开发产品的。并且在这个过程中，教会大家 Rails 基础的 API 与工具。

涵盖的主题：

- Terminal / rails console / IRB
- Git 基本指令
- 开发设置
- 专案结构

这次的课程作业，其实是要让各位先「在不了解原理的情况下」「熟练」基本「操作流程」，目的是布建基础知识点。请`千万练习第三课三遍后`作业后，再服用这些补充知识。

# 7-2 Terminal

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/9T8X3T4aSECeGiGToDCJ_terminal.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/9T8X3T4aSECeGiGToDCJ_terminal.png)

Terminal 是使用者直接跟「Mac 内核」用「文字沟通」的介面。

以往平常作为一个一般用户，我们都是以图形化介面，指挥 Mac 应该要怎么做做事。而开发者，往往更直接高效的，使用文字指令可以复杂的与 Mac 用文字指令沟通更多事。

### cd ~/

- `cd` 切换到当前目录夹内
- `cd ~` 切到「家」目录

### ls -al

- `ls` 列出当前目录下所有档案
- `ls -al` 详细列出当前目录下所有档案的资讯

### pwd

- `pwd` 当前的目录位置

### rails s

- `rails s` 启动 Rails 服务器

### rails g

- `rails g` 产生 Rails 用的档案

# 7-3 rails console / IRB

## Rails Console

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/b9PKKcSFQ1yyNwHLQHsu_rails%20console.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/b9PKKcSFQ1yyNwHLQHsu_rails%20console.png)

- 在 Terminal 打 `rails c` 或 `rails console` 可以进入 (必须要在 rails 项目的资料夹才能启动进入)
- 是 Rails 的「文字后台」
- 可以对  Model 进行「查询」、「修改」...等等动作
- `exit` 可以退出
- 新手常常「忘记」自己在 Terminal 还是 Console

## IRB

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/9bcbzdkJRj2eZBK1MNd6_%E8%9E%A2%E5%B9%95%E5%BF%AB%E7%85%A7%202017-01-02%20%E4%B8%8B%E5%8D%887.04.27.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/9bcbzdkJRj2eZBK1MNd6_%E8%9E%A2%E5%B9%95%E5%BF%AB%E7%85%A7%202017-01-02%20%E4%B8%8B%E5%8D%887.04.27.png)

- 互动式 Ruby 介面
- 进入方式输入 `irb` （在任何目录都可以进入）
- 不装载 Rails 环境
- 只能测试验证 Ruby 语法
- 即时看到执行 Ruby 的结果
- `exit` 可以退出
- 可以玩玩 TryRuby <http://tryruby.org/levels/1/challenges/0>

## 本节作业

##### [第一周作业](https://fullstack.xinshengdaxue.com/assignments/6)：[试试TryRuby](https://fullstack.xinshengdaxue.com/tasks/74)

已有 249 个第一期同学提交了这个作业 [**看看同学怎么做](https://fullstack.xinshengdaxue.com/tasks/74/other_answers?order=recent)

[**提交作业](https://fullstack.xinshengdaxue.com/tasks/74)

照着这个教程操作
<http://tryruby.org/levels/1/challenges/0>
做到Level 4之后，将完成的画面截图放上来。
（完成画面会提示"CONGRATULATIONS!You've Completed Level 4!"）

提示：阅读画面左边的内容来操作，起始的指令是help
（只是简单的英文）

# 7-4 Git

- 程序员用来储存项目代码的「时光机」。

### 常见 Git 的指令

- `git init`  （把该目录变成一个被 git 掌握的目录）
- `git add README`   ( 把某个档案加入 git 的控制）
- `git add .` （把当前目录加入 git 的控制）
- `git commit -m “讯息”`  （把已经加入控制的档案，正式记录到这次变更）

### 进阶 Git 指令

- ```
  git remote add origin  git://github.com/xxx.git
  ```

  - 把远端的「原始来源」设为 github 端点

- ```
  git push origin master
  ```

  - 本地的主分支叫 master
  - 远端的端点叫 origin

- ```
  git push -u origin master
  ```

  - 以后预设都是推到 origin master，所以以后可以直接 git push

- ```
  git status
  ```

  - 「红色」、「绿色」

- ```
  git pull
  ```

  ​

  - 拉下远端变更

- ```
  git checkout -b ch01
  ```

  - 新增一个名为“ch01”的分支（branch）

- ```
  git checkout ch01
  ```

  - 切换到 “ch01” 分支

### Git 练习

- <https://try.github.io/levels/1/challenges/1>

### gitignore

- 可以设定哪一些档案不被 git 存取
- 比如说 config/database.yml

### 本节作业

##### [第一周作业](https://fullstack.xinshengdaxue.com/assignments/6)：[试试TryGit](https://fullstack.xinshengdaxue.com/tasks/75)

已有 250 个第一期同学提交了这个作业 [**看看同学怎么做](https://fullstack.xinshengdaxue.com/tasks/75/other_answers?order=recent)

[**提交作业](https://fullstack.xinshengdaxue.com/tasks/75)

照着这个教程操作
<https://try.github.io/levels/1/challenges/1>

照步骤完成后，将Congratulations!的完成页面截图提交到此。

提示：输入蓝字命令，观察下方视窗的结果

# 7-5 Github / Heroku

### Github

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/tzFkHjRS6nFdiBFsIMRw_Github.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/tzFkHjRS6nFdiBFsIMRw_Github.png)

- [http://github.com](http://github.com/)
- 程序原始码的「网络仓库」
- 网络套件大本营

### Heroku

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/Hi3OyfFuTFPfPNpN3XRQ_Heroku.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/Hi3OyfFuTFPfPNpN3XRQ_Heroku.png)

- 网站部署空间
- 利用 git 上传部署
- git push heroku master

# 7-6 Rails 项目架构扫盲

### 先从改了不用重开 server 的地方开始

#### 自己的程式码逻辑

- app/controllers
- app/views
- app/models
- app/assets/stylesheets
- app/assets/javascripts
- db/migrate/

### 其他地方改了都要重开

#### Routing (网址由这边控制)

- config/routes.rb
- `rake routes` 可以看所有路径

#### Gemfile ( 套件都放在这里 )

- 改完一定要 bundle install
- 然后重开 server
- server 会检查 Gemfile.lock 有没有完成相依性检查

# 7-7 哪里有好用的 Gems

- [http://ruby-toolbox.com](http://ruby-toolbox.com/)

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/V5La8G41QXuoPVB6oU7N_ruby-toolbox.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/V5La8G41QXuoPVB6oU7N_ruby-toolbox.png)

- [http://railscasts.com](http://railscasts.com/)

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/mhBu6pfYS8GVglTgUM0P_railscast.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/mhBu6pfYS8GVglTgUM0P_railscast.png)

# 7-7 哪里有好用的 Gems

- [http://ruby-toolbox.com](http://ruby-toolbox.com/)

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/V5La8G41QXuoPVB6oU7N_ruby-toolbox.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/V5La8G41QXuoPVB6oU7N_ruby-toolbox.png)

- [http://railscasts.com](http://railscasts.com/)

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/mhBu6pfYS8GVglTgUM0P_railscast.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/mhBu6pfYS8GVglTgUM0P_railscast.png)

# 7-8 HTML/ERB

### HTML Tag

```
<h1> <h2> <h3>
<p> <strong>
<div> <span>
<form>
<table>
<input> <button>
```

关于这些HTML标签，下面有一份作业给大家。

### ERB

在 HTML 中嵌入 RUBY 语法的 ERB ( Embedded Ruby )。

```
<%= @post.title %>  # 显示 @post.title
<% @post.title %>   # 执行 @post.title
```

#### 实际的例子：

```
<% sum = 0 %>
<% for i in 1..10 %>
    <% sum = sum + i %>
<% end %>
<%= sum %>
```

以上的代码表示：执行1+2+3+4+5+6+7+8+9+10的运算后，印出55

### 本节作业

##### [第一周作业](https://fullstack.xinshengdaxue.com/assignments/6)：[HTML 自学作业](https://fullstack.xinshengdaxue.com/tasks/34)

已有 188 个第一期同学提交了这个作业 [**看看同学怎么做](https://fullstack.xinshengdaxue.com/tasks/34/other_answers?order=recent)

[**提交作业](https://fullstack.xinshengdaxue.com/tasks/34)

请阅读并练习以下教材：
* [HTML 基础 ](http://www.w3school.com.cn/html/html_basic.asp)
* [HTML 元素](http://www.w3school.com.cn/html/html_elements.asp)
* [HTML 属性](http://www.w3school.com.cn/html/html_attributes.asp)
* [HTML 标题](http://www.w3school.com.cn/html/html_headings.asp)
* [HTML 段落 ](http://www.w3school.com.cn/html/html_paragraphs.asp)
* [HTML 表格](http://www.w3school.com.cn/html/html_tables.asp)
* [HTML 列表](http://www.w3school.com.cn/html/html_lists.asp)
* [HTML 块](http://www.w3school.com.cn/html/html_blocks.asp)
  撰写一篇部落格解释：
  \* div / span 的不同
  \* class 与 id 的不同
  \* p 与 br 的不同
  \* 如何使用 table 排版
  请在这里贴上你的文章网址

##### [第一周作业](https://fullstack.xinshengdaxue.com/assignments/6)：[CSS 自学作业](https://fullstack.xinshengdaxue.com/tasks/35)

已有 175 个第一期同学提交了这个作业 [**看看同学怎么做](https://fullstack.xinshengdaxue.com/tasks/35/other_answers?order=recent)

[**提交作业](https://fullstack.xinshengdaxue.com/tasks/35)

- [CSS 基础语法](http://www.w3school.com.cn/css/css_syntax.asp)
- [CSS id 选择器](http://www.w3school.com.cn/css/css_syntax_id_selector.asp)
- [CSS 类选择器](http://www.w3school.com.cn/css/css_syntax_class_selector.asp)
- [CSS 背景](http://www.w3school.com.cn/css/css_background.asp)
- [CSS 框模型概述](http://www.w3school.com.cn/css/css_boxmodel.asp)
- [CSS 内边距](http://www.w3school.com.cn/css/css_padding.asp)
- [CSS 边框](http://www.w3school.com.cn/css/css_border.asp)
- [CSS 外边距](http://www.w3school.com.cn/css/css_margin.asp)
- [CSS 字体](http://www.w3school.com.cn/css/css_font.asp)
- [CSS 文本](http://www.w3school.com.cn/css/css_text.asp)
- [CSS 链接](http://www.w3school.com.cn/css/css_link.asp)

撰写一篇文章解释：

- margin 与 padding 的差异；
- 什么是 box model；
- 为何要使用 em 而非 px 来定义字的大小；
- h1 {margin : 10px 0px 15px 5px;} 的
- margin-top、
- margin-right、
- margin-left、
- margin-bottom 各是多少？

把文章连结贴在这里。

# [直播回放]1月5日 基础知识补充

# 8-1 加分习题

## 加分习题

- 把 admin#jobs ( admin 用）与 jobs （使用者用）做个区分
  - 加上 sidebar 设计
- 在 admin 后台的职缺状态，改成图示
  - 把 render_job_status 改成 “图示”Font Awesome 图示。（使用 fa-lock / fa-globe ）
- 把 is_hidden 的操作改成按钮
- jobs#show 在隐藏状态不可以用

### Step 5-1

- 把 admin#jobs做个区分
- 要有sidebar, 这样就容易知道自己哪里[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/uAffuvHETliXRaRBnYKM_s5-1-1.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/uAffuvHETliXRaRBnYKM_s5-1-1.png)

#### 利用layout可以做出不同的view

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/6f2D9Vc8SGay83rGnRsq_p52.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/6f2D9Vc8SGay83rGnRsq_p52.png)

使用者看的

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/H1k1J25FQIy3kOPvATda_s5-1-1-2.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/H1k1J25FQIy3kOPvATda_s5-1-1-2.png)

Admin看的

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/35zjvnh6Rd64T4swRhsw_p532.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/35zjvnh6Rd64T4swRhsw_p532.png)

### Step 5-2

- 把public/hide改成图示[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/M4SzyB35Q0qH7u7vS8Rd_s3-done.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/M4SzyB35Q0qH7u7vS8Rd_s3-done.png)

#### 提示

- Fontawsome <http://fontawesome.io/icons>

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/h25ZzmdmSmSTR9Z86oow_p551.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/h25ZzmdmSmSTR9Z86oow_p551.png)

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/OrGRIXzQeoqZig9qWAPF_p552.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/OrGRIXzQeoqZig9qWAPF_p552.png)

### Step 5-3

- 把publish/hide改成按钮

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/L2KtkNE9SNW4vFFR42Co_p556.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/L2KtkNE9SNW4vFFR42Co_p556.png)

#### 提示

config/routes.rb

```
member do
    post :publish
  post :hide
end
```

# 8-2 （解答）招聘网站第五部分

### 目标

- 加入 sidebar
- 限制已隐藏职缺不能存取
- 将“职缺”状态换成图示
- 设计能“隐藏”“重新显示”的按钮

### 步骤

#### Step 0

git checkout -b step5

#### Step 1 加入 admin layouts

`touch app/views/layouts/admin.html.erb`

app/views/layouts/admin.html.erb

```
<!DOCTYPE html>
<html>
    <head>
        <title>Job Listing </title>
        <%= csrf_meta_tags %>

        <%= stylesheet_link_tag    'application', media: 'all', 'data-turbolinks-track': 'reload' %>
        <%= javascript_include_tag 'application', 'data-turbolinks-track': 'reload' %>
    </head>

    <body>

        <div class="container-fluid">
            <%= render "common/navbar" %>
            <%= render "common/flashes" %>
            <div class="row">
              <div class="col-md-2">
                sidebar
              </div>

              <div class="col-md-10">
                <%= yield %>
              </div>
           </div>
        </div>

        <%= render "common/footer" %>

    </body>
</html>
```

然后在 `app/controllers/admin/jobs_controller.rb` 加入一行 `layout "admin”`

app/controllers/admin/jobs_controller.rb

```
class Admin::JobsController < ApplicationController
  before_action :authenticate_user!, only: [:new, :create, :update, :edit, :destroy]
  before_action :require_is_admin
  layout "admin"
```

就可以看到新的 layout 被套用了。

#### Step 2 加入 正确的 sidebar

接着我们要修改 app/views/layout/admin.html.erb

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/SuTrIh4QF6a9RWsFXTRQ_s2-1.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/SuTrIh4QF6a9RWsFXTRQ_s2-1.png)

```
  <ul class="nav nav-pills nav-stacked" style="max-width: 300px; padding-top:20px;">
      <li class="active"><%= link_to("Jobs", admin_jobs_path ) %> </li>

   </ul>
```

成果就会变成这样：

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/MhYyKOtfQOWdfWnaKvxP_s2-2.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/MhYyKOtfQOWdfWnaKvxP_s2-2.png)

#### Step 3: 把 Public / Hidden 换成图示（用 FontAwesome）

原先的 ( Public / Hidden ) 实在太丑了：

我们应该要换成图示，像这样：

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/X70a7YpXTD2wUdnwtdlX_s3-done.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/X70a7YpXTD2wUdnwtdlX_s3-done.png)

那么要怎么做呢？
有一个厉害的网站叫做 FontAwesome，提供各式各样厉害的图示：<http://fontawesome.io/icons/>

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/yce0qsIXTaaLQwt5Pgc0_%E8%9E%A2%E5%B9%95%E5%BF%AB%E7%85%A7%202016-07-26%20%E4%B8%8B%E5%8D%8810.16.41.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/yce0qsIXTaaLQwt5Pgc0_%E8%9E%A2%E5%B9%95%E5%BF%AB%E7%85%A7%202016-07-26%20%E4%B8%8B%E5%8D%8810.16.41.png)

如何安装 FontAwesome？修改 Gemfile 挂上

`gem 'font-awesome-rails'`

然后执行
`bundle install`

接着修改 `app/assets/stylesheets/application.scss`
加入：

app/assets/stylesheets/application.scss

`*= require font-awesome`

也加入：

app/assets/stylesheets/application.scss

`@import "font-awesome";`

然后重开 `rails server`

接着我们要换掉 Helper，修改 `app/helpers/admin/jobs_helper.rb` 当中的 `render_job_status(job)`

app/helpers/admin/jobs_helper.rb

```
 def render_job_status(job)
    if job.is_hidden
      content_tag(:span, "", :class => "fa fa-lock")
    else
      content_tag(:span, "", :class => "fa fa-globe")
    end
  end
```

这样你的后台列表就会变成：

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/nqoA9vjrQf2FBUmVFu7m_s3-done.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/nqoA9vjrQf2FBUmVFu7m_s3-done.png)

#### Step 4: 实作“被隐藏的工作”，不可以被查看到。

把 `app/controllers/jobs_controller.rb 当中的 show action`
改成

app/controllers/jobs_controller.rb

```
 def show
    @job = Job.find(params[:id])

    if @job.is_hidden
      flash[:warning] = "This Job already archieved"
      redirect_to root_path
    end
  end
```

使用普通用户登录，在浏览器地址栏输入

`http://localhost:3000/jobs/x （x是被隐藏的工作的ID编号）`

成果就会是这样：

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/nopV1XuLSq6IzQidLMpL_s4-done.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/nopV1XuLSq6IzQidLMpL_s4-done.png)

#### Step 5 : 设计按钮，将“隐藏职缺”改成是一个按钮，按下去“隐藏职缺”，再按一次“显示职缺”

如同这样：

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/6pAUGJMMST6I9CfxrSIz_s5-1.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/6pAUGJMMST6I9CfxrSIz_s5-1.png)

首先呢，修改 `app/views/admin/jobs/index.html.erb`
加上一个判断式，显示 Publish / Hide 的按钮

app/views/admin/jobs/index.html.erb

```
<td>
  <%= link_to("Edit", edit_admin_job_path(job)) %>
  <%= link_to("Destroy", admin_job_path(job), :method => :delete, :data => { :confirm => "Are you sure?" }) %>


  <% if job.is_hidden %>

    <%= link_to("Publish", "#", :class => "btn btn-xs btn-default") %>
  <% else %>
    <%= link_to("Hide", "#", :class => "btn btn-xs btn-default") %>
  <% end %>
</td>
```

接着呢？
再把 `#` 改成“正确的路径”

app/views/admin/jobs/index.html.erb

```
 <% if job.is_hidden %>

    <%= link_to("Publish", publish_admin_job_path(job) , :method => :post, :class => "btn btn-xs btn-default") %>
  <% else %>
    <%= link_to("Hide", hide_admin_job_path(job), :method => :post,  :class => "btn btn-xs btn-default") %>
  <% end %>
```

也改 routing 加上去 publish 与 hide

config/routes.rb

```
  namespace :admin do
    resources :jobs do
      member do
        post :publish
        post :hide
      end
    end
  end
```

此时别高兴呢！若你按下去 publish 的按钮，他铁定跟你说 publish action 还没设计：

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/ADtglDXYTeG0oQaMbRvW_s5-done.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/ADtglDXYTeG0oQaMbRvW_s5-done.png)

#### Step 6 : 设计 publish / hide 的 action

所以你还得在 `app/controllers/admin/jobs_controller.rb` 加入：

app/controllers/admin/jobs_controller.rb

```
 def publish
    @job = Job.find(params[:id])
    @job.is_hidden = false
    @job.save
    redirect_to :back
  end

  def hide
    @job = Job.find(params[:id])
    @job.is_hidden = true
    @job.save
    redirect_to :back
  end
```

#### Step 7 : 重构到 model

但我们觉得这样写

app/controllers/admin/jobs_controller.rb

```
 def publish
    @job = Job.find(params[:id])
    @job.is_hidden = false
    @job.save
    redirect_to :back
  end
```

太土炮了！

要是我们这样写：

app/controllers/admin/jobs_controller.rb

```
 def publish
    @job = Job.find(params[:id])
    @job.publish!
    redirect_to :back
  end
```

看起来才牛逼啊！

如何做呢？首先到 `app/models/job.rb` 实作 `publish!` 与 `hide!`

app/models/job.rb

```
class Job < ApplicationRecord
  def publish!
    self.is_hidden = false
    self.save
  end

  def hide!
    self.is_hidden = true
    self.save
  end
end  
```

再去把 `app/controllers/admin/jobs_controller.rb` 中的两个 action 换掉：

app/controllers/admin/jobs_controller.rb

```
  def publish
    @job = Job.find(params[:id])
    @job.publish!

    redirect_to :back
  end

  def hide
    @job = Job.find(params[:id])

    @job.hide!

    redirect_to :back
  end
```

#### Step 8 : git 储存

```
git add .
git commit -m "implement step 5"
```

# 操作示范视频 - 招聘网站第五部分

# [直播回放]1月9日 Xdite老师的编程进阶之路

# 9-1 应聘者用户故事 Part 1

请各位继续拿出

- 一本全白的笔记本
- 一支蓝笔
- 一支绿笔

跟着做。

（ 请千万不要跳过这个步骤。我们需要各位真的也照着写下来，才会记住这个方法）

把第一版用户故事写下来。

（请跟着照抄，如图所示）

### 应聘者用户故事

在第二周，我们会让同学们实作“应征者”这个角色。

应征者需要做什么呢？

### 本节作业

##### [第二周作业](https://fullstack.xinshengdaxue.com/assignments/7)：[第二周日记&周记](https://fullstack.xinshengdaxue.com/tasks/79)

已有 181 个第一期同学提交了这个作业 [**看看同学怎么做](https://fullstack.xinshengdaxue.com/tasks/79/other_answers?order=recent)

[**提交作业](https://fullstack.xinshengdaxue.com/tasks/79)

1.请使用[ORID格式](https://fullstack.xinshengdaxue.com/tasks/7)记录每天的学习日记
2.请根据你本周的学习情况写一篇总结周记，内容提到以下两点：1.“本周学到的最棒概念/工具” 2.“本周遇到最大的坑”
然后把日记和周记的博客连接贴在这里，格式如下：
（注意：你的logdown连结应该会是这样 <http://yy4ever.logdown.com/posts/1143304> 而不会有edit的链接）

1/9 日记：（你的博客链接）
1/10 日记：（你的博客链接）
1/11 日记：（你的博客链接）
1/12 日记：（你的博客链接）
1/13 周记：（你的博客链接）

# 9-2 应聘者用户故事 Part 2

接着，我们来拆分第一条用户故事：应征者，可以“过滤”理想工作。

那么到底要如何“过滤”呢？

通常应征者会在意的是：

- 薪资的下限
- 薪资的上限
- 职缺的刊登时间

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/hcd0HjC2TImeDqaLWNyI_Image%20Upload%20on%202017-01-05%20at%2012-05-16.jpg)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/hcd0HjC2TImeDqaLWNyI_Image%20Upload%20on%202017-01-05%20at%2012-05-16.jpg)

# 9-3 应聘者用户故事Part 3

第二条用户故事：应征者，可以「上传」简历。这部分我们可以怎么拆呢？

- 上传简历的网址应该长成这样：/jobs/1/resumes/new
- 用户必须要登入才能提交履历
- 履历的格式是 PDF，使用 Job 这个 model 的 attachment 栏位
- 上传空履历必须要被滤掉

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/KA4wpwsRaEzMBRUJ6WCQ_Image%20Upload%20on%202017-01-05%20at%2018-12-26.jpg)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/KA4wpwsRaEzMBRUJ6WCQ_Image%20Upload%20on%202017-01-05%20at%2018-12-26.jpg)

### 本节作业

##### [第二周作业](https://fullstack.xinshengdaxue.com/assignments/7)：[第二周应聘者用户故事](https://fullstack.xinshengdaxue.com/tasks/78)

已有 221 个第一期同学提交了这个作业 [**看看同学怎么做](https://fullstack.xinshengdaxue.com/tasks/78/other_answers?order=recent)

[**提交作业](https://fullstack.xinshengdaxue.com/tasks/78)

将你的应聘者用户故事手写在笔记本上，并拍照上传。

# 10-1 实作章节 - 应聘者 - 学习方法

在这里我们分成两套学习方法，提供同学使用：

### 还未牛逼的同学

还是觉得一头懵的同学，请你直接看解答。

- 第一遍用贴的
- 第二遍用打的
- 第三遍自己写出来

### 牛逼的同学

课前已经觉得中级练习很简单的牛逼同学，请你直接按照提示，看着中级练习实作出来。

# 10-2 实作章节 - 应聘者 - 提示 Part 1

其实到这里。我们就把步骤拆的也与「中级练习」非常的相似：

- 首页要可以按照职缺薪资下限排序
- 首页要可以按照职缺薪资上限排序
- 首页要可以按照职缺发表时间排序
- 应征者可以提交自己的职缺   - 上传简历的网址应该长成这样：/jobs/1/resumes/new   - 用户必须要登入才能提交履历   - 履历的格式是 PDF，使用 Job 这个 model 的 attachment 栏位   - 上传空履历必须要被滤掉

# 10-3 实作章节 - 应聘者 - 提示 Part 2

- 首页要可以按照职缺薪资下限排序
- 首页要可以按照职缺薪资上限排序
- 首页要可以按照职缺发表时间排序

步骤是这样的：

### Step 1 :

- 制作 Bootstrap 的下拉选单

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/kgYBvisBT1mFo78LpxGK_9-1.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/kgYBvisBT1mFo78LpxGK_9-1.png)

### Step 2 :

- 设定下拉选单的过滤器网址
- 原理是在网址里面带参数
- jobs_path(:order => "by_upper_bound")
- 可以生成 /jobs?order=by_lower_bound 这样的网址

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/pCxUWa03QzCj1Vf63snk_9-2.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/pCxUWa03QzCj1Vf63snk_9-2.png)

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/roxdo8ncQqiGrZDX1Ott_9-3.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/roxdo8ncQqiGrZDX1Ott_9-3.png)

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/lOtRXWblSMmggeyOe8gb_9-4.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/lOtRXWblSMmggeyOe8gb_9-4.png)

### Step 3:

- 使用者点击后，在 rails s 的日志里面会看到传进一个参数。
- 然后我们可以选择在 controller 根据传进来的 params[:order] 参数决定去查询哪些资料

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/eIsQazzzSfq9s8OS1kPA_9-5.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/eIsQazzzSfq9s8OS1kPA_9-5.png)

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/iVMRyuQQmtDqCaLeaW9Q_9-6.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/iVMRyuQQmtDqCaLeaW9Q_9-6.png)

### 本节作业

##### [第二周作业](https://fullstack.xinshengdaxue.com/assignments/7)：[Step 6: 过滤心仪工作](https://fullstack.xinshengdaxue.com/tasks/41)

已有 205 个第一期同学提交了这个作业 [**看看同学怎么做](https://fullstack.xinshengdaxue.com/tasks/41/other_answers?order=recent)

[**提交作业](https://fullstack.xinshengdaxue.com/tasks/41)

\* 首页要可以按照职缺薪资下限排序
\* 首页要可以按照职缺薪资上限排序
\* 首页要可以按照职缺发表时间排序
上传gif动画演示你的成果（拖曳到此处）

# 10-4 实作章节 - 应聘者 - 提示 Part 3

- 应征者可以提交自己的职缺
- 上传简历的网址应该长成这样：/jobs/1/resumes/new
- 用户必须要登入才能提交履历
- 履历的格式是 PDF，使用 resume 这个 model 的 attachment 栏位
- 上传空履历必须要被滤掉

### 上传简历的网址

- /jobs/1/resumes/new
- 提示：可以参考第三课练习

### 用户必须要登入才能提交履历

- devise
- 提示：可以参考第三课练习

### 上传空履历必须要被滤掉

- validation :attachment, presence: true

### 上传履历

- Google 关键字：carrierwave pdf
- carrierwave （上传档案的 gem）
- 在 resume 这个 model 实作 attachment uploader

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/3ZHgXiYnTuK9JTyAUhux_p10.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/3ZHgXiYnTuK9JTyAUhux_p10.png)

### 本节作业

##### [第二周作业](https://fullstack.xinshengdaxue.com/assignments/7)：[Step 7: 应征者可以上传简历](https://fullstack.xinshengdaxue.com/tasks/42)

已有 206 个第一期同学提交了这个作业 [**看看同学怎么做](https://fullstack.xinshengdaxue.com/tasks/42/other_answers?order=recent)

[**提交作业](https://fullstack.xinshengdaxue.com/tasks/42)

\* 送出的履历网址是：/jobs/1/resumes/new
\* 履历内容不能为空
\* 使用者得登入才能提交履历
\* 履历可以上传 PDF，使用 attachment 栏位 （使用 Carrierwave）
上传gif动画演示你的成果（拖曳到此处）

# 11-1（解答）招聘网站第六部分

## 目标：

- 首页要可以按照职缺薪资下限排序
- 首页要可以按照职缺薪资上限排序
- 首页要可以按照职缺发表时间排序
- 把 `Job.where(:is_hidden => false").order("created_at DESC")` 翻修成 `Job.published.recent`

## 步骤

### Step 0

`git checkout -b step6`

### Step 1: 先将薪资上限、薪资下限，也加入首页职缺列表

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/M3i1fLVJRNKgIIzEkes8_%E8%9E%A2%E5%B9%95%E5%BF%AB%E7%85%A7%202016-07-30%20%E4%B8%8A%E5%8D%881.21.59.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/M3i1fLVJRNKgIIzEkes8_%E8%9E%A2%E5%B9%95%E5%BF%AB%E7%85%A7%202016-07-30%20%E4%B8%8A%E5%8D%881.21.59.png)

修改 `app/views/jobs/index.html.erb` 的 `<table>`

app/views/jobs/index.html.erb

```
<table class="table table-boldered">
    <thead>
        <tr>
            <td>
                职缺</td>
            <td>薪资下限</td>
            <td>薪资上限</td>
            <td>刊登时间</td>
        </tr>

    </thead>
    <tbody>
        <% @jobs.each do |job| %>
        <tr>
            <td>
                <%= link_to(job.title, job_path(job)) %>
            </td>
            <td>
                <%= job.wage_lower_bound %>
            </td>
            <td>
                <%= job.wage_upper_bound %>
            </td>
            <td>
                <%= job.created_at %>
            </td>
        </tr>
        <% end %>
    </tbody>

</table>
```

### Step 2: 加上下拉选单

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/En1QxpIUTtuQ6xjj4jRZ_%E8%9E%A2%E5%B9%95%E5%BF%AB%E7%85%A7%202016-07-30%20%E4%B8%8A%E5%8D%881.31.15.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/En1QxpIUTtuQ6xjj4jRZ_%E8%9E%A2%E5%B9%95%E5%BF%AB%E7%85%A7%202016-07-30%20%E4%B8%8A%E5%8D%881.31.15.png)

修改 `app/views/jobs/index.html.erb` ，在 `<table>` 之前加入“下拉选单”

```
<div class="dropdown clearfix pull-right">
    <button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenuDivider" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
      排序
        <span class="caret"></span>
    </button>
    <ul class="dropdown-menu" aria-labelledby="dropdownMenuDivider">
        <li>
          <%= link_to("按照薪资下限排序", jobs_path(:order => "by_lower_bound")) %>
        </li>
        <li>
            <%= link_to("按照薪资上限排序", jobs_path(:order => "by_upper_bound")) %>

        </li>
        <li>
          <%= link_to("按照发表时间排序", jobs_path ) %>

        </li>
    </ul>
</div>
```

如此一来呢，打开 Google Chrome，右键检视 Dropdown 的 HTML，会生出

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/2v4znZQpKoy5o74DHlrw_%E8%9E%A2%E5%B9%95%E5%BF%AB%E7%85%A7%202016-07-30%20%E4%B8%8A%E5%8D%883.03.53.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/2v4znZQpKoy5o74DHlrw_%E8%9E%A2%E5%B9%95%E5%BF%AB%E7%85%A7%202016-07-30%20%E4%B8%8A%E5%8D%883.03.53.png)

### Step 3: 在 JobsController 里面制造判断式，决定要送出何种资料

当如果你按了“按照薪资下限排序后”，回去看 rails 的 log，可以看到

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/M9PrsGpETV229Qohm0fC_%E8%9E%A2%E5%B9%95%E5%BF%AB%E7%85%A7%202016-07-30%20%E4%B8%8A%E5%8D%883.05.13.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/M9PrsGpETV229Qohm0fC_%E8%9E%A2%E5%B9%95%E5%BF%AB%E7%85%A7%202016-07-30%20%E4%B8%8A%E5%8D%883.05.13.png)

所以呢，接着你可以把 JobsController 的 `index` 改成这样：

app/controllers/jobs_controller.rb

```
 def index
    @jobs = case params[:order]
            when 'by_lower_bound'
              Job.where(is_hidden: false).order('wage_lower_bound DESC')
            when 'by_upper_bound'
              Job.where(is_hidden: false).order('wage_upper_bound DESC')
            else
              Job.where(is_hidden: false).order('created_at DESC')
            end
  end
```

由 `params[:order]` 去决定，吐什么资料出来。

### Step 4: 重构重复的程式码，建立 `published` scope

我们发现 `where(is_hidden: false)` 这一段一直重复，有点厌烦。因此我们可以去 Job 这个 model 里面新增一个 scope：

app/models/job.rb

```
class Job < ApplicationRecord
  scope :published, -> { where(is_hidden: false) }
end
```

然后再修改 `app/controllers/jobs_controller.rb`，把 `where(is_hidden: false)` 都改成 `published`

app/controllers/jobs_controller.rb

```
 def index
    @jobs = case params[:order]
            when 'by_lower_bound'
              Job.published.order('wage_lower_bound DESC')
            when 'by_upper_bound'
              Job.published.order('wage_upper_bound DESC')
            else
              Job.published.order('created_at DESC')
            end
  end
```

### Step 5: 建立 `recent` scope

我们发现 `order('created_at DESC')` 这段其实也挺常用到的，应该也是可以帮忙设计一个专属 scope，就叫 `recent` 好了。

app/models/job.rb

```
class Job < ApplicationRecord
  scope :recent, -> { order('created_at DESC') }
end
```

然后再修改 `app/controllers/jobs_controller.rb`

app/controllers/jobs_controller.rb

```
 def index
    @jobs = case params[:order]
            when 'by_lower_bound'
              Job.published.order('wage_lower_bound DESC')
            when 'by_upper_bound'
              Job.published.order('wage_upper_bound DESC')
            else
              Job.published.recent
            end
  end
```

这样 `Job.published.recent` 看起来就直观太多了！

### Step 999 :

```
git add .
git commit -m "step 6 order by wage"
```

# 操作示范视频 - 招聘网站第六部分

# 11-2（解答）招聘网站第七部分

## 目标：

- 送出的履历网址是：/jobs/1/resumes/new
- 履历内容不能为空
- 使用者得登入才能提交履历
- 履历可以上传 PDF，使用 attachment 栏位

## 步骤

### Step 0:

`git checkout -b step7`

### Step 1: 建立投递履历的连结

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/ePS1x2ScQIWXVSCiWbvD_%E8%9E%A2%E5%B9%95%E5%BF%AB%E7%85%A7%202016-07-30%20%E4%B8%8A%E5%8D%883.15.24.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/ePS1x2ScQIWXVSCiWbvD_%E8%9E%A2%E5%B9%95%E5%BF%AB%E7%85%A7%202016-07-30%20%E4%B8%8A%E5%8D%883.15.24.png)

首先呢，我们要在职缺下面建立一个投递履历的连结，在 `app/views/jobs/show.html.erb` 加入一段连结：

app/views/jobs/show.html.erb

```
<div class="text-center">
  <%= link_to("投交履历", "#", :style => "font-size: 30px; text-decoration:underline;") %>
</div>
```

### Step 2: 产生履历 Resume 的 model

履历 Resume Model 初步的构想是，应该要跟 Job 有关，也要跟 User 有关，至少还要一个 content 栏位。所以我们可以根据这样的规划产生 model

- job_id:integer
- user_id:integer
- content:text

`rails g model resume job_id:integer user_id:integer content:text`

然后再跑

`rake db:migrate`

### Step 3: 将 Resume 与 User / Job 挂起来

app/models/resume.rb

```
class Resume < ApplicationRecord
  belongs_to :user
  belongs_to :job
end
```

app/models/job.rb

```
class Job < ApplicationRecord
  has_many :resumes
end
```

app/models/user.rb

```
class User < ApplicationRecord
  has_many :resumes
end
```

### Step 4: 建立履历表单

初步想法：

- 送出的履历网址是：/jobs/1/resumes/new
- 至少履历内容不能为空
- 使用者得登入才能提交履历

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/BkaQrmHS3K46gA4F99WW_%E8%9E%A2%E5%B9%95%E5%BF%AB%E7%85%A7%202016-07-30%20%E4%B8%8A%E5%8D%883.22.52.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/BkaQrmHS3K46gA4F99WW_%E8%9E%A2%E5%B9%95%E5%BF%AB%E7%85%A7%202016-07-30%20%E4%B8%8A%E5%8D%883.22.52.png)

产生 resumes_controller

`rails g controller resumes`

修改 `config/routes.rb`

config/routes.rb

```
Rails.application.routes.draw do
  devise_for :users

  namespace :admin do
    resources :jobs do
      member do
        post :publish
        post :hide
      end
    end
  end

-  resources :jobs
+  resources :jobs do
+    resources :resumes
+  end

  root 'jobs#index'
end
```

然后修改送出履历网址为 `new_job_resume_path(@job)`

app/views/jobs/show.html.erb

```
<div class="text-center">
  <%= link_to("投交履历", new_job_resume_path(@job), :style => "font-size: 30px; text-decoration:underline;") %>
</div>
```

新增 `resumes_controller` 里的内容

app/controllers/resumes_controller.rb

```
 class ResumesController < ApplicationController
  before_action :authenticate_user!

  def new
    @job = Job.find(params[:job_id])
    @resume = Resume.new
  end

  def create
    @job = Job.find(params[:job_id])
    @resume = Resume.new(resume_params)
    @resume.job = @job
    @resume.user = current_user

    if @resume.save
      flash[:notice] = "成功提交履历"
      redirect_to job_path(@job)
    else
      render :new
    end
  end

  private

  def resume_params
    params.require(:resume).permit(:content)
  end
end
```

新增 `app/views/resumes/new.html.erb`

app/views/resumes/new.html.erb

```
<h3> 投交履历到 <%= @job.title %> </h3>

<hr>

<%= simple_form_for [@job, @resume] do |f| %>
  <%= f.input :content %>
  <%= f.submit "送出" %>
<% end %>
```

履历内容不得为空

app/models/resume.rb

```
class Resume < ApplicationRecord
  belongs_to :user
  belongs_to :job

  validates :content, presence: true
end
```

### Step 5：加入履历上传功能 （安装 carrierwave）

这里我们会使用 [carrierwave](https://github.com/carrierwaveuploader/carrierwave) 这套 gem 实作档案上传功能。

安装 carrierwave

Gemfile`gem 'carrierwave'`

然后

`bundle install`

### Step 6 ：重开 rails server

装完 Gem 后，要重开 rails server

### Step 7 ：新增 attachment 栏位在 resume 这个栏位上

`rails g migration add_attachment_to_resume`

内容：

```
class AddAttachmentToResume < ActiveRecord::Migration[5.0]
  def change
    add_column :resumes, :attachment, :string
  end
end
```

然后 rake db:migrate

### Step 8：挂上 Attachment Uploader 到 Resume 上

carrierwave 使用的是“Uploader”这个机制，因此呢，我们要

`rails g uploader attachment`

然后再修改 model，挂上去

app/models/resume.rb

```
class Resume < ApplicationRecord
  belongs_to :user
  belongs_to :job

  mount_uploader :attachment, AttachmentUploader

  validates :content, presence: true
end
```

然后修改

app/views/resumes/new.html.erb

```
<%= simple_form_for [@job, @resume] do |f| %>
  <%= f.input :content %>
  <%= f.input :attachment %>

  <%= f.submit "送出" %>
<% end %>
```

在上传表单加入“档案上传”栏位。

成果会是这样：

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/kAAq0owTpq7z87LTG3BQ_%E8%9E%A2%E5%B9%95%E5%BF%AB%E7%85%A7%202016-07-30%20%E4%B8%8A%E5%8D%882.21.44.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/kAAq0owTpq7z87LTG3BQ_%E8%9E%A2%E5%B9%95%E5%BF%AB%E7%85%A7%202016-07-30%20%E4%B8%8A%E5%8D%882.21.44.png)

### Step 9 : 别忘了修改 resume_params

修改了表单，我们也要记得修改 `resume_params`，这样才能收到档案。

修改 `app/controllers/resumes_controller.rb`

app/controllers/resumes_controller.rb

```
 def resume_params
    params.require(:resume).permit(:content, :attachment)
  end

```

试着提交一份履历。

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/k81J5QMESGiMu7I1xCyl_%E8%9E%A2%E5%B9%95%E5%BF%AB%E7%85%A7%202016-07-30%20%E4%B8%8A%E5%8D%882.23.47.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/k81J5QMESGiMu7I1xCyl_%E8%9E%A2%E5%B9%95%E5%BF%AB%E7%85%A7%202016-07-30%20%E4%B8%8A%E5%8D%882.23.47.png)

这时候如果成功，你切过去 rails server 的 Log 会看到类似这一串：

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/KhK7v50cTduuGZDvdXpv_%E8%9E%A2%E5%B9%95%E5%BF%AB%E7%85%A7%202016-07-30%20%E4%B8%8A%E5%8D%882.24.19.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/KhK7v50cTduuGZDvdXpv_%E8%9E%A2%E5%B9%95%E5%BF%AB%E7%85%A7%202016-07-30%20%E4%B8%8A%E5%8D%882.24.19.png)

而且呢如果你 `git status` 会看到 `public/uploads/` 下有东西

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/46pn3Tb4QBLDDka7mEvN_%E8%9E%A2%E5%B9%95%E5%BF%AB%E7%85%A7%202016-07-30%20%E4%B8%8A%E5%8D%882.24.48.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/46pn3Tb4QBLDDka7mEvN_%E8%9E%A2%E5%B9%95%E5%BF%AB%E7%85%A7%202016-07-30%20%E4%B8%8A%E5%8D%882.24.48.png)

这时候如果我们打开这个目录，会看到这个资料夹下已经有 pdf

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/CgrDICbISB2sbtQGA7kh_%E8%9E%A2%E5%B9%95%E5%BF%AB%E7%85%A7%202016-07-30%20%E4%B8%8A%E5%8D%882.25.40.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/CgrDICbISB2sbtQGA7kh_%E8%9E%A2%E5%B9%95%E5%BF%AB%E7%85%A7%202016-07-30%20%E4%B8%8A%E5%8D%882.25.40.png)

### Step 10 ：使用 .gitignore 屏蔽使用者产生的档案

但是问题来了，使用者产生的档案，其实我们不应该在 git 里面对他们做版本控制。
因此我们要修改 `.gitignore` 这个档案，在里面注记，屏蔽掉底下所以生成的资源，避免他们被加入版本控制

修改 `.gitignore` 加入：

`public/uploads`

屏蔽

### Step 11 :

```
git add .
git commit -m "step 7 upload resume"
```

# 操作示范视频 - 招聘网站第七部分

# 12-1 加分习题

## Admin履历后台 － 加分习题

- Admin 在后台可以看到每个职缺有多少使用者投递履历
- Admin 在后台可以看到每个职缺里面的投递履历内容，并且可以下载附件

# 12-2（解答）招聘网站第八部分

## 目标

- Admin 在后台可以看到每个职缺有多少使用者投递履历
- Admin 在后台可以看到每个职缺里面的投递履历内容，并且可以下载附件

## 步骤：

### Step 0:

`git checkout -b step8`

### Step 1:

在 admin/jobs 列表加入 薪资上限、下限、收到多少份履历

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/lVcBJIp5SHWf74jwpFhh_%E8%9E%A2%E5%B9%95%E5%BF%AB%E7%85%A7%202016-07-30%20%E4%B8%8A%E5%8D%882.32.33.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/lVcBJIp5SHWf74jwpFhh_%E8%9E%A2%E5%B9%95%E5%BF%AB%E7%85%A7%202016-07-30%20%E4%B8%8A%E5%8D%882.32.33.png)

修改

app/views/admin/jobs/index.html.erb

```
<table class="table table-boldered">
    <thead>
        <tr>
            <td>
                职缺
            </td>

            <td>
              收到履历数量
            </td>
            <td>
                薪资下限
            </td>
            <td>
                薪资上限
            </td>
            <td>
                管理选项
            </td>
            <td>
                刊登时间
            </td>
        </tr>
    </thead>

    <% @jobs.each do |job| %>
    <tr>

        <td>
            <%= render_job_status(job) %>

            <%= link_to(job.title, admin_job_path(job)) %>
        </td>
        <td> <%= job.resumes.count %> </td>
        <td> <%= job.wage_lower_bound %> </td>
        <td> <%= job.wage_upper_bound %> </td>
        <td>
            <%= link_to("Edit", edit_admin_job_path(job)) %>
            |
            <%= link_to("Destroy", admin_job_path(job), :method => :delete, :data => { :confirm => "Are you sure?" }) %>

            |
            <% if job.is_hidden %>

            <%= link_to("Publish", publish_admin_job_path(job) , :method => :post, :class => "btn btn-xs btn-default") %>
        <% else %>
            <%= link_to("Hide", hide_admin_job_path(job), :method => :post,  :class => "btn btn-xs btn-default") %>
            <% end %>
        </td>
        <td>
            <%= job.created_at %>
        </td>
    </tr>
    <% end %>
</table>
```

### Step 2: 可以看到职缺里面有谁投递履历：

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/Rk4BLWIzQaaaNkI4LsrI_%E8%9E%A2%E5%B9%95%E5%BF%AB%E7%85%A7%202016-07-30%20%E4%B8%8A%E5%8D%883.48.17.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/Rk4BLWIzQaaaNkI4LsrI_%E8%9E%A2%E5%B9%95%E5%BF%AB%E7%85%A7%202016-07-30%20%E4%B8%8A%E5%8D%883.48.17.png)

修改

app/views/admin/jobs/index.html.erb

```
<td> <%= link_to(job.resumes.count, admin_job_resumes_path(job)) %> </td>
```

然后

`rails g controller admin::resumes`

修改

config/routes.rb

```
 namespace :admin do
    resources :jobs do
      member do
        post :publish
        post :hide
      end

 +    resources :resumes
    end
  end
```

然后修改

app/controllers/admin/resumes_controller.rb

```
class Admin::ResumesController < ApplicationController
  before_action :authenticate_user!
  before_action :require_is_admin

  layout 'admin'

  def index
    @job = Job.find(params[:job_id])
    @resumes = @job.resumes.order('created_at DESC')
  end
end
```

### Step 3: 设计履历列表

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/vQZPDjFLRhmanQj1IFDN_%E8%9E%A2%E5%B9%95%E5%BF%AB%E7%85%A7%202016-07-30%20%E4%B8%8A%E5%8D%882.42.39.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/vQZPDjFLRhmanQj1IFDN_%E8%9E%A2%E5%B9%95%E5%BF%AB%E7%85%A7%202016-07-30%20%E4%B8%8A%E5%8D%882.42.39.png)

touch `app/views/admin/resumes/index.html.erb`

app/views/admin/resumes/index.html.erb

```
<h2> <%= @job.title %> - 履历列表 </h2>

<hr>
<%= render :partial => "resume", :collection => @resumes, :as => :resume %>
```

touch `app/views/admin/resumes/_resume.html.erb`

app/views/admin/resumes/_resume.html.erb

```
<div class="panel panel-default">
    <div class="panel-heading">
        <div class="row">
            <div class="col-md-12">
                <h3 class="panel-title">
                    <%= resume.user.email %>
                </h3>
            </div>

        </div>
    </div>
    <div class="panel-body">
        <div class="trix-content">
            <p> <%= simple_format(resume.content) %> </p>
        </div>

        <hr>

        <% if resume.attachment.present? %>
          <i class="fa fa-paperclip"> </i>
          <%= link_to("Download Resume", resume.attachment_url) %>
        <% else %>
           No Attachment
        <% end %>
    </div>

</div>
```

### Step 999

```
git add .
git commit -m "admin can see resume list"
```

# 基础知识补充 DB Migration

### DB Migration

- Rails用来操作资料库（新增table，新增栏位...etc)
- 想法： (1)资料库栏位无法进行版本控制 (2)协作容易出事 (3)production与local栏位容易对不齐
- 解法：将操作步骤的方法用Ruby写进Git
- 可以前进 `rake db:migrate`
- 可以后退 `rake db:rollback`

### 注意

#### 刚刚跑完 migrate 发现打错字

- `rake db:rollback` （回退一次）
- 修改完
- 再跑`rake db:migrate`

#### 已经过了很久，才发现打错字

- `rails g migration fix_xxxx_xxxx`
- `rename_column :xxxx, :xxxx, :xxxx`
- `rake db:migrate`

#### 忘记加预设值

- `rails g migration fix_xxxx_xxxx`
- `change_column_default`

#### 全烂了怎么办?

##### `rake db:reset`

- `db:drop`(资料库移除）
- => `db:create`（资料库建立）
- => `db:schema:load`（资料库栏位建立）
- => `db:seed`(建立种子资料）

需要创建 seed 档案在 db 目录下

db/seed.rb

```
puts "這個種子檔會自動建立一個admin帳號, 並且創建 10 個 public jobs, 以及10個hidden jobs"

create_account = User.create([email: 'example@gmail.com', password: '12345678', password_confirmation: '12345678', is_admin: 'true'])
puts "Admin account created."

create_jobs = for i in 1..10 do
  Job.create!([title: "Job no.#{i}", description: "這是用種子建立的第 #{i} 個Public工作", wage_upper_bound: rand(50..99)*100, wage_lower_bound: rand(10..49)*100, is_hidden: "false"])
end
puts "10 Public jobs created."

create_jobs = for i in 1..10 do
  Job.create!([title: "Job no.#{i+10}", description: "這是用種子建立的第 #{i+10} 個Hidden工作", wage_upper_bound: rand(50..99)*100, wage_lower_bound: rand(10..49)*100,is_hidden: "true"])
end
puts "10 Hidden jobs created."
```

# [直播回放]1月12日 基础知识补充(DB)

主讲人：
YY老师

时间：
1月12日 20:00

时长：
主讲时长50分钟
答疑时长10分钟

概要：
1.基础操作演示（编程习惯、Git）
2.基础知识补充（DB）

# 魔改大赛

## 目标：

- 首页美化
- 管理员后台美化

### Part 1: 首页美化

#### Step 0: 把welcome/index设为首页

routes.rb

```
- root 'jobs#index'
+ root 'welcome#index'
```

#### Step 1: 在首页加个头图

welcome/index.html.erb

```
- <h1> Hello World! <h1>

+  <div class="jumbotron">
+    <h1 class="title">18K Offer</h1>
+    <p class="slogan">18K Offer 是一个提供18K薪水工作机会的求职网站。
+    <br>
+    我们希望藉由这个网站，能让大家找到且应征上高薪且优质的工作。
+    <br>
+     凭借自己的努力和天份也会变 Winner
+    </p>
+    <p class="lead"><a class="btn btn-lg btn-danger" href="/jobs">马上应征</a></p>
+  </div>
```

app/assets/stylesheets/application.scss

```
.jumbotron {
  background-image:url('http://y.photo.qq.com/img?s=n0m7YMg0L&l=y.jpg');
  background-repeat: no-repeat;
  background-size: cover;
  padding-bottom: 110px;
}

.title {
  font-family: "Helvetica Neue", "Microsoft Yahei", 微软雅黑;
  text-align: center;
  margin-top: 200px;
  margin-bottom: 80px;
}

.slogan {
  margin-top: 10px;
  margin-bottom: 50px;
  text-align: center;
  color: white;
  top: 12px;
}

.lead {
  margin-bottom: 60px;
  text-align: center;
  color: white;
}
```

#### Step 2: 在头图下方加入其他信息

welcome/index.html.erb

```
<section id="company">
  <div class = "container-fluid">
    <div class="row">
      <div class="col-sm-4 ">
        <div class="thumbnail">
          <img src="http://y.photo.qq.com/img?s=VfqbvmFVI&l=y.jpg" alt="search" class = "img-thumbnail">
          <div class="caption">
            <h3>北京朝阳建外SOHO</h3>
          </div>
        </div>
      </div>
      <div class="col-sm-4 ">
        <div class="thumbnail">
          <img src="http://y.photo.qq.com/img?s=9yBkCQVj7&l=y.jpg" alt="bid" class = "img-thumbnail">
          <div class="caption">
            <h3>info@18koffer.com</h3>
          </div>
        </div>
      </div>
      <div class="col-sm-4 ">
        <div class="thumbnail">
          <img src="http://y.photo.qq.com/img?s=bAQJ8dfF4&l=y.jpg" alt="heart" class = "img-thumbnail">
          <div class="caption">
            <h3>010-12344321</h3>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
```

app/assets/stylesheets/application.scss

```
.caption {
  margin: 30px;
  text-align: center;
  top: 20px;
}

.thumbnail {
    border: 0 none;
    box-shadow: none;
    margin-top: 60px;
}
```

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/1mWBUKptR9WOG7Y3xoWs_index2.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/1mWBUKptR9WOG7Y3xoWs_index2.png)

### Part 2: 管理员后台美化

#### Step 1:更改按钮样式

app/views/admin/jobs/index.html.erb

```
<td>
-    <%= link_to("Edit", edit_admin_job_path(job)) %>
-    |
-    <%= link_to("Destroy", admin_job_path(job), :method => :delete, :class => "btn btn-xs btn-default info", :data => { :confirm => "Are you sure?" }) %>
-    |
+    <%= link_to("Edit", edit_admin_job_path(job), :class => "btn btn-xs btn-info") %>
+    <%= link_to("Destroy", admin_job_path(job), :method => :delete, :class => "btn btn-xs btn-danger", :data => { :confirm => "Are you sure?" }) %>
     <% if job.is_hidden %>
-      <%= link_to("Publish", publish_admin_job_path(job) , :method => :post, :class => "btn btn-xs btn-default ") %>
+        <%= link_to("Publish", publish_admin_job_path(job) , :method => :post, :class => "btn btn-xs btn-success") %>
     <% else %>
-        <%= link_to("Hide", hide_admin_job_path(job), :method => :post,  :class => "btn btn-xs btn-default") %>
+        <%= link_to("Hide", hide_admin_job_path(job), :method => :post,  :class => "btn btn-xs btn-warning") %>
     <% end %>
</td>
```

#### Step 2: 更改表格样式

app/views/admin/jobs/index.html.erb

```
- <table class="table table-boldered" >
+ <table class="table table-boldered table-striped custab" >
```

app/assets/stylesheets/application.scss

```
.custab{
  border: 1px solid #ccc;

  padding: 5px;
  margin: 5% 0;
  box-shadow: 3px 3px 2px #ccc;

  transition: 0.5s;
}

.custab:hover{
  box-shadow: 3px 3px 0px transparent;
  transition: 0.5s;
}
```

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/9a5efHcTx2yvu8VUfDwT_colorbutton1.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/9a5efHcTx2yvu8VUfDwT_colorbutton1.png)

#### Step 3: git 存档

```
git add .
git commit -m "better welcome/index & admin/jobs/index"
```

### 本节作业

##### [第二周作业](https://fullstack.xinshengdaxue.com/assignments/7)：[参赛赢奖品](https://fullstack.xinshengdaxue.com/tasks/91)

已有 183 个第一期同学提交了这个作业 [**看看同学怎么做](https://fullstack.xinshengdaxue.com/tasks/91/other_answers?order=recent)

[**提交作业](https://fullstack.xinshengdaxue.com/tasks/91)

请依照本章节的教程，替换自己的首页图片和文字内容，完成后上传截图、heroku地址和github地址。

##### [第二周作业](https://fullstack.xinshengdaxue.com/assignments/7)：[为你喜欢的作品投票](https://fullstack.xinshengdaxue.com/tasks/92)

已有 164 个第一期同学提交了这个作业 [**看看同学怎么做](https://fullstack.xinshengdaxue.com/tasks/92/other_answers?order=recent)

[**提交作业](https://fullstack.xinshengdaxue.com/tasks/92)

请投票后[点击此处查看你支持的作品](https://fullstack.xinshengdaxue.com/competitions/1/my_voted)，并将截图交上来（拖曳到此处）
投票者均有机会获得投票奖：Xdite老师签名版《Growth Hack这样做》

备注：投票规则
1.本网站的免费用户/VIP 用户均可为参赛作品投票
2.每个用户最多可以为5个不同的作品投票
3.每个用户只能为同一个作品投一次票（免费用户一次投票＝1票，VIP用户一次投票＝3票）
4.投票后无法撤销投票

# [直播回放]1月19日 魔改大赛实操

主讲人：
YY老师

时间：
1月19日 20:00

时长：
主讲时长约45分钟
答疑时长约20分钟

概要：
魔改大赛实操

# 弹窗教程

## 目标：

- 点击注册/登入链接后，弹出窗口

## 步骤：

### step1 修改application.js文件，加入modal的js效果

app/assets/javascripts/application.js

```
+//= require bootstrap/modal
//= require_tree .
```

### step2 修改navbar文件，加入弹窗页面代码，将注册/登入链接与弹窗连接起来

app/views/common/_navbar.html.erb

```
略...
+<li><a href="#" data-toggle="modal" data-target="#signup-modal">注册</a></li>
+<li><a href="#" data-toggle="modal" data-target="#login-modal">登入</a></li>
-<li><%= link_to("注册", new_user_registration_path) %> </li>
-<li><%= link_to("登入", new_user_session_path) %></li>
略...
<!-- 以下代码添加在最后 -->
<div class="modal fade" id="login-modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display: none;">
  <div class="modal-dialog" role="document">
    <div class="loginmodal-container">
       <h2>Log in</h2>
       <%= simple_form_for(resource, as: resource_name, url: session_path(resource_name)) do |f| %>
         <div class="form-inputs">
           <%= f.input :email, required: false, autofocus: true %>
           <%= f.input :password, required: false %>
           <%= f.input :remember_me, as: :boolean if devise_mapping.rememberable? %>
         </div>
         <div class="form-actions">
           <%= f.button :submit, "Log in" %>
         </div>
       <% end %>
    </div>
  </div>
</div>

<div class="modal fade" id="signup-modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display: none;">
  <div class="modal-dialog">
    <div class="loginmodal-container">
      <h2>Sign up</h2>
        <%= simple_form_for(resource, as: resource_name, url: registration_path(resource_name)) do |f| %>
        <%= f.error_notification %>
        <div class="form-inputs">
          <%= f.input :email, required: true, autofocus: true %>
          <%= f.input :password, required: true, hint: ("#{@minimum_password_length} characters minimum" if @minimum_password_length) %>
          <%= f.input :password_confirmation, required: true %>
        </div>
        <div class="form-actions">
            <%= f.button :submit, "Sign up" %>
        </div>
      <% end %>
    </div>
  </div>
</div>
```

### step3 修改helper文件，让弹窗能够正常使用

app/helpers/application_helper.rb

```
module ApplicationHelper
  def resource_name
    :user
  end

  def resource
      @resource ||= User.new
  end

  def resource_class
      User
  end

  def devise_mapping
      @devise_mapping ||= Devise.mappings[:user]
  end
end
```

### step4 在application.scss文件中添加以下css代码，设置弹窗样式

app/assets/stylesheets/application.scss

```
@import url(http://fonts.googleapis.com/css?family=Roboto);

/****** LOGIN MODAL ******/
.loginmodal-container {
  padding: 30px;
  max-width: 350px;
  width: 100% !important;
  background-color: #F7F7F7;
  margin: 0 auto;
  border-radius: 2px;
  box-shadow: 0px 2px 2px rgba(0, 0, 0, 0.3);
  overflow: hidden;
  font-family: roboto;
}

.loginmodal-container h1 {
  text-align: center;
  font-size: 1.8em;
  font-family: roboto;
}

.loginmodal-container input[type=submit] {
  width: 100%;
  display: block;
  margin-bottom: 10px;
  position: relative;
}

.loginmodal-container input[type=text], input[type=password] {
  height: 44px;
  font-size: 16px;
  width: 100%;
  margin-bottom: 10px;
  -webkit-appearance: none;
  background: #fff;
  border: 1px solid #d9d9d9;
  border-top: 1px solid #c0c0c0;
  /* border-radius: 2px; */
  padding: 0 8px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
}

.loginmodal-container input[type=text]:hover, input[type=password]:hover {
  border: 1px solid #b9b9b9;
  border-top: 1px solid #a0a0a0;
  -moz-box-shadow: inset 0 1px 2px rgba(0,0,0,0.1);
  -webkit-box-shadow: inset 0 1px 2px rgba(0,0,0,0.1);
  box-shadow: inset 0 1px 2px rgba(0,0,0,0.1);
}

.loginmodal {
  text-align: center;
  font-size: 14px;
  font-family: 'Arial', sans-serif;
  font-weight: 700;
  height: 36px;
  padding: 0 8px;
/* border-radius: 3px; */
/* -webkit-user-select: none;
  user-select: none; */
}

.loginmodal-submit {
  /* border: 1px solid #3079ed; */
  border: 0px;
  color: #fff;
  text-shadow: 0 1px rgba(0,0,0,0.1);
  background-color: #4d90fe;
  padding: 17px 0px;
  font-family: roboto;
  font-size: 14px;
  /* background-image: -webkit-gradient(linear, 0 0, 0 100%,   from(#4d90fe), to(#4787ed)); */
}

.loginmodal-submit:hover {
  /* border: 1px solid #2f5bb7; */
  border: 0px;
  text-shadow: 0 1px rgba(0,0,0,0.3);
  background-color: #357ae8;
  /* background-image: -webkit-gradient(linear, 0 0, 0 100%,   from(#4d90fe), to(#357ae8)); */
}

.loginmodal-container a {
  text-decoration: none;
  color: #666;
  font-weight: 400;
  text-align: center;
  display: inline-block;
  opacity: 0.6;
  transition: opacity ease 0.5s;
}

.login-help{
  font-size: 12px;
}
```

最终效果如下图

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/ik73G3EpSKKshXRQuip0_loginmodal.jpg)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/ik73G3EpSKKshXRQuip0_loginmodal.jpg)
