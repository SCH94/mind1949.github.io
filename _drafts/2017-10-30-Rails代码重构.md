---
layout: post
title: "Railsä»£ç é‡æ„"
date: 2017-10-30
tags:
    Rails
    æ•™æ
---
| ä»€ä¹ˆæ˜¯é‡æ„ï¼Ÿ                                   |      |
| ---------------------------------------- | ---- |
| [**  1. ä»€ä¹ˆæ˜¯é‡æ„ï¼Ÿ](https://fullstack.xinshengdaxue.com/posts/1766) |      |

| å…³äº Controller                            |      |
| ---------------------------------------- | ---- |
| [**  2. å°†ä»£ç ä» Controller é‡æ„åˆ° Model](https://fullstack.xinshengdaxue.com/posts/1767) |      |
| [**  3. å–„ç”¨ Model scope](https://fullstack.xinshengdaxue.com/posts/1768) |      |
| [**  4. å–„ç”¨ Model association](https://fullstack.xinshengdaxue.com/posts/1769) |      |
| [**  5. æœ‰å…³è”çš„æƒé™æ£€æŸ¥ scope access](https://fullstack.xinshengdaxue.com/posts/1770) |      |
| [**  6. ä½¿ç”¨ Model è™šæ‹Ÿå±æ€§](https://fullstack.xinshengdaxue.com/posts/1771) |      |
| [**  7. ä½¿ç”¨ Model å›å‘¼(callback)](https://fullstack.xinshengdaxue.com/posts/1772) |      |
| [**  8. å°†é€»è¾‘æ”¾åˆ° Model](https://fullstack.xinshengdaxue.com/posts/1773) |      |
| [**  9. ä½¿ç”¨å·¥å‚æ–¹æ³•(Factory Method)å–ä»£å¤æ‚çš„å»ºæ„è¿‡ç¨‹](https://fullstack.xinshengdaxue.com/posts/1774) |      |

| å…³äº Model                                 |      |
| ---------------------------------------- | ---- |
| [**  10. å–„ç”¨ Module æŠ½å–ç›¸å…³ä»£ç ](https://fullstack.xinshengdaxue.com/posts/1775) |      |

| å…³äº View                                  |      |
| ---------------------------------------- | ---- |
| [**  11. å°†ä»£ç æ”¾å› controller](https://fullstack.xinshengdaxue.com/posts/1776) |      |
| [**  12. å°†ä»£ç é‡æ„åˆ° Model](https://fullstack.xinshengdaxue.com/posts/1777) |      |
| [**  13. å°†ä»£ç é‡æ„åˆ° Helper](https://fullstack.xinshengdaxue.com/posts/1778) |      |
| [**  14. å°†ä»£ç é‡æ„åˆ° Partial æ ·æ¿](https://fullstack.xinshengdaxue.com/posts/1779) |      |
| [**  15. ä½¿ç”¨ Partial å°½é‡ç”¨åŒºåŸŸå˜é‡å–ä»£å¯¹è±¡å˜é‡](https://fullstack.xinshengdaxue.com/posts/1780) |      |
| [**  16. æ•´ç† Helper æ¡£æ¡ˆ](https://fullstack.xinshengdaxue.com/posts/1781) |      |

| å…¶ä»–è¡¥å……                                     |                                          |
| ---------------------------------------- | ---------------------------------------- |
| [**  17. ä»£ç åˆ†æå·¥å…·](https://fullstack.xinshengdaxue.com/posts/1782) |                                          |
| [**  18. è¡¥å……å’Œæ¨èèµ„æº](https://fullstack.xinshengdaxue.com/posts/1783) | å…±1ä¸ªä½œä¸š \|[** æœªå®Œæˆ](https://fullstack.xinshengdaxue.com/posts/1783#task) |

# 1. ä»€ä¹ˆæ˜¯é‡æ„ï¼Ÿ

> è¿›è¡Œé‡æ„æ•™ç¨‹å‰ï¼Œè¯·å…ˆå®Œæˆç¼–ç¨‹è¯­è¨€ç³»åˆ—ã€‚

é‡æ„(Refactoring)æ˜¯æŒ‡å¯¹è½¯ä»¶ä»£ç è¿›è¡Œæ›´åŠ¨ä»¥å¢åŠ å¯è¯»æ€§æˆ–è€…ç®€åŒ–ç»“æ„ï¼Œä½†æ˜¯ä¸å½±å“åŠŸèƒ½å’Œè¾“å‡ºç»“æœã€‚

çœŸæ­£è¥è¿çš„è½¯ä»¶éƒ½æ˜¯æ¼”è¿›æ¥çš„ï¼Œè€Œä¸æ˜¯ä¸€æ­¥åˆ°ä½çš„ä½œå“ï¼Œéœ€è¦å€Ÿç”±é¢‘ç¹ä¸ç”¨æˆ·äº’åŠ¨å¾—åˆ°çš„å›é¦ˆæ¥ä¿®æ”¹è®¾è®¡ã€‚ä¸å…¶æŠŠè½¯ä»¶å¼€å‘æ¯”å–»æˆç›–æˆ¿å­ï¼Œå®é™…ä¸Šæ›´åƒæ˜¯å›­è‰ºï¼Œéœ€è¦é•¿æ—¶é—´çš„å‘µæŠ¤ã€‚æˆ‘ä»¬ç”šè‡³å¯ä»¥è¯´ï¼Œæ‰€æœ‰å¾—è½¯ä»¶å¼€å‘å…¶å®éƒ½æ˜¯ä¸€ç§ç»´æŠ¤ï¼Œå› ä¸ºç»å¤§éƒ¨åˆ†çš„æ—¶é—´éƒ½åœ¨æ”¹codeï¼Œå†™ä¸€ç‚¹æ”¹ä¸€ç‚¹ã€‚å³ä½¿æ˜¯æ–°é¡¹ç›®ï¼Œä¹Ÿå¾ˆå¿«éœ€è¦å›å¤´ä½œä¿®æ”¹ã€‚

å› æ­¤é¢å¯¹æ—¥æ¸å¤æ‚çš„ä»£ç ã€ä»¥åŠâ€¨å›¢é˜ŸååŒå¼€å‘çš„éœ€æ±‚ï¼Œç»´æŠ¤å¥½ä»£ç æ˜¯ä¸€ä»¶é‡è¦çš„äº‹æƒ…ã€‚

ä¸å¥½çš„ä»£ç ï¼Œä¼šæœ‰ä»¥ä¸‹ç—‡çŠ¶ï¼š

- åƒµç¡¬ (Rigidity)ï¼šéš¾ä»¥ä¿®æ”¹ï¼Œæ¯æ”¹ä¸€å¤„ç‰µä¸€å‘åŠ¨å…¨èº«
- è„†å¼± (Fragility)ï¼šä¸€æ—¦ä¿®æ”¹ï¼Œåˆ«çš„æ— å…³åœ°æ–¹ä¹Ÿç‚¸åˆ°
- å›ºå®š (Immobility)ï¼šéš¾ä»¥åˆ†è§£ï¼Œè®©ç¨‹å¼å†é‡ç”¨
- é»æ» (Viscosity)ï¼šå¼¹æ€§ä¸å¤Ÿï¼ŒæŠŠäº‹æƒ…åšå¯¹æ¯”åšé”™è¿˜éš¾
- ä¸éœ€è¦çš„å¤æ‚åº¦ (Needless Complexity)ï¼šè¿‡åº¦è®¾è®¡æ²¡ç›´æ¥å¥½å¤„çš„åŸºç¡€è®¾æ–½
- ä¸éœ€è¦çš„é‡å¤ (Needless Repetition)ï¼šç›¸åŒæ¦‚å¿µçš„ä»£ç è¢«å¤åˆ¶è´´ä¸Šé‡å¤ä½¿ç”¨
- æ™¦æ¶© (Opacity)ï¼šéš¾ä»¥é˜…è¯»ï¼Œæ— æ³•äº†è§£æ„å›¾

å¥½çš„ä»£ç ï¼Œä¼šæœ‰ä»¥ä¸‹ç‰¹å¾ï¼š

- Readability æ˜“è¯»ï¼Œå®¹æ˜“äº†è§£
- Flexibility å¼¹æ€§ï¼Œå®¹æ˜“æ‰©å……
- Effective æ•ˆç‡ï¼Œæ’°ç å¿«é€Ÿ
- Maintainability ç»´æŠ¤æ€§ï¼Œå®¹æ˜“æ‰¾åˆ°é—®é¢˜
- Consistency ä¸€è‡´æ€§ï¼Œå¾ªæƒ¯ä¾‹æ— éœ€æ­»èƒŒ
- Testability å¯æµ‹æ€§ï¼Œå…ƒä»¶ç‹¬ç«‹å®¹æ˜“æµ‹è¯•

å¾ˆå¤šæ—¶å€™ï¼Œä¸ºäº†é¡¹ç›®æ—¶ç¨‹ï¼Œæˆ‘ä»¬ä¼šåœ¨é¡¹ç›®åˆæœŸåªä¸“æ³¨äºå°½å¿«å®Œæˆé¡¹ç›®ï¼Œè€Œå¦¥åäºå†™å‡ºä¸å¥½çš„ä»£ç ï¼Œè¿™äº›ä¸å¥½çš„ä»£ç åˆè¢«å«åš[æŠ€æœ¯è´Ÿå€º](https://zh.wikipedia.org/wiki/%E6%8A%80%E6%9C%AF%E8%B4%9F%E5%80%BA)ã€‚å› ä¸ºå°±åƒå€ºåŠ¡ä¸€æ ·ï¼Œè™½ç„¶çŸ­æœŸå¯ä»¥å¾—åˆ°å¥½å¤„ï¼Œä½†å¿…é¡»ä»åœ¨æœªæ¥å¿è¿˜ï¼Œä¸ç„¶ä¹‹åè½¯ä»¶ä¼šå˜æˆè¶Šæ¥è¶Šéš¾ç»´æŠ¤ï¼Œè¦æ–°å¢åŠŸèƒ½çš„å¼€å‘æˆæœ¬ä¹Ÿä¼šè¶Šæ¥è¶Šé«˜ã€‚å·¥ç¨‹å¸ˆéœ€è¦ä»˜å‡ºæ—¶é—´æˆæœ¬æ‰èƒ½ä¿®å¤ä¹‹å‰çš„å¦¥åæ‰€é€ æˆçš„é—®é¢˜ã€‚

é€è¿‡é‡æ„è¡Œä¸ºï¼Œæˆ‘ä»¬å¸Œæœ›è®©ä¸å¥½çš„ä»£ç ï¼Œå˜æˆå¥½çš„ä»£ç ï¼Œå‡å°‘æŠ€æœ¯è´Ÿå€ºã€‚è¿™ä»½æ•™ç¨‹ï¼Œä¼šç”¨å®é™…çš„èŒƒä¾‹ï¼Œè¯´æ˜é‡æ„å‰å’Œé‡æ„åçš„å·®å¼‚ã€‚è¿™ç¯‡æ•™ç¨‹æ²¡æœ‰æåŠè‡ªåŠ¨åŒ–æµ‹è¯•ï¼Œä¸è¿‡ä¸€ä¸ªå¥½çš„é‡æ„ï¼Œå»ºè®®æ­é…è‡ªåŠ¨åŒ–çš„æµ‹è¯•ï¼Œè¿™æ ·æ‰å¯ä»¥ç¡®ä¿é‡æ„å‰åçš„è½¯ä»¶è¡Œä¸ºæ˜¯ä¸€æ ·çš„ï¼Œè€Œæ²¡æœ‰å¸¦æ¥æ–°çš„ bugsã€‚

> é‡æ„ä¸ç­‰äºé‡å†™ã€‚é‡æ„æ›´åƒæ˜¯å°åœ°æ–¹å°åœ°æ–¹çš„ä¸æ–­æŒç»­æ”¹å–„ï¼Œè€Œä¸æ˜¯èŠ±å‡ ä¸ªæœˆæŠŠä»£ç ç æ‰é‡å†™ã€‚

é‡æ„æ•™ç¨‹ç€é‡åœ¨æ€è€ƒä¸ºä»€ä¹ˆè¿™æ ·å†™æ¯”è¾ƒå¥½ï¼Œè€Œä¸æ˜¯å®ç°åŠŸèƒ½ã€‚ç…§ç€åšæ˜¯æ²¡æœ‰æ„ä¹‰çš„ï¼Œå› æ­¤è¿™ä»½æ•™ç¨‹å¹¶æ²¡æœ‰å®Œæ•´çš„åŠŸèƒ½å®ç°ï¼Œè€Œæ˜¯ä»£ç ç‰‡æ®µ(code snippet)ã€‚

# 2. å°†ä»£ç ä» Controller é‡æ„åˆ° Model

[Skinny Controller, Fat Model](http://weblog.jamisbuck.org/2006/10/18/skinny-controller-fat-model) æ˜¯ä¸€ç¯‡åœ¨ Rails ç¤¾åŒºéå¸¸æœ‰åçš„æ–‡ç« ï¼Œè¿™ç¯‡ 2006 å¹´ Rails 2 æ—¶æœŸçš„æ—§æ–‡ç« ï¼Œå®šè°ƒäº† Fat Controller æ˜¯ä¸€ç§åæ¨¡å¼(anti-pattern)ã€‚æ”¾åœ¨ Controller çš„ä»£ç ä¸€èˆ¬æ¥è¯´æ¯”è¾ƒéš¾è¿›è¡Œé‡ç”¨(re-use)å’Œå•å…ƒæµ‹è¯•ï¼Œå¯è¯»æ€§ä¹Ÿè¾ƒå·®ï¼Œæˆ‘ä»¬å¸Œæœ›å°†æ›´å¤šä»£ç æ”¾åœ¨ Model é‡Œé¢ã€‚

ä¸€ä¸ª Rails é¡¹ç›®å¦‚æœ controller ä»£ç å¾ˆå¤šï¼Œä½†æ˜¯ model ä»£ç æ‰“å¼€å´æ²¡æœ‰è‡ªå®šä¹‰ä»€ä¹ˆæ–¹æ³•ï¼Œç»™äººçš„å°è±¡ä¸Šå°±æ˜¯è¿™æ˜¯è½¯ä»¶å¼€å‘åˆå­¦è€…æ‰€å†™çš„é¡¹ç›®ã€‚

åŸºæœ¬ä¸Šï¼Œä¸€æ®µ Controller çš„ action ä»£ç å¦‚æœè¶…è¿‡15è¡Œä»¥ä¸Šï¼Œå¾ˆå¯èƒ½è¿™æ®µä»£ç è¡¨ç¤ºå¤ªè‚¥å¤§äº†ï¼Œåº”è¯¥è¿›è¡Œé‡æ„ã€‚

ä»¥ä¸‹ç¤ºèŒƒå‡ ä¸ªæƒ…å¢ƒï¼Œé€‚åˆå°† Controller çš„ä»£ç é‡æ„åˆ° Modelï¼Œç›®çš„éƒ½æ˜¯åœ¨ç®€åŒ– controller çš„ä»£ç ã€‚

# 3. å–„ç”¨ Model scope

æƒ…å¢ƒï¼šåœ¨ action ä¸­éœ€è¦ä¾ç…§ä¸åŒæ¡ä»¶æå– Model æ•°æ®

é‡æ„å‰ï¼šåœ¨ action ä¸­ç”¨ where æŒ‡å®šä¸åŒæ¡ä»¶

```
class PostsController < ApplicationController
  def index
    @public_posts = Post.where(:state => 'public' ).limit(10)
                  .order('id desc')
    @draft_posts  = Post.where(:state => â€˜draft').limit(10)
                  .order('id desc')
  end
end
```

é‡æ„åï¼šæŠŠ where æ¡ä»¶æ¬åˆ° model çš„ scope å®£å‘Šï¼Œè¿™æ ·å°±å¯ä»¥åœ¨ controller ä½¿ç”¨å·²ç»å®šä¹‰å¥½çš„ scopeã€‚å¯è¯»æ€§å˜å¥½ï¼Œè€Œä¸”å¯ä»¥åœ¨ä¸åŒåœ°æ–¹é‡å¤æ²¿ç”¨è¿™ä¸ª scopeã€‚

```
class Post < ActiveRecord::Base
  scope :published, -> { where(:state => â€˜published').limit(10)
                        .order('id desc') }
  scope :draft, -> { where(:state => â€˜draft').limit(10)
                    .order('id desc') }
end
```

```
class UsersController < ApplicationController
  def index
    @published_post = Post.published
    @draft_post = Post.draft
  end
end
```

# 4. å–„ç”¨ Model association

æƒ…å¢ƒï¼šæ–°å»ºæ•°æ®æ—¶ï¼Œæƒ³è¦å…³è”å»ºç«‹çš„ç”¨æˆ·

é‡æ„å‰ï¼š

```
class PostsController < ApplicationController
  def create
    @post = Post.new(params[:post])
    @post.user_id = current_user.id
    @post.save
  end
end
```

é‡æ„åï¼šç”±äº User has_many posts çš„å…³ç³»ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ `current_user.posts.build` æ¥å–ä»£ `@post.user_id = current_user.id` çš„ä½œç”¨ã€‚

```
class PostsController < ApplicationController
  def create
    @post = current_user.posts.build(params[:post])
    @post.save
  end
end
```

```
class User < ActiveRecord::Base
  has_many :posts
end
```

# 5. æœ‰å…³è”çš„æƒé™æ£€æŸ¥ scope access

æƒ…å¢ƒï¼šè¯»å–æ•°æ®æ—¶ï¼Œæƒ³è¦æ£€æŸ¥ç”¨æˆ·æœ‰æ²¡æœ‰æ“ä½œè¯¥æ•°æ®çš„æƒé™

é‡æ„å‰ï¼šéœ€è¦æ£€æŸ¥ `@post.user` ç­‰äº `current_user`

```
class PostsController < ApplicationController
  def edit
    @post = Post.find(params[:id)
    if @post.user != current_user
      flash[:warning] = 'Access denied'
      redirect_to posts_url
    end
  end
end
```

é‡æ„åï¼šç›´æ¥ç”¨ `current_user.posts.find` å°±å¯ä»¥äº†ã€‚å¦‚æœè¯¥ post ä¸å±äºè¯¥ userï¼Œå°±ä¼šæ‰¾ä¸åˆ°æ•°æ®ã€‚ä¸è¿‡ï¼Œå¦‚æœæƒé™å…è®¸ç®¡ç†å‘˜çš„è¯ï¼Œè¿™æ‹›å°±ä¸è¡Œäº†ã€‚

```
class PostsController < ApplicationController
  def edit
    # raise RecordNotFound exception (404 error) if not found

    @post = current_user.posts.find(params[:id)
  end
end
```

# 6. ä½¿ç”¨ Model è™šæ‹Ÿå±æ€§

æƒ…å¢ƒï¼šåœ¨è¡¨å•ä¸­ï¼Œæ“ä½œä¸æ˜¯ç›´æ¥å¯¹åº” Model å±æ€§çš„å­—æ®µã€‚ä¾‹å¦‚ä¸‹è¿°èŒƒä¾‹ï¼Œå‡è®¾ User model é‡Œé¢æœ‰ `first_name` å’Œ `last_name` å­—æ®µï¼Œä½†æ˜¯ç”»é¢æ˜¾ç¤ºæ—¶ï¼Œæˆ‘ä»¬å¸Œæœ›æ”¹ç”¨ `full_name` æ¥æ“ä½œã€‚è¿™ä¸ª `full_name`å¹¶ä¸æ˜¯æ•°æ®åº“ä¸­çœŸæ­£çš„å­—æ®µï¼Œè€Œæ˜¯ first_name å’Œ last_name ä¸¤ä¸ªå­—æ®µåˆåœ¨ä¸€èµ·æ˜¾ç¤ºè€Œå·²ã€‚

é‡æ„å‰ï¼šè¡¨å•åªèƒ½ç”¨åŸå§‹çš„ `text_field_tag` æ–¹æ³•ï¼Œå¹¶ä¸”åœ¨ action ä¸­æ‹†å¼€ `params[:full_name]` å¡è¿› model çš„ first_name å’Œ last_name å­—æ®µ

```
<% form_for @user do |f| %>
    <%= text_filed_tag :full_name %>
<% end %>
```

```
class UsersController < ApplicationController
  def create
    @user = User.new(params[:user)
    @user.first_name = params[:full_name].split(' ', 2).first
    @user.last_name = params[:full_name].split(' ', 2).last
    @user.save
  end
end
```

é‡æ„åï¼šåœ¨ model ä¸­æ–°å¢ `full_name` å’Œ `full_name=` æ–¹æ³•ï¼Œè¿™æ ·åœ¨è¡¨å•å°±å¯ä»¥æŠŠ `full_name` å½“ä½œä¸€èˆ¬çš„ model å­—æ®µä½¿ç”¨ã€‚è€Œ controller action æ›´æ˜¯ç®€åŒ–åˆ°ä¸éœ€è¦å¤„ç† `full_name`ã€‚è¿™ä¸ª `full_name` å¹¶æ²¡æœ‰å®é™…å¯¹åº”æ•°æ®åº“çš„å­—æ®µï¼Œå› æ­¤ç§°ä¹‹è™šæ‹Ÿå±æ€§ã€‚

```
class User < ActiveRecord::Base
  def full_name
    [first_name, last_name].join(' ')
  end

  def full_name=(name)
    split = name.split(' ', 2)
    self.first_name = split.first
    self.last_name = split.last
  end
end
```

```
<% form_for @user do |f| %>
  <%= f.text_field :full_name %>
<% end %>
```

```
class UsersController < ApplicationController

  def create
    @user = User.create(params[:user)
  end

end
```

# 7. ä½¿ç”¨ Model å›å‘¼(callback)

æƒ…å¢ƒï¼šæ–°å¢æ–‡ç« æ—¶ï¼Œæœ‰ä¸€ä¸ªæ ¸é€‰æ–¹å— `auto_tagging`ï¼Œå¦‚æœæ‰“å‹¾è¡¨ç¤ºæƒ³è¦ç³»ç»Ÿè‡ªåŠ¨ä¸‹æ ‡ç±¤ã€‚

é‡æ„å‰ï¼šéœ€è¦åœ¨ action ä¸­æ£€æŸ¥ `params[:auto_tagging]`ï¼Œç„¶åè°ƒç”¨ model æ–¹æ³•äº§ç”Ÿæ ‡ç±¤(è¿™é‡Œå‡è®¾æœ‰ä¸€ä¸ª AsiaSearch.generate_tags æ–¹æ³•å¯ä»¥è‡ªåŠ¨ä¸‹æ ‡ç±¤)

```
<% form_for @post do |f| %>
  <%= f.text_field :content %>
  <%= check_box_tag 'auto_tagging' %>
<% end %>
```

```
class PostController < ApplicationController
  def create
    @post = Post.new(params[:post])
    if params[:auto_tagging] == '1'
      @post.tags = AsiaSearch.generate_tags(@post.content)
    else
      @post.tags = ""
    end
    @post.save
  end
end
```

é‡æ„åï¼šæ–°å¢ä¸€ä¸ªè™šæ‹Ÿå±æ€§ `auto_tagging`ï¼Œä»¥åŠä¸€ä¸ª before_save å›å‘¼æ¥æ£€æŸ¥è¦ä¸è¦è‡ªåŠ¨ä¸‹æ ‡ç±¤ã€‚å¦‚æ­¤åœ¨ action ä¸­å°±å¯ä»¥ä¸å¿…æ£€æŸ¥å’Œå¤„ç† auto_taggingã€‚è¿™æ®µè¿‡ç¨‹ä¼šè‡ªåŠ¨åœ¨ Post å­˜å‚¨å‰ï¼Œè‡ªåŠ¨è°ƒç”¨ `generate_taggings` æ–¹æ³•è¿›è¡Œå¤„ç†ã€‚

```
class Post < ActiveRecord::Base
  attr_accessor :auto_tagging
  before_save :generate_taggings

  private
  def generate_taggings
    return unless auto_tagging == '1' self.tags = Asia.search(self.content)
  end
end
```

```
<% form_for :note, ... do |f| %>
  <%= f.text_field :content %>
  <%= f.check_box :auto_tagging %>
<% end %>
```

```
class PostController < ApplicationController
  def create
    @post = Post.new(params[:post])
    @post.save
  end
end
```

# 8. å°†é€»è¾‘æ”¾åˆ° Model

æƒ…å¢ƒï¼šæœ‰ä¸€ä¸ªå‘å¸ƒæ–‡ç«  publish çš„ action æœ‰å¾ˆå¤šæ“ä½œçš„ç›¸å…³æ­¥éª¤ï¼Œéœ€è¦è®¾å®šå¾ˆå¤š model å­—æ®µã€‚

é‡æ„å‰ï¼šæ‰€æœ‰æ“ä½œéƒ½åœ¨ action ä¹‹ä¸­

```
class PostController < ApplicationController
 def publish
   @post = Post.find(params[:id])
   @post.is_published = true
   @post.approved_by = current_user

   if @post.create_at > Time.now - 7.days
     @post.popular = 100
   else
     @post.popular = 0
   end

   @post.save
   redirect_to post_url(@post)
  end
end
```

é‡æ„åï¼šæŠŠç›¸å…³çš„æ“ä½œå…¨éƒ¨æ¬åˆ° Model çš„è‡ªå®šä¹‰æ–¹æ³• `publish!`ï¼Œè¿™æ · action ä¸­åªéœ€è¦è°ƒç”¨ `@post.publish!` å³å¯ï¼Œéå¸¸å¯è¯»æ¸…æ¥šã€‚è¿™ä¸ª `publish!` æ–¹æ³•ä¹Ÿå¯ä»¥åœ¨å…¶å®ƒå„å¤„ä½¿ç”¨ã€‚

```
class Post < ActiveRecord::Base
  def publish!(user)
    self.is_published = true
    self.approved_by = user
    if self.create_at > Time.now-7.days
      self.popular = 100
    else
      self.popular = 0
    end
    self.save!
  end
end
```

```
class PostController < ApplicationController
  def publish
    @post = Post.find(params[:id])
    @post.publish!(current_user)

    redirect_to post_url(@post)
  end
end
```

# 9. ä½¿ç”¨å·¥å‚æ–¹æ³•(Factory Method)å–ä»£å¤æ‚çš„å»ºæ„è¿‡ç¨‹

æƒ…å¢ƒï¼šå»ºç«‹ model éœ€è¦å¤æ‚çš„å»ºæ„è¿‡ç¨‹ï¼Œä¾‹å¦‚ä»¥ä¸‹å»ºæ„ Invoice éœ€è¦è®¾å®šå¾ˆå¤šå±æ€§ã€‚

é‡æ„å‰ï¼šéƒ½åœ¨ create action ä¸­å®Œæˆ

```
class InvoiceController < ApplicationController
  def create
    @invoice = Invoice.new(params[:invoice])
    @invoice.address = current_user.address
    @invoice.phone = current_user.phone
    @invoice.vip = ( @invoice.amount > 1000 )

    if Time.now.day > 15
      @invoice.delivery_time = Time.now + 2.month
    else
      @invoice.delivery_time = Time.now + 1.month
    end

    @invoice.save
  end
end
```

é‡æ„åï¼šåœ¨ model ä¸­æ–°å†™ä¸€ä¸ªç±»æ–¹æ³• `new_by_user`ï¼ŒæŠŠå»ºæ„çš„è¿‡ç¨‹å…¨éƒ¨æ¬è¿›æ¥ã€‚è¿™æ · controller action é‡Œé¢åªéœ€è¦è°ƒç”¨è¿™ä¸ªæ–¹æ³•å³å¯ã€‚è¿™ä¸€æ‹›è·Ÿä¸Šä¸€èŠ‚æ˜¯ä¸€æ ·çš„é“ç†ã€‚è¿™ç§å»ºæ„ç”¨é€”çš„æ–¹æ³•åˆå«åšå·¥å‚æ–¹æ³•ã€‚

```
class Invoice < ActiveRecord::Base
  def self.new_by_user(params, user)
    invoice = self.new(params)
    invoice.address = user.address
    invoice.phone = user.phone
    invoice.vip = ( invoice.amount > 1000 )
    if Time.now.day > 15
      invoice.delivery_time = Time.now + 2.month
    else
      invoice.delivery_time = Time.now + 1.month
    end
    return invoice
  end
end
```

```
class InvoiceController < ApplicationController
  def create
    @invoice = Invoice.new_by_user(params[:invoice], current_user)
    @invoice.save
  end
end
```

# 10. å–„ç”¨ Module æŠ½å–ç›¸å…³ä»£ç 

æƒ…å¢ƒï¼šå¦‚æœå°†ä»£ç ä» Controller é‡æ„åˆ° Model åšå¾—ä¸é”™äº†ï¼Œæ¥ä¸‹æ¥å¦‚ä½•è¿›ä¸€æ­¥é‡æ„ Model ä»£ç ï¼Ÿ

é‡æ„å‰ï¼šåœ¨ Model ä¸­æœ‰ä¸€äº›é«˜åº¦ç›¸å…³çš„ä»£ç ï¼Œå¸Œæœ›èƒ½å¤Ÿæ›´æ¸…æ¥šä»–ä»¬æ˜¯ä¸€èµ·çš„ï¼Œæˆ–æ˜¯å¸Œæœ›èƒ½åœ¨ä¸åŒ Model ä¸­ä¹Ÿèƒ½é‡å¤ä½¿ç”¨ã€‚

```
class User < ActiveRecord::Base

  validates_presence_of :cellphone
  before_save :parse_cellphone

  def parse_cellphone
    # do something

  end

  def self.foobar
    # do something

  end

end
```

é‡æ„åï¼šå–„ç”¨ Ruby çš„ module è¯­æ³•ï¼Œå¯ä»¥å°†è¿™äº›ç›¸å…³ä»£ç æŠ½å–å‡ºæ¥ï¼Œæ”¾åœ¨ `app/models/concerns` ç›®å½•ä¸‹ï¼ŒåŒ…æ‹¬ model çš„ validates å®£å‘Šã€å›å‘¼å®£å‘Šã€å…³è”å®£å‘Šã€å¯¹è±¡æ–¹æ³•ã€ç±»æ–¹æ³•ç­‰ç­‰éƒ½å¯æŠ½å–å‡ºæ¥ã€‚

app/models/concerns/has_cellphone.rb

```
module HasCellphone

  def self.included(base)
    base.validates_presence_of :cellphone
    base.before_save :parse_cellphone
    base.extend ClassMethods
  end

  def parse_cellphone
    # do something

  end

  module ClassMethods
    def foobar
      # do something

    end
  end

end
```

æˆ–æ˜¯ä½¿ç”¨ [Rails ActiveSupport::Concern](http://api.rubyonrails.org/v5.1/classes/ActiveSupport/Concern.html) è¯­æ³•ï¼Œå¯ä»¥æ›´ç®€æ´ä¸€ç‚¹ï¼š

app/models/concerns/has_cellphone.rb

```
module HasCellphone
  extend ActiveSupport::Concern

  included do
    validates_presence_of :cellphone
    before_save :parse_cellphone
  end

  def parse_cellphone
    # do something

  end

  class_methods do
    def foobar
      # do something

    end
  end

end
```

æœ€ååœ¨ model é‡Œé¢ include å³å¯ã€‚

```
class User < ActiveRecord::Base
  include HasCellphone
end
```

å…¶ä»– model ä¹Ÿå¯ä»¥æ²¿ç”¨è¿™æ®µä»£ç ï¼Œåªè¦ include å³å¯ï¼š

```
class Contact < ActiveRecord::Base
  include HasCellphone
end
```

è¿™ä¸€æ‹›å…¶å® controller ä¹Ÿå¯ä»¥ç”¨ï¼Œåœ¨ rails ä¸­ `app/controllers/concerns` ç›®å½•å°±æ˜¯æ‹¿æ¥æ”¾ controller çš„ module æ¡£æ¡ˆ

# 11. å°†ä»£ç æ”¾å› controller

> å…³äº Viewï¼Œæœ€é‡è¦çš„å®ˆåˆ™å°±æ˜¯åœ¨ template ä¸­ç»å¯¹æ²¡æœ‰å•†åŠ¡é€»è¾‘ã€‚

é‡æ„å‰ï¼šåœ¨ View å‡ºç°äº† `@posts = Post.all`

```
<% @posts = Post.all %>

<% @posts.each do |post| %>
 <%= post.title %>
 <%= post.content %>
<% end %>
```

é‡æ„åï¼šåº”è¯¥åœ¨ controller ä¸­å°±å…ˆè¯»å– @posts

```
class PostsController < ApplicationController

  def index
    @posts = Post.all
  end

end
```

```
<% @posts.each do |post| %>
 <%= post.title %>
 <%= post.content %>
<% end %>
```

# 12. å°†ä»£ç é‡æ„åˆ° Model

æƒ…å¢ƒï¼šåœ¨ View ä¸­éœ€è¦ä¸€äº›æ¡ä»¶åˆ¤æ–­ï¼Œæ¥å†³å®šè¦ä¸è¦æ˜¾ç¤ºæŸäº›å†…å®¹

é‡æ„å‰ï¼šéœ€è¦æ£€æŸ¥æœ‰ç™»å…¥ã€è¯¥ç”¨æˆ·æ˜¯è¯¥ç¯‡æ–‡ç« ä½œè€…æˆ–æ˜¯ç¼–è¾‘å‘˜

```
<% if current_user && (current_user == @post.user ||
                       @post.editors.include?(current_user) %>
  <%= link_to 'Edit this post', edit_post_url(@post) %>
<% end %>
```

é‡æ„åï¼šè¿™ä¸€æ•´æ®µæ¡ä»¶åˆ¤æ–­ï¼Œå¯ä»¥é‡æ„åˆ° Model çš„ä¸€ä¸ªæ–¹æ³•ã€‚è¿™æ · View é‡Œé¢åªéœ€è¦è°ƒç”¨ `@post.editable_by?(current_user)` å³å¯ï¼Œä»£ç å¹²å‡€åˆæ¸…æ¥šã€‚

```
<% if @post.editable_by?(current_user) %>
  <%= link_to 'Edit this post', edit_post_url(@post) %>
<% end %>
```

```
class Post < ActiveRecord::Base
  def ediable_by?(user)
    user && ( user == self.user || self.editors.include?(user)
  end
end
```

# 13. å°†ä»£ç é‡æ„åˆ° Helper

æƒ…å¢ƒï¼š

- HTML ä¸ Ruby é«˜åº¦æ··æ‚
- è¯¥æ®µç¨‹å¼ç æœ‰å¾ˆå¤š if / else
- è¯¥æ®µç¨‹å¼ç è¡£æœç©¿å¾ˆå¤šå±‚ simple_format(truncate(auto_link(@post.content), :length => 30) )

é‡æ„å‰ï¼šæˆ‘ä»¬æƒ³è¦æŠŠæ–‡ç« å†…å®¹è‡ªåŠ¨åŠ è¶…è¿ç»“ã€æˆªæ–­åªç•™å‰30å­—å‰ã€ä¿ç•™æ¢è¡Œç­‰ç­‰ï¼š

```
<%= simple_format(truncate(auto_link(@post.content), :length => 30) ) %>
```

é‡æ„åï¼šæŠ½å–å‡ºä¸€ä¸ª `pretty_content` helper æ–¹æ³•ï¼Œè¿™æ ·åœ¨å„å¤„ template éƒ½å¯ä»¥é‡å¤ä½¿ç”¨è¿™ä¸ª helperï¼Œè€Œä¸”ä¹Ÿæ¯”è¾ƒæ¸…æ¥šã€‚

app/helpers/posts_helper.rb

```
module PostsHelper
  def pretty_content(content)
    simple_format(truncate(auto_link(content), :length => 30) )
  end
end
```

```
<%= pretty_content(@post.content) %>
```

> é‚£åˆ°åº•ä»€ä¹ˆæƒ…å¢ƒé€‚åˆæŠŠä»£ç é‡æ„åˆ° Model? ä»€ä¹ˆæ—¶å€™ç”¨ Helper å‘¢ï¼Ÿå¦‚æœè·Ÿ HTML ç”»é¢æ˜¾ç¤ºæ— å…³ï¼Œè·Ÿå•†åŠ¡é€»è¾‘æœ‰å…³ï¼Œåˆ™æ”¾åˆ° Model é‡Œé¢ã€‚å¦‚æœè·Ÿ HTML ç”»é¢æ˜¾ç¤ºæœ‰å…³ï¼Œåˆ™é€‚åˆæ”¾åœ¨ Helper é‡Œé¢ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œåœ¨ Model é‡Œé¢æ˜¯ä¸ä¼šå¤„ç† HTML ä»£ç çš„ï¼Œè¿™æ˜¯ Helper çš„äº‹æƒ…ã€‚

# 14. å°†ä»£ç é‡æ„åˆ° Partial æ ·æ¿

æƒ…å¢ƒï¼šHelper æ˜¯ Ruby ä»£ç ï¼Œé‡Œé¢ä¸é€‚åˆæ”¾å¤ªå¤šçš„ HTMLã€‚å¦‚æœä½ æœ‰ä¸€æ•´æ®µçš„ HTML ä»£ç æƒ³è¦æŠ½å–å‡ºæ¥ï¼Œåº”è¯¥ç”¨ Partial æ ·æ¿ã€‚

é‡æ„å‰ï¼š

```
def render_product_item(product)
  content_tag(:div, :class => "col-md-3") do
    content_tag(:div, link_to(product.title), product_path(product) ) +
    content_tag(:p, tag(:hr)) +
    content_tag(:span, product.price + "å…ƒ")
  end
end
```

```
 <%= render_product_item(@product) %>
```

é‡æ„åï¼šåº”è¯¥æ”¹ç”¨ partial è€Œä¸æ˜¯ helperã€‚

app/views/products/_item.html.erb

```
<div class="col-md-3">
  <div><%=link_to(product.title), product_path(product) %></div>
  <p>
    <hr>
    <span><%= product.price %>å…ƒ</span>
  </p>
</div>
```

```
 <%= render :partial => "item", :locals => { :product => @product } %>
```

# 15. ä½¿ç”¨ Partial å°½é‡ç”¨åŒºåŸŸå˜é‡å–ä»£å¯¹è±¡å˜é‡

æƒ…å¢ƒï¼šåœ¨ä½¿ç”¨ Partial æ—¶

```
class Post < ApplicationController
  def show
    @post = Post.find(params[:id)
  end
end
```

é‡æ„å‰ï¼šåœ¨ action ä¸­å®£å‘Šçš„å¯¹è±¡å˜é‡ä¾‹å¦‚ `@post`ï¼Œä¼šç©¿é€åˆ°è¿™ä¸ª template å†…æ‰€æœ‰ä½¿ç”¨çš„ partialã€‚è™½ç„¶å¾ˆæ–¹ä¾¿ï¼Œä½†æ˜¯å¦‚æœ partial å†…è¦ç”¨åˆ°çš„å˜é‡å¾ˆå¤šï¼Œå°±ä¼šæä¸æ¸…æ¥šåˆ°åº•è¦å‡†å¤‡å“ªäº›å˜é‡æ‰èƒ½ä½¿ç”¨è¿™ä¸ª partialã€‚

```
<%= render :partial => "sidebar" %>
```

_sidebar.html.erb

```
<%= @post.title %>
```

é‡æ„åï¼šå°† @post ä¼ å…¥è¿™ä¸ª partialï¼Œè¿™æ ·åœ¨è¿™ä¸ª partial é‡Œé¢ï¼Œå°±ä¼šå˜æˆåŒºåŸŸå˜é‡ `post`ã€‚è¿™ä¸ªå¥½å¤„æ˜¯å¯ä»¥å¢åŠ è¿™ä¸ª partial çš„å¯é‡å¤ä½¿ç”¨æ€§ï¼Œä¹Ÿæ¯”è¾ƒæ¸…æ¥šè¦ä¼ è¿™äº›å˜é‡æ‰èƒ½ä½¿ç”¨ã€‚

```
<%= render :partial => "sidebar", :locals => { :post => @post } %>
```

_sidebar.html.erb

```
<%= post.title %>
```

# 16. æ•´ç† Helper æ¡£æ¡ˆ

æƒ…å¢ƒï¼šæ¯æ¬¡ rails g controller XXX æ—¶ï¼ŒRails éƒ½ä¼šè‡ªåŠ¨æ–°å¢å¯¹åº”çš„ XXX_helper.rb æ¡£æ¡ˆ

é‡æ„å‰ï¼šå¾ˆå¤š Helper æ¡£æ¡ˆæ‰“å¼€æ¥é‡Œé¢éƒ½æ˜¯ç©ºçš„ï¼Œæ²¡æœ‰ç”¨åˆ°

```
app/helpers/user_posts_helper.rb
app/helpers/author_posts_helper.rb
app/helpers/editor_posts_helper.rb
app/helpers/admin_posts_helper.rb
```

é‡æ„åï¼šç®€åŒ–é›†ä¸­åˆ°å°‘æ•°çš„ Helper æ¡£æ¡ˆå³å¯ã€‚è¿™äº› Helper æ¡£æ¡ˆè·Ÿ Controller å¹¶æ²¡æœ‰å¯¹åº”çš„å…³ç³»ï¼Œæ‰€æœ‰ Helper æ¡£æ¡ˆé‡Œé¢å®£å‘Šçš„æ–¹æ³•éƒ½æ˜¯é€šç”¨çš„ï¼Œä¸ä¼šå› ä¸ºæ”¾åœ¨å“ªä¸€ä¸ª Helper æ¡£æ¡ˆè€Œæœ‰å·®å¼‚ã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥é‡æ–°ç¼–æ’æ•´ç†ã€‚

```
app/helpers/posts_helper.rb
```

# 17. ä»£ç åˆ†æå·¥å…·

- [Rubocop](https://github.com/bbatsov/rubocop) æ˜¯ä¸€ä¸ª gem å¯ä»¥åˆ†æ Rails ä»£ç ï¼Œå»ºè®®ä¸€äº›å¯ä»¥é‡æ„çš„åœ°æ–¹
- [CodeClimate](https://codeclimate.com/) æ˜¯ä¸€ä¸ªçº¿ä¸Šçš„å·¥å…·ï¼Œå¯ä»¥ä¸ºé¡¹ç›®è¯„åˆ†ï¼Œå¹¶å»ºè®®å“ªé‡Œéœ€è¦ä¿®æ”¹ã€‚

## æ­¥é©Ÿ

### Step 1:ç™»å½•code climate

<https://codeclimate.com/>

å¯ä»¥ç›´æ¥ä½¿ç”¨GitHubè´¦å·ç™»å½•

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/bnODlOSRuHhneuriHvAL_Screen%20Shot%202017-03-10%20at%2015.16.31.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/bnODlOSRuHhneuriHvAL_Screen%20Shot%202017-03-10%20at%2015.16.31.png)

### Step 2:æ·»åŠ GitHub repo

ç‚¹å‡» Add a repository

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/KQaCjcGqQUGmedawEYDM_Screen%20Shot%202017-03-10%20at%2015.20.06.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/KQaCjcGqQUGmedawEYDM_Screen%20Shot%202017-03-10%20at%2015.20.06.png)

åˆ°GitHubå¤åˆ¶ä½ çš„repoåç§°

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/cvGjSqxPRwEPvwoFi0Ng_Screen%20Shot%202017-03-10%20at%2015.27.57.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/cvGjSqxPRwEPvwoFi0Ng_Screen%20Shot%202017-03-10%20at%2015.27.57.png)

å¡«å†™åˆ°è¿™é‡Œ

ç‚¹å‡» Import Repo from GitHub

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/a4cuIqNCSfyJ4aS9hXLF_Screen%20Shot%202017-03-10%20at%2015.26.43.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/a4cuIqNCSfyJ4aS9hXLF_Screen%20Shot%202017-03-10%20at%2015.26.43.png)

ç”»é¢å¦‚ä¸‹ï¼Œç‚¹å‡»complete

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/5juThnHxR9OifbosAsNG_Screen%20Shot%202017-03-10%20at%2015.35.01.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/5juThnHxR9OifbosAsNG_Screen%20Shot%202017-03-10%20at%2015.35.01.png)

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/liWeDWuASdCOI1NLOgh1_Screen%20Shot%20on%202017-03-10%20at%2015:32:13.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/liWeDWuASdCOI1NLOgh1_Screen%20Shot%20on%202017-03-10%20at%2015:32:13.png)

### Step 3:å¾—åˆ°è¯„åˆ†

GPAæ˜¯åˆ†æ•°ï¼Œæ»¡åˆ†ä¸º4åˆ†

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/DH0rS1S7QBnpqWVBQscg_Screen%20Shot%202017-03-10%20at%2015.58.12.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/DH0rS1S7QBnpqWVBQscg_Screen%20Shot%202017-03-10%20at%2015.58.12.png)

ç‚¹å‡»issuesæŸ¥çœ‹ä»£ç è¯„ä¼°

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/Y2aI0g4QQcyZXFrC3Vr8_Screen%20Shot%20on%202017-03-10%20at%2016:00:20.png)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/Y2aI0g4QQcyZXFrC3Vr8_Screen%20Shot%20on%202017-03-10%20at%2016:00:20.png)

# 18. è¡¥å……å’Œæ¨èèµ„æº

- [é‡æ„](https://book.douban.com/subject/1229923/) è¿™æœ¬ä¹¦æ˜¯è½¯ä»¶å¼€å‘é¢†åŸŸçš„ç»å…¸ä¹‹ä½œï¼ŒåŸä½œä½¿ç”¨ Java ä»£ç ï¼Œä½†æ˜¯ä»ç„¶å€¼å¾—ä¸€è¯»ã€‚å¦æœ‰ [Ruby ç‰ˆæœ¬](https://www.amazon.com/Refactoring-Ruby-Addison-Wesley-Professional/dp/0321984137)ä½†æ²¡æœ‰ä¸­æ–‡ç¿»è¯‘ã€‚
- [how DHH organizes his rails controllers](http://jeromedalbert.com/how-dhh-organizes-his-rails-controllers/) Rails å‘æ˜äºº DHH å¦‚ä½•ç»„ç»‡ Controller ä»£ç ï¼ŒåšæŒ RESTful
- [Put chubby models on a diet with concerns](https://signalvnoise.com/posts/3372-put-chubby-models-on-a-diet-with-concerns) DHH å¯¹äº concerns ç”¨æ³•çš„çœ‹æ³•

å½“ä½ ä»ä¸æ»¡è¶³ Rails çš„ concerns æœºåˆ¶æ—¶ï¼Œä½ ä¼šéœ€è¦æ›´å¤šé¢å‘å¯¹è±¡çš„çŸ¥è¯†ï¼Œåœ¨ç¼–ç¨‹è¯­è¨€æ•™ç¨‹ä¸­æœ‰ä»‹ç»åˆ°ã€‚å…³äº Rails çš„éƒ¨åˆ†æ¨èä»¥ä¸‹è¡¥å……èµ„æ–™ï¼š

- [7 Patterns to Refactor Fat ActiveRecord Models](http://blog.codeclimate.com/blog/2012/10/17/7-ways-to-decompose-fat-activerecord-models/)
- [Object Oriented Rails â€“ Writing better controllers](https://content.pivotal.io/blog/object-oriented-rails-writing-better-controllers)
- [Slimming Down Your Models and Controllers with Concerns, Service Objects, and Tableless Models](https://www.viget.com/articles/slimming-down-your-models-and-controllers)
- [Growing Rails Applications in Practice](https://leanpub.com/growing-rails)

è¿™æ˜¯ihowerè€å¸ˆæœ€åä¸€ç¯‡æ•™ç¨‹äº†ï¼Œè¬è¬å¤§å®¶ ğŸ˜˜ğŸ˜˜ğŸ˜˜

[![img](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/3EPE6XBQtmN4c6iPuwJq_IMG_1024.JPG)](https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/3EPE6XBQtmN4c6iPuwJq_IMG_1024.JPG)

ğŸ‘ğŸ‘ğŸ‘

### æœ¬èŠ‚ä½œä¸š

##### [ä½œä¸š](https://fullstack.xinshengdaxue.com/assignments/87)ï¼š[ä½œä¸š](https://fullstack.xinshengdaxue.com/tasks/390)

å·²æœ‰ 1 ä¸ªç¬¬ä¸€æœŸåŒå­¦æäº¤äº†è¿™ä¸ªä½œä¸š [**çœ‹çœ‹åŒå­¦æ€ä¹ˆåš](https://fullstack.xinshengdaxue.com/tasks/390/other_answers?order=recent)

[**æäº¤ä½œä¸š](https://fullstack.xinshengdaxue.com/tasks/390)

è¯·é’ˆå¯¹ä½ çš„é¡¹ç›®è¿›è¡Œé‡æ„ï¼Œè¯·åˆ†äº«å‡ ä¸ª code snippet ç‰‡æ®µï¼šé‡æ„å‰ä»¥åŠé‡æ„åçš„å·®å¼‚ã€‚
